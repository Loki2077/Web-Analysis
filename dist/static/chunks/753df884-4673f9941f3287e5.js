(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[708],{7622:function(e,t,n){var r=n(9509),i=n(9641).Buffer;e.exports=function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{};function t(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach(function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}),t}var s={},o={};function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){var r,i,s;r=e,i=t,s=n[t],(i=l(i))in r?Object.defineProperty(r,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[i]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(){c=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function p(t,n,r,s){var o,a,u,c,l=Object.create((n&&n.prototype instanceof m?n:m).prototype);return i(l,"_invoke",{value:(o=t,a=r,u=new I(s||[]),c=d,function(t,n){if(c===h)throw Error("Generator is already running");if(c===y){if("throw"===t)throw n;return{value:e,done:!0}}for(u.method=t,u.arg=n;;){var r=u.delegate;if(r){var i=function t(n,r){var i=r.method,s=n.iterator[i];if(s===e)return r.delegate=null,"throw"===i&&n.iterator.return&&(r.method="return",r.arg=e,t(n,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=TypeError("The iterator does not provide a '"+i+"' method")),v;var o=f(s,n.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var a=o.arg;return a?a.done?(r[n.resultName]=a.value,r.next=n.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=TypeError("iterator result is not an object"),r.delegate=null,v)}(r,u);if(i){if(i===v)continue;return i}}if("next"===u.method)u.sent=u._sent=u.arg;else if("throw"===u.method){if(c===d)throw c=y,u.arg;u.dispatchException(u.arg)}else"return"===u.method&&u.abrupt("return",u.arg);c=h;var s=f(o,a,u);if("normal"===s.type){if(c=u.done?y:"suspendedYield",s.arg===v)continue;return{value:s.arg,done:u.done}}"throw"===s.type&&(c=y,u.method="throw",u.arg=s.arg)}})}),l}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var d="suspendedStart",h="executing",y="completed",v={};function m(){}function g(){}function b(){}var E={};l(E,o,function(){return this});var S=Object.getPrototypeOf,_=S&&S(S(x([])));_&&_!==n&&r.call(_,o)&&(E=_);var k=b.prototype=m.prototype=Object.create(E);function C(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function M(e,t){var n;i(this,"_invoke",{value:function(i,s){function o(){return new t(function(n,o){!function n(i,s,o,a){var u=f(e[i],e,s);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==typeof l&&r.call(l,"__await")?t.resolve(l.__await).then(function(e){n("next",e,o,a)},function(e){n("throw",e,o,a)}):t.resolve(l).then(function(e){c.value=e,o(c)},function(e){return n("throw",e,o,a)})}a(u.arg)}(i,s,n,o)})}return n=n?n.then(o,o):o()}})}function D(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(D,this),this.reset(!0)}function x(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,s=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}throw TypeError(typeof t+" is not iterable")}return g.prototype=b,i(k,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:g,configurable:!0}),g.displayName=l(b,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},C(M.prototype),l(M.prototype,a,function(){return this}),t.AsyncIterator=M,t.async=function(e,n,r,i,s){void 0===s&&(s=Promise);var o=new M(p(e,n,r,i),s);return t.isGeneratorFunction(n)?o:o.next().then(function(e){return e.done?e.value:o.next()})},C(k),l(k,u,"Generator"),l(k,o,function(){return this}),l(k,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=x,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(w),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return a.type="throw",a.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;w(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:x(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}function l(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t,n,r,i,s,o){try{var a=e[s](o),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,i)}function d(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var s=e.apply(t,n);function o(e){f(s,r,i,o,a,"next",e)}function a(e){f(s,r,i,o,a,"throw",e)}o(void 0)})}}function h(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function v(e,t,n){return t&&y(e.prototype,t),n&&y(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function E(e,t,n){return(E=b()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&g(i,n.prototype),i}).apply(null,arguments)}function S(e){var t="function"==typeof Map?new Map:void 0;return(S=function(e){if(null===e||!function(e){try{return -1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return E(e,arguments,m(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),g(n,e)})(e)}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,s,o,a=[],u=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=s.call(n)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw i}}return a}}(e,t)||C(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e){return function(e){if(Array.isArray(e))return M(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||C(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){if(e){if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,t):void 0}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function D(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=C(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}var w={},I=function(e,t){return(I=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function x(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}I(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var T=function(){return(T=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function P(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function A(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":p(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o}function O(e,t){return function(n,r){t(n,r,e)}}function N(e,t){if("object"===("undefined"==typeof Reflect?"undefined":p(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function R(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function a(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,a)}u((r=r.apply(e,t||[])).next())})}function F(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){var c=[a,u];if(n)throw TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var G=Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function j(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||G(t,e,n)}function U(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function B(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}function L(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(B(arguments[t]));return e}function q(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}function V(e,t,n){if(n||2==arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function z(e){return this instanceof z?(this.v=e,this):new z(e)}function H(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){s.push([e,t,n,r])>1||a(e,t)})})}function a(e,t){try{var n;(n=i[e](t)).value instanceof z?Promise.resolve(n.value.v).then(u,c):l(s[0][2],n)}catch(e){l(s[0][3],e)}}function u(e){a("next",e)}function c(e){a("throw",e)}function l(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function W(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:z(e[r](t)),done:!1}:i?i(t):t}:i}}function X(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=U(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){var s;s=(t=e[n](t)).done,Promise.resolve(t.value).then(function(e){r({value:e,done:s})},i)})}}}function J(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var $=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function Y(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&G(t,e,n);return $(t,e),t}function Q(e){return e&&e.__esModule?e:{default:e}}function K(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function Z(e,t,n,r,i){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}function ee(e,t){if(null===t||"object"!==p(t)&&"function"!=typeof t)throw TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function et(e,t,n){if(null!=t){var r;if("object"!==p(t)&&"function"!=typeof t)throw TypeError("Object expected.");if(n){if(!Symbol.asyncDispose)throw TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose]}if("function"!=typeof r)throw TypeError("Object not disposable.");e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t}var en="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var r=Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};function er(e){function t(t){e.error=e.hasError?new en(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function n(){for(;e.stack.length;){var r=e.stack.pop();try{var i=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(i).then(n,function(e){return t(e),n()})}catch(e){t(e)}}if(e.hasError)throw e.error}()}var ei={__extends:x,__assign:T,__rest:P,__decorate:A,__param:O,__metadata:N,__awaiter:R,__generator:F,__createBinding:G,__exportStar:j,__values:U,__read:B,__spread:L,__spreadArrays:q,__spreadArray:V,__await:z,__asyncGenerator:H,__asyncDelegator:W,__asyncValues:X,__makeTemplateObject:J,__importStar:Y,__importDefault:Q,__classPrivateFieldGet:K,__classPrivateFieldSet:Z,__classPrivateFieldIn:ee,__addDisposableResource:et,__disposeResources:er},es=t(Object.freeze({__proto__:null,__extends:x,get __assign(){return T},__rest:P,__decorate:A,__param:O,__esDecorate:function(e,t,n,r,i,s){function o(e){if(void 0!==e&&"function"!=typeof e)throw TypeError("Function expected");return e}for(var a,u=r.kind,c="getter"===u?"get":"setter"===u?"set":"value",l=!t&&e?r.static?e:e.prototype:null,f=t||(l?Object.getOwnPropertyDescriptor(l,r.name):{}),d=!1,h=n.length-1;h>=0;h--){var y={};for(var v in r)y[v]="access"===v?{}:r[v];for(var v in r.access)y.access[v]=r.access[v];y.addInitializer=function(e){if(d)throw TypeError("Cannot add initializers after decoration has completed");s.push(o(e||null))};var m=(0,n[h])("accessor"===u?{get:f.get,set:f.set}:f[c],y);if("accessor"===u){if(void 0===m)continue;if(null===m||"object"!==p(m))throw TypeError("Object expected");(a=o(m.get))&&(f.get=a),(a=o(m.set))&&(f.set=a),(a=o(m.init))&&i.unshift(a)}else(a=o(m))&&("field"===u?i.unshift(a):f[c]=a)}l&&Object.defineProperty(l,r.name,f),d=!0},__runInitializers:function(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0},__propKey:function(e){return"symbol"===p(e)?e:"".concat(e)},__setFunctionName:function(e,t,n){return"symbol"===p(t)&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})},__metadata:N,__awaiter:R,__generator:F,__createBinding:G,__exportStar:j,__values:U,__read:B,__spread:L,__spreadArrays:q,__spreadArray:V,__await:z,__asyncGenerator:H,__asyncDelegator:W,__asyncValues:X,__makeTemplateObject:J,__importStar:Y,__importDefault:Q,__classPrivateFieldGet:K,__classPrivateFieldSet:Z,__classPrivateFieldIn:ee,__addDisposableResource:et,__disposeResources:er,default:ei}));Object.defineProperty(w,"__esModule",{value:!0}),w.FrameworkDetector=w.Framework=void 0,(ea=eo||(w.Framework=eo={})).UNIAPP="uniapp",ea.REACT_NATIVE="rn",ea.COCOS="cocos",ea.UNKNOWN="unknown",w.FrameworkDetector=function(){function e(){this.framework=null,this.methods=((e={})[eo.UNIAPP]=this.isUniApp,e[eo.REACT_NATIVE]=this.isReactNative,e[eo.COCOS]=this.isCocos,e);var e,t,n,r=this.methods,i=Object.keys(r);try{for(var s=es.__values(i),o=s.next();!o.done;o=s.next()){var a=o.value;if((0,r[a])()){this.framework=a;break}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}this.framework=this.framework||eo.UNKNOWN,this.framework}return e.currentFramework=function(){return this.instance||(this.instance=new e),this.instance.framework},e.prototype.isUniApp=function(){try{return"function"==typeof uni.getSystemInfoSync}catch(e){return!1}},e.prototype.isReactNative=function(){try{return"object"===("undefined"==typeof navigator?"undefined":p(navigator))&&"ReactNative"===navigator.product}catch(e){return!1}},e.prototype.isTaro=function(){try{return void 0!==r.env.TARO_ENV}catch(e){return!1}},e.prototype.isCocos=function(){try{return void 0!==cc.sys.localStorage}catch(e){return!1}},e}(),Object.defineProperty(o,"__esModule",{value:!0}),o.RNPlugins=void 0,o.RNPlugins=function(){function e(){}return e.init=function(e){if(w.FrameworkDetector.currentFramework()===w.Framework.REACT_NATIVE){if(!e)throw Error("'reactNativeOptions' is missing when calling GoEasy.getInstance()");this.platform=e.platform,this.asyncStorage=e.asyncStorage}},e}();var eo,ea,eu,ec={};Object.defineProperty(ec,"__esModule",{value:!0}),ec.NetworkStatus=void 0,(ep=eu||(ec.NetworkStatus=eu={})).DISCONNECTED="disconnected",ep.DISCONNECTING="disconnecting",ep.CONNECTING="connecting",ep.CONNECTED="connected",ep.RECONNECTING="reconnecting",ep.RECONNECTED="reconnected",ep.EXPIRED_RECONNECTED="reconnected",ep.CONNECT_FAILED="connect_failed";var el={};Object.defineProperty(el,"__esModule",{value:!0}),el.CustomerStatusOptions=el.User=el.AgentOnlineOptions=el.ConversationDTO=el.MessageStatus=el.Scene=el.CallBackOptions=el.version=void 0,el.version="2.13.20";var ep,ef,ed,eh=function(){};el.CallBackOptions=eh,(eC=ef||(el.Scene=ef={})).PRIVATE="private",eC.GROUP="group",eC.SYSTEM="system",eC.CS="cs",(eM=ed||(el.MessageStatus=ed={})).NEW="new",eM.SENDING="sending",eM.SUCCESS="success",eM.FAIL="fail",el.ConversationDTO=function(){},el.AgentOnlineOptions=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t}(eh),el.User=function(e,t){this.id=e,this.data=t},el.CustomerStatusOptions=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t}(eh);var ey={},ev={};Object.defineProperty(ev,"__esModule",{value:!0}),ev.default=new(function(){function e(){}return e.prototype.isDef=function(e){return!this.isUndef(e)},e.prototype.isUndef=function(e){return null==e},e.prototype.isPrimitive=function(e){return"string"==typeof e||"number"==typeof e||"symbol"===p(e)||"boolean"==typeof e},e.prototype.isObject=function(e){return null!==e&&"object"===p(e)},e.prototype.isPlainObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},e.prototype.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},e.prototype.isValidArrayIndex=function(e){var t=parseFloat(String(e));return t>=0&&Math.floor(t)===t&&isFinite(e)},e.prototype.isString=function(e){return"string"==typeof e},e.prototype.isNumber=function(e){return"number"==typeof e},e.prototype.isStringOrNumber=function(e){return this.isString(e)||this.isNumber(e)},e.prototype.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},e.prototype.isEmpty=function(e){return this.isArray(e)?0===e.length:this.isObject(e)?!this.isDef(e):!this.isNumber(e)&&(this.isString(e)?""===e.trim():!this.isDef(e))},e.prototype.isNative=function(e){return"function"==typeof e&&/native code/.test(e.toString())},e.prototype.isFunction=function(e){return"function"==typeof e},e.prototype.isBoolean=function(e){return"boolean"==typeof e},e.prototype.isTrue=function(e){return!0===e},e.prototype.isFalse=function(e){return!1===e},e.prototype.isNull=function(e){return null===e},e}());var em={};Object.defineProperty(em,"__esModule",{value:!0}),em.Platform=em.PlatformDetector=em.PlatformType=void 0,(ew=eD||(em.PlatformType=eD={})).MP_WX="mp-wx",ew.MP_WGAME="mp-wgame",ew.MP_BYTE="mp-byte",ew.MP_BAIDU="mp-baidu",ew.MP_ALI="mp-ali",ew.BROWSER="browser",ew.NODE="node",ew.UNI_IOS="uni-ios",ew.UNI_ANDROID="uni-android",ew.COCOS_IOS="cocos-ios",ew.COCOS_ANDROID="cocos-android",ew.RN_IOS="rn-ios",ew.RN_ANDROID="rn-android",ew.UNKNOWN="unknown";var eg=function(){function e(){this.platform=null,this.methods=((e={})[eD.BROWSER]=this.isBrowser,e[eD.MP_WX]=this.isMPWX,e[eD.MP_WGAME]=this.isMPWeGame,e[eD.MP_BYTE]=this.isMPByte,e[eD.MP_BAIDU]=this.isMPBaidu,e[eD.MP_ALI]=this.isMPAli,e[eD.NODE]=this.isNode,e[eD.UNI_IOS]=this.isUniAppIOS,e[eD.UNI_ANDROID]=this.isUniAppAndroid,e[eD.COCOS_IOS]=this.isCocosIOS,e[eD.COCOS_ANDROID]=this.isCocosAndroid,e[eD.RN_IOS]=this.isRNiOS,e[eD.RN_ANDROID]=this.isRNAndroid,e);var e,t,n,r=this.methods,i=Object.keys(r);try{for(var s=es.__values(i),o=s.next();!o.done;o=s.next()){var a=o.value;if((0,r[a])()){this.platform=a;break}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}this.platform=this.platform||eD.UNKNOWN,this.platform}return e.currentPlatform=function(){return this.instance||(this.instance=new e),e.instance.platform},e.prototype.isBrowser=function(){return"undefined"!=typeof navigator&&"Taro"!==navigator.product&&"ReactNative"!==navigator.product&&"undefined"==typeof GameGlobal&&("undefined"==typeof cc||null!==cc.sys.browserType)&&"undefined"==typeof my&&"undefined"==typeof tt&&"undefined"==typeof swan},e.prototype.isMPWX=function(){return"object"===("undefined"==typeof wx?"undefined":p(wx))&&"function"==typeof wx.getSystemInfoSync&&"undefined"==typeof WebSocket&&"undefined"==typeof XMLHttpRequest&&"undefined"==typeof plus&&"undefined"==typeof tt},e.prototype.isMPWeGame=function(){return"object"===("undefined"==typeof GameGlobal?"undefined":p(GameGlobal))},e.prototype.isMPByte=function(){return"object"===("undefined"==typeof tt?"undefined":p(tt))&&"function"==typeof tt.getSystemInfoSync},e.prototype.isMPBaidu=function(){return"object"===("undefined"==typeof swan?"undefined":p(swan))&&"function"==typeof swan.getSystemInfoSync},e.prototype.isMPAli=function(){return"object"===("undefined"==typeof my?"undefined":p(my))&&"function"==typeof my.getSystemInfoSync},e.prototype.isNode=function(){try{return"node"===r.release.name}catch(e){return!1}},e.prototype.isUniAppIOS=function(){try{return"ios"===uni.getSystemInfoSync().platform&&"app"===uni.getSystemInfoSync().uniPlatform}catch(e){return!1}},e.prototype.isUniAppAndroid=function(){try{return"android"===uni.getSystemInfoSync().platform&&"app"===uni.getSystemInfoSync().uniPlatform}catch(e){return!1}},e.prototype.isCocosIOS=function(){try{return"iOS"===cc.sys.os}catch(e){return!1}},e.prototype.isCocosAndroid=function(){try{return"Android"===cc.sys.os}catch(e){return!1}},e.prototype.isRNiOS=function(){try{return"ios"===o.RNPlugins.platform.OS}catch(e){return!1}},e.prototype.isRNAndroid=function(){try{return"android"===o.RNPlugins.platform.OS}catch(e){return!1}},e}();em.PlatformDetector=eg,em.Platform=function(){function e(){}return e.type=eD,e.current=eg.currentPlatform(),e}();var eb={};Object.defineProperty(eb,"__esModule",{value:!0}),eb.runStatus=void 0;var eE=function(){function e(){var e=this;[new e_,new ek].forEach(function(t){if(t.support())return e.checker=t,void e.checker.startCheck()})}return e.prototype.isBackend=function(){return this.checker&&this.checker.isBackend()},e.prototype.onFrontend=function(e){this.checker.onFrontend(e)},e}(),eS=function(){function e(){}return e.prototype.onFrontend=function(e){this.onFrontendCallback=e},e}(),e_=function(e){function t(){var t=e.apply(this,es.__spreadArray([],es.__read(arguments),!1))||this;return t.runningBackend=!1,t}return es.__extends(t,e),t.prototype.startCheck=function(){var e=this;"object"===("undefined"==typeof plus?"undefined":p(plus))&&(plus.globalEvent.addEventListener("resume",function(){e.runningBackend=!1,e.runningBackend,e.onFrontendCallback&&e.onFrontendCallback()},!1),plus.globalEvent.addEventListener("pause",function(){e.runningBackend=!0,e.runningBackend},!1))},t.prototype.isBackend=function(){return this.runningBackend},t.prototype.support=function(){var e=em.PlatformDetector.currentPlatform();return[em.PlatformType.UNI_IOS,em.PlatformType.UNI_ANDROID].includes(e)},t}(eS),ek=function(e){function t(){var t=e.apply(this,es.__spreadArray([],es.__read(arguments),!1))||this;return t.runningBackend=!1,t}return es.__extends(t,e),t.prototype.startCheck=function(){var e=this;wx.onAppShow(function(){e.runningBackend=!1}),wx.onAppHide(function(){e.runningBackend=!0})},t.prototype.isBackend=function(){return this.runningBackend},t.prototype.support=function(){return em.PlatformDetector.currentPlatform()===em.PlatformType.MP_WX},t}(eS);eb.runStatus=new eE;var eC,eM,eD,ew,eI,ex={};Object.defineProperty(ex,"__esModule",{value:!0}),ex.RocketTypes=void 0,(eT=eI||(ex.RocketTypes=eI={})).authorize="authorize",eT.manualDisconnect="manualDisconnect",eT.subscribe="subscribe",eT.unsubscribe="unsubscribe",eT.publish="publish",eT.ack="ack",eT.historyMessages="historyMessages",eT.hereNow="hereNow",eT.hereNowByUserIds="hereNowByUserIds",eT.PUBSUB_PRESENCE_SUBSCRIBE="PUBSUB_PRESENCE_SUBSCRIBE",eT.PUBSUB_PRESENCE_UNSUBSCRIBE="PUBSUB_PRESENCE_UNSUBSCRIBE",eT.PUBSUB_PRESENCE_HERENOW="PUBSUB_PRESENCE_HERENOW",eT.imLastConversations="imLastConversations",eT.markPrivateMessageAsRead="markPrivateMessageAsRead",eT.markGroupMessageAsRead="markGroupMessageAsRead",eT.imGroupOnlineCount="imGroupOnlineCount",eT.imHereNow="imHereNow",eT.imGroupHereNow="imGroupHereNow",eT.publishIM="publishIM",eT.subscribeUserPresence="subscribeUserPresence",eT.unsubscribeUserPresence="unsubscribeUserPresence",eT.subscribeGroupPresence="subscribeGroupPresence",eT.unsubscribeGroupPresence="unsubscribeGroupPresence",eT.removeConversation="removeConversation",eT.topConversation="topConversation",eT.imData="imData",eT.subscribeGroups="subscribeGroups",eT.unsubscribeGroup="unsubscribeGroup",eT.IM_DELETE_MESSAGE="IM_DELETE_MESSAGE",eT.IM_HISTORY="IM_HISTORY",eT.IM_HISTORY_CHANGE="IM_HISTORY_CHANGE",eT.IM_RECALL_MESSAGE="IM_RECALL_MESSAGE",eT.IM_MARK_AS_READ="IM_MARK_AS_READ",eT.CS_PENDING_CONVERSATION="CS_PENDING_CONVERSATION",eT.CS_ACCEPT="CS_ACCEPT",eT.CS_END="CS_END",eT.CS_TRANSFER="CS_TRANSFER",eT.CS_AGENTS="CS_AGENTS",eT.CS_CUSTOMER_STATUS="CS_CUSTOMER_STATUS",eT.CS_MY_TEAMS="CS_MY_TEAMS",eT.CS_ONLINE="CS_ONLINE",eT.CS_OFFLINE="CS_OFFLINE",eT.CS_LIVE_SESSION="CS_LIVE_SESSION",eT.CS_QUIT_LIVE="CS_QUIT_LIVE",eT.SET_IOS_BADGE="SET_IOS_BADGE",eT.MD_CMD="MD_CMD";var eT,eP,eA={};Object.defineProperty(eA,"__esModule",{value:!0}),eA.SocketTimeout=void 0,(ez=eP||(eA.SocketTimeout=eP={}))[ez.connect=3e3]="connect",ez[ez.reconnectionDelayMax=3e3]="reconnectionDelayMax",ez[ez.commonQuerySingle=2500]="commonQuerySingle",ez[ez.commonQueryTotal=12e3]="commonQueryTotal",ez[ez.commonRequestSingle=1700]="commonRequestSingle",ez[ez.commonRequestTotal=12e3]="commonRequestTotal",ez[ez.commonInfiniteSingle=1700]="commonInfiniteSingle",ez[ez.commonInfiniteTotal=864e5]="commonInfiniteTotal";var eO={};Object.defineProperty(eO,"__esModule",{value:!0}),eO.CallbackUtils=void 0,eO.CallbackUtils=function(){function e(){}return e.onSuccess=function(e,t){ev.default.isFunction(e.onSuccess)&&e.onSuccess(t)},e.onFailed=function(e,t){if(!ev.default.isObject(e)||!ev.default.isFunction(e.onFailed))throw t;e.onFailed(t)},e}();var eN={},eR={exports:{}};function eF(e){if(e){for(var t in eF.prototype)e[t]=eF.prototype[t];return e}}eR.exports=eF,eF.prototype.on=eF.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},eF.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},eF.prototype.off=eF.prototype.removeListener=eF.prototype.removeAllListeners=eF.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return this},eF.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t);return this},eF.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},eF.prototype.hasListeners=function(e){return!!this.listeners(e).length};var eG=eR.exports,ej={exports:{}},eU="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(eU){var eB=new Uint8Array(16);ej.exports=function(){return eU(eB),eB}}else{var eL=Array(16);ej.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=0x100000000*Math.random()),eL[t]=e>>>((3&t)<<3)&255;return eL}}for(var eq=[],eV=0;eV<256;++eV)eq[eV]=(eV+256).toString(16).substr(1);var ez,eH,eW,eX=function(e,t){var n=t||0;return[eq[e[n++]],eq[e[n++]],eq[e[n++]],eq[e[n++]],"-",eq[e[n++]],eq[e[n++]],"-",eq[e[n++]],eq[e[n++]],"-",eq[e[n++]],eq[e[n++]],"-",eq[e[n++]],eq[e[n++]],eq[e[n++]],eq[e[n++]],eq[e[n++]],eq[e[n++]]].join("")},eJ=ej.exports,e$=0,eY=0,eQ=ej.exports,eK=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||eQ)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var s=0;s<16;++s)t[r+s]=i[s];return t||eX(i)};eK.v1=function(e,t,n){var r=t&&n||0,i=t||[],s=(e=e||{}).node||eH,o=void 0!==e.clockseq?e.clockseq:eW;if(null==s||null==o){var a=eJ();null==s&&(s=eH=[1|a[0],a[1],a[2],a[3],a[4],a[5]]),null==o&&(o=eW=16383&(a[6]<<8|a[7]))}var u=void 0!==e.msecs?e.msecs:(new Date).getTime(),c=void 0!==e.nsecs?e.nsecs:eY+1,l=u-e$+(c-eY)/1e4;if(l<0&&void 0===e.clockseq&&(o=o+1&16383),(l<0||u>e$)&&void 0===e.nsecs&&(c=0),c>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");e$=u,eY=c,eW=o;var p=(1e4*(0xfffffff&(u+=122192928e5))+c)%0x100000000;i[r++]=p>>>24&255,i[r++]=p>>>16&255,i[r++]=p>>>8&255,i[r++]=255&p;var f=u/0x100000000*1e4&0xfffffff;i[r++]=f>>>8&255,i[r++]=255&f,i[r++]=f>>>24&15|16,i[r++]=f>>>16&255,i[r++]=o>>>8|128,i[r++]=255&o;for(var d=0;d<6;++d)i[r+d]=s[d];return t||eX(i)},eK.v4=eK;var eZ=function(){function e(){h(this,e)}return v(e,[{key:"support",value:function(){return!0}},{key:"getParams",value:function(){return this.params}},{key:"setData",value:function(e){this.active=e.a,this.data=e.d}},{key:"preConnect",value:function(e){}},{key:"postConnect",value:function(){}}]),e}(),e0=function(){function e(){h(this,e)}return v(e,null,[{key:"initModule",value:function(e){e.support()&&this.modules.set(e.name,e)}},{key:"getParams",value:function(){return R(this,void 0,void 0,c().mark(function e(){var t,n,r,i,s,o;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={},n=D(this.modules),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=14;break}return s=(i=_(r.value,2))[0],o=i[1],e.next=8,o.getParams();case 8:if(e.t0=e.sent,e.t0){e.next=11;break}e.t0=null;case 11:t[s]=e.t0;case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),n.e(e.t1);case 19:return e.prev=19,n.f(),e.finish(19);case 22:return e.abrupt("return",t);case 23:case"end":return e.stop()}},e,this,[[2,16,19,22]])}))}},{key:"setDatas",value:function(e){var t=this;Object.keys(e).forEach(function(n){t.modules.get(n).setData(e[n])})}},{key:"preConnect",value:function(e){this.modules.forEach(function(t,n){t.preConnect(e)})}},{key:"postConnect",value:function(){this.modules.forEach(function(e,t){e.postConnect()})}}]),e}();e0.Module=eZ,e0.modules=new Map;var e1,e2,e3=function(){function e(){h(this,e),this.emitter=new eG}return v(e,[{key:"on",value:function(e,t){return this.emitter.on(e,t),this}},{key:"once",value:function(e,t){return this.emitter.once(e,t),this}},{key:"off",value:function(e,t){return this.emitter.off(e,t),this}},{key:"fire",value:function(e,t){return this.emitter.emit(e,t),this}}]),e}(),e4=function(){function e(){h(this,e),this.eventDriver=new e3}return v(e,[{key:"on",value:function(e,t){this.eventDriver.on(e,t)}},{key:"off",value:function(e,t){this.eventDriver.off(e,t)}},{key:"fire",value:function(e,t){this.eventDriver.fire(e,t)}}]),e}(),e6=new(function(){function e(){h(this,e)}return v(e,[{key:"isDef",value:function(e){return!this.isUndef(e)}},{key:"isUndef",value:function(e){return null==e}},{key:"isPrimitive",value:function(e){return"string"==typeof e||"number"==typeof e||"symbol"==p(e)||"boolean"==typeof e}},{key:"isObject",value:function(e){return null!==e&&"object"==p(e)}},{key:"isPlainObject",value:function(e){return"[object Object]"===Object.prototype.toString.call(e)}},{key:"isRegExp",value:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}},{key:"isValidArrayIndex",value:function(e){var t=parseFloat(String(e));return t>=0&&Math.floor(t)===t&&isFinite(e)}},{key:"isString",value:function(e){return"string"==typeof e}},{key:"isNumber",value:function(e){return"number"==typeof e}},{key:"isStringOrNumber",value:function(e){return this.isString(e)||this.isNumber(e)}},{key:"isArray",value:function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{key:"isEmpty",value:function(e){return this.isArray(e)?0===e.length:this.isObject(e)?!this.isDef(e):!this.isNumber(e)&&(this.isString(e)?""===e.trim():!this.isDef(e))}},{key:"isNative",value:function(e){return"function"==typeof e&&/native code/.test(e.toString())}},{key:"isFunction",value:function(e){return"function"==typeof e}},{key:"isBoolean",value:function(e){return"boolean"==typeof e}},{key:"isTrue",value:function(e){return!0===e}},{key:"isFalse",value:function(e){return!1===e}},{key:"isNull",value:function(e){return null===e}}]),e}()),e5=function(){function e(){h(this,e),this.emitter=new eG}return v(e,[{key:"on",value:function(e,t){if(!e6.isString(e))throw Error("event require a string.");if(!e6.isFunction(t))throw Error("callback must be a function");this.emitter.on(e,t)}},{key:"fire",value:function(e,t){this.emitter.emit(e,t)}},{key:"off",value:function(e,t){this.emitter.off(e,t)}}]),e}(),e9=function(){function e(){h(this,e)}return v(e,null,[{key:"init",value:function(e,t,n,r,i,s){this.Socket=e,this.N=t,this.Member=n,this.v=r,this.Platform=i,this.GModules=s}}]),e}(),e7=function(){function e(){h(this,e)}return v(e,null,[{key:"get",value:function(){return eK.v1().replace(/-/g,"")}}]),e}();(e2=e1||(e1={})).WRITE="WRITE",e2.READ="READ",e2.NONE="NONE";var e8=t(Object.freeze({__proto__:null,AbstractEventCenter:e4,ApiEventCenter:e5,EmitterEventDriver:e3,G:e9,GModule:eZ,GModules:e0,get Permission(){return e1},Rocket:function(){function e(t){var n=this;h(this,e),this.permission=e1.NONE,this.singleTimeout=0,this.totalTimeout=0,this.startTime=0,this.complete=!1,this.retried=0,this.unique=!1,this.uuid=e7.get(),this.name=t.name,this.params=t.params,this.permission=t.permission,this.totalTimeout=t.totalTimeout,this.singleTimeout=t.singleTimeout,t.unique&&(this.unique=t.unique),this.success=function(e){n.complete||(n.end(),t.success(e))},this.fail=function(e){n.complete||(n.end(),t.fail(e))}}return v(e,[{key:"start",value:function(){this.startTime=Date.now(),this.initAutoTimeout()}},{key:"end",value:function(){this.complete=!0,clearTimeout(this.timeoutHandler)}},{key:"initAutoTimeout",value:function(){var e=this;this.timeoutHandler=setTimeout(function(){e.complete||e.fail({resultCode:408,content:"Host unreachable or timeout"})},this.totalTimeout)}}]),e}(),UUID:e7}));Object.defineProperty(eN,"__esModule",{value:!0}),eN.GNModule=void 0,eN.GNModule=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.init=function(){return this.module=new t,this.module.name=this.GN_MODULE_NAME,this.module},t.setRegId=function(e,t){e&&(this.module.regIdPromise=e,this.module.params={v:{npv:t}})},t.prototype.preConnect=function(e){this.wxmpId=e.wxmpId},t.prototype.getParams=function(){return es.__awaiter(this,void 0,void 0,function(){var e,t;return es.__generator(this,function(n){switch(n.label){case 0:if(this.params=this.params||{},!this.regIdPromise)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),e=new Promise(function(e,t){setTimeout(function(){return t("timeout")},1e3)}),t=this.params,[4,Promise.race([this.regIdPromise,e])];case 2:return t.regId=n.sent(),[3,4];case 3:return console.warn("Failed to register the Manufacturers Push service:"+JSON.stringify(n.sent())),[3,4];case 4:return this.params.wxmpId=this.wxmpId,[2,this.params]}})})},t.GN_MODULE_NAME="GN",t}(e8.GModule),Object.defineProperty(ey,"__esModule",{value:!0}),ey.GN=void 0,ey.GN=function(){function e(){}return e.init=function(e){this.allowNotification=!0===e;var t=eN.GNModule.init();e8.GModules.initModule(t),this.supportAppNotification()&&(this.uniappPlugin=uni.requireNativePlugin("GoEasy-Uniapp"),this.uniappPlugin?(this.regIdPromise=this.askRegId(),this.v=this.uniappPlugin.v(),eN.GNModule.setRegId(this.regIdPromise,this.v)):console.warn("No GoEasy-Uniapp Native Plugin."),this.setClientBadge(0))},e.addAssembler=function(e){this.payloadAssemblers.push(e)},e.assemblePayload=function(e){var t=this.payloadAssemblers.find(function(t){return t.support(e)});return t?t.assemble(e):e},e.createLocalNotification=function(t,n,r,i,s){eb.runStatus.isBackend()&&(r.g=1,"undefined"!=typeof plus&&(i?(this.uniappPlugin&&this.uniappPlugin.playSound(i),plus.push.createMessage(n,JSON.stringify(r),{title:t,sound:"none"})):plus.push.createMessage(n,JSON.stringify(r),{title:t}),"+1"===s&&this.setClientBadge(e.badge+1)))},e.setBadge=function(t){var n=this;if(!Number.isInteger(t.badge)||t.badge<0)eO.CallbackUtils.onFailed(t,"badge must be an integer greater than or equal to 0.");else if(e.supportAppNotification())if(this.uniappPlugin&&em.PlatformDetector.currentPlatform()===em.PlatformType.UNI_IOS){var r=new e8.Rocket({name:ex.RocketTypes.SET_IOS_BADGE,params:{badge:t.badge},unique:!0,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,permission:e8.Permission.WRITE,success:function(){eO.CallbackUtils.onSuccess(t),n.setClientBadge(t.badge)},fail:function(e){eO.CallbackUtils.onFailed(t,e.content)}});e8.G.Socket.e(r)}else eO.CallbackUtils.onSuccess(t),this.setClientBadge(t.badge)},e.setClientBadge=function(t){"vivo"!==plus.device.vendor&&(e.badge=t,plus.runtime.setBadgeNumber(t))},e.askRegId=function(){var e=this,t=null,n=0;return function r(){return new Promise(function(i,s){e.uniappPlugin.regId(function(e){i(e)},function(i){if(!(1e6===i.data.code&&n<=10))return clearTimeout(t),s(i);t=setTimeout(function(){n++,e.regIdPromise=r()},3500)})})}()},e.getRegIdPromise=function(){return this.regIdPromise},e.supportAppNotification=function(){var e=em.PlatformDetector.currentPlatform();return this.allowNotification&&(e===em.PlatformType.UNI_ANDROID||e===em.PlatformType.UNI_IOS)},e.listenPlusClickNotification=function(){var e=this;plus.push.addEventListener("click",function(t){try{if(t){var n="string"==typeof t.payload?JSON.parse(t.payload):t.payload;if(e.availableIntent(n)){var r=e.assemblePayload(n);plus.push.clear(),e.onClickNotificationCallback(r)}}}catch(e){}})},e.availableIntent=function(e){return e&&Object.keys(e).length&&e.g&&1===parseInt(e.g)},e.getIntentData=function(){var e=this;this.uniappPlugin.getIntentData(function(t){if(e.availableIntent(t)){var n=e.assemblePayload(t),r=em.PlatformDetector.currentPlatform();plus.push.clear(),r===em.PlatformType.UNI_ANDROID&&e.uniappPlugin.clearAll(),e.onClickNotificationCallback(n)}})},e.listenClick=function(){var e=this;this.listenPlusClickNotification();var t=em.PlatformDetector.currentPlatform();this.uniappPlugin&&t===em.PlatformType.UNI_ANDROID&&(this.getIntentData(),eb.runStatus.onFrontend(function(){e.getIntentData()}))},e.onClickNotification=function(t){if(e.supportAppNotification()){if(!ev.default.isFunction(t))throw Error("The arguments must be a function.");null===this.onClickNotificationCallback?(this.onClickNotificationCallback=t,this.listenClick()):console.warn("The onClickNotification event has been listened on. Please do not listen to it more than once.")}else console.warn("The current environment doesn't support or allowNotification is false.")},e.uniappPlugin=null,e.v=null,e.regIdPromise=null,e.onClickNotificationCallback=null,e.payloadAssemblers=[],e}();var te={},tn={},tr={},ti={};Object.defineProperty(ti,"__esModule",{value:!0}),ti.default=function e(t){if(null===t||"object"!==p(t)||"isActiveClone"in t)return t;var n=t instanceof Array?[]:{};for(var r in t)"object"===p(t[r])?n[r]=e(t[r]):n[r]=t[r];return n};var ts={},to=Object.defineProperty,ta=Object.getOwnPropertyDescriptor,tu=Object.getOwnPropertyNames,tc=Object.prototype.hasOwnProperty,tl={},tp={BASE64_REGEX:function(){return tZ},BIC_REGEX:function(){return t0},CUID2_REGEX:function(){return t1},DECIMAL_REGEX:function(){return t2},DIGITS_REGEX:function(){return t3},EMAIL_REGEX:function(){return t4},EMOJI_REGEX:function(){return t6},HEXADECIMAL_REGEX:function(){return t5},HEX_COLOR_REGEX:function(){return t9},IMEI_REGEX:function(){return t7},IPV4_REGEX:function(){return t8},IPV6_REGEX:function(){return ne},IP_REGEX:function(){return nt},ISO_DATE_REGEX:function(){return nn},ISO_DATE_TIME_REGEX:function(){return nr},ISO_TIMESTAMP_REGEX:function(){return no},ISO_TIME_REGEX:function(){return ni},ISO_TIME_SECOND_REGEX:function(){return ns},ISO_WEEK_REGEX:function(){return na},MAC48_REGEX:function(){return nu},MAC64_REGEX:function(){return nc},MAC_REGEX:function(){return nl},NANO_ID_REGEX:function(){return np},OCTAL_REGEX:function(){return nf},RFC_EMAIL_REGEX:function(){return nd},SLUG_REGEX:function(){return nh},ULID_REGEX:function(){return ny},UUID_REGEX:function(){return nv},ValiError:function(){return t$},_addIssue:function(){return tN},_getByteCount:function(){return tR},_getGraphemeCount:function(){return tF},_getStandardProps:function(){return tG},_getWordCount:function(){return tj},_isLuhnAlgo:function(){return tB},_isValidObjectKey:function(){return tL},_joinExpects:function(){return tq},_stringify:function(){return tO},any:function(){return iy},args:function(){return tY},argsAsync:function(){return tQ},array:function(){return iv},arrayAsync:function(){return im},assert:function(){return r8},awaitAsync:function(){return tK},base64:function(){return nm},bic:function(){return ng},bigint:function(){return ig},blob:function(){return ib},boolean:function(){return iE},brand:function(){return nb},bytes:function(){return nE},check:function(){return nS},checkAsync:function(){return n_},checkItems:function(){return nk},checkItemsAsync:function(){return nC},config:function(){return ie},creditCard:function(){return nI},cuid2:function(){return nx},custom:function(){return iS},customAsync:function(){return i_},date:function(){return ik},decimal:function(){return nT},deleteGlobalConfig:function(){return tk},deleteGlobalMessage:function(){return tD},deleteSchemaMessage:function(){return tx},deleteSpecificMessage:function(){return tA},description:function(){return nP},digits:function(){return nA},email:function(){return nO},emoji:function(){return nN},empty:function(){return nR},endsWith:function(){return nF},entriesFromList:function(){return tV},entriesFromObjects:function(){return tz},enum:function(){return iC},enum_:function(){return iC},everyItem:function(){return nG},exactOptional:function(){return iM},exactOptionalAsync:function(){return iD},excludes:function(){return nj},fallback:function(){return ir},fallbackAsync:function(){return ii},file:function(){return iw},filterItems:function(){return nU},findItem:function(){return nB},finite:function(){return nL},flatten:function(){return is},forward:function(){return io},forwardAsync:function(){return ia},function:function(){return iI},function_:function(){return iI},getDefault:function(){return iu},getDefaults:function(){return function e(t){if("entries"in t){var n={};for(var r in t.entries)n[r]=e(t.entries[r]);return n}return"items"in t?t.items.map(e):iu(t)}},getDefaultsAsync:function(){return ic},getDotPath:function(){return tH},getFallback:function(){return it},getFallbacks:function(){return function e(t){if("entries"in t){var n={};for(var r in t.entries)n[r]=e(t.entries[r]);return n}return"items"in t?t.items.map(e):it(t)}},getFallbacksAsync:function(){return ip},getGlobalConfig:function(){return t_},getGlobalMessage:function(){return tM},getSchemaMessage:function(){return tI},getSpecificMessage:function(){return tP},graphemes:function(){return nq},gtValue:function(){return nV},hash:function(){return nH},hexColor:function(){return nX},hexadecimal:function(){return nW},imei:function(){return nJ},includes:function(){return n$},instance:function(){return ix},integer:function(){return nY},intersect:function(){return iP},intersectAsync:function(){return iA},ip:function(){return nQ},ipv4:function(){return nK},ipv6:function(){return nZ},is:function(){return ih},isOfKind:function(){return tW},isOfType:function(){return tX},isValiError:function(){return tJ},isoDate:function(){return n0},isoDateTime:function(){return n1},isoTime:function(){return n2},isoTimeSecond:function(){return n3},isoTimestamp:function(){return n4},isoWeek:function(){return n6},keyof:function(){return sC},lazy:function(){return iO},lazyAsync:function(){return iN},length:function(){return n5},literal:function(){return iR},looseObject:function(){return iF},looseObjectAsync:function(){return iG},looseTuple:function(){return ij},looseTupleAsync:function(){return iU},ltValue:function(){return n9},mac:function(){return n7},mac48:function(){return n8},mac64:function(){return re},map:function(){return iB},mapAsync:function(){return iL},mapItems:function(){return rt},maxBytes:function(){return rn},maxGraphemes:function(){return rr},maxLength:function(){return ri},maxSize:function(){return rs},maxValue:function(){return ro},maxWords:function(){return ra},metadata:function(){return ru},mimeType:function(){return rc},minBytes:function(){return rl},minGraphemes:function(){return rp},minLength:function(){return rf},minSize:function(){return rd},minValue:function(){return rh},minWords:function(){return ry},multipleOf:function(){return rv},nan:function(){return iq},nanoid:function(){return rm},never:function(){return iV},nonEmpty:function(){return rg},nonNullable:function(){return iz},nonNullableAsync:function(){return iH},nonNullish:function(){return iW},nonNullishAsync:function(){return iX},nonOptional:function(){return iJ},nonOptionalAsync:function(){return i$},normalize:function(){return rb},notBytes:function(){return rE},notGraphemes:function(){return rS},notLength:function(){return r_},notSize:function(){return rk},notValue:function(){return rC},notValues:function(){return rM},notWords:function(){return rD},null:function(){return iY},null_:function(){return iY},nullable:function(){return iQ},nullableAsync:function(){return iK},nullish:function(){return iZ},nullishAsync:function(){return i0},number:function(){return i1},object:function(){return i2},objectAsync:function(){return i3},objectWithRest:function(){return i4},objectWithRestAsync:function(){return i6},octal:function(){return rw},omit:function(){return sM},optional:function(){return i5},optionalAsync:function(){return i9},parse:function(){return sD},parseAsync:function(){return sw},parser:function(){return sx},parserAsync:function(){return sT},partial:function(){return sP},partialAsync:function(){return sA},partialCheck:function(){return rx},partialCheckAsync:function(){return rT},pick:function(){return sO},picklist:function(){return i7},pipe:function(){return sN},pipeAsync:function(){return sR},promise:function(){return i8},rawCheck:function(){return rP},rawCheckAsync:function(){return rA},rawTransform:function(){return rO},rawTransformAsync:function(){return rN},readonly:function(){return rR},record:function(){return se},recordAsync:function(){return st},reduceItems:function(){return rF},regex:function(){return rG},required:function(){return sF},requiredAsync:function(){return sG},returns:function(){return rj},returnsAsync:function(){return rU},rfcEmail:function(){return rB},safeInteger:function(){return rL},safeParse:function(){return sj},safeParseAsync:function(){return sU},safeParser:function(){return sL},safeParserAsync:function(){return sq},set:function(){return sn},setAsync:function(){return sr},setGlobalConfig:function(){return tS},setGlobalMessage:function(){return tC},setSchemaMessage:function(){return tw},setSpecificMessage:function(){return tT},size:function(){return rq},slug:function(){return rV},someItem:function(){return rz},sortItems:function(){return rH},startsWith:function(){return rW},strictObject:function(){return si},strictObjectAsync:function(){return ss},strictTuple:function(){return so},strictTupleAsync:function(){return sa},string:function(){return su},symbol:function(){return sc},title:function(){return rX},toLowerCase:function(){return rJ},toMaxValue:function(){return r$},toMinValue:function(){return rY},toUpperCase:function(){return rQ},transform:function(){return rK},transformAsync:function(){return rZ},trim:function(){return r0},trimEnd:function(){return r1},trimStart:function(){return r2},tuple:function(){return sl},tupleAsync:function(){return sp},tupleWithRest:function(){return sf},tupleWithRestAsync:function(){return sd},ulid:function(){return r3},undefined:function(){return sh},undefined_:function(){return sh},undefinedable:function(){return sy},undefinedableAsync:function(){return sv},union:function(){return sg},unionAsync:function(){return sb},unknown:function(){return sE},unwrap:function(){return sV},url:function(){return r4},uuid:function(){return r6},value:function(){return r5},values:function(){return r9},variant:function(){return sS},variantAsync:function(){return s_},void:function(){return sk},void_:function(){return sk},words:function(){return r7}};for(var tf in tp)to(tl,tf,{get:tp[tf],enumerable:!0});var td,th,ty,tv,tm,tg,tb,tE=function(e,t,n,r){if(t&&"object"===p(t)||"function"==typeof t){var i,s=D(tu(t));try{for(s.s();!(i=s.n()).done;)!function(){var n=i.value;tc.call(e,n)||void 0===n||to(e,n,{get:function(){return t[n]},enumerable:!(r=ta(t,n))||r.enumerable})}()}catch(e){s.e(e)}finally{s.f()}}return e}(to({},"__esModule",{value:!0}),tl);function tS(e){td=u(u({},td),e)}function t_(e){var t,n,r,i,s,o;return{lang:null!=(t=null==e?void 0:e.lang)?t:null==(n=td)?void 0:n.lang,message:null==e?void 0:e.message,abortEarly:null!=(r=null==e?void 0:e.abortEarly)?r:null==(i=td)?void 0:i.abortEarly,abortPipeEarly:null!=(s=null==e?void 0:e.abortPipeEarly)?s:null==(o=td)?void 0:o.abortPipeEarly}}function tk(){td=void 0}function tC(e,t){th||(th=new Map),th.set(t,e)}function tM(e){var t;return null==(t=th)?void 0:t.get(e)}function tD(e){var t;null==(t=th)||t.delete(e)}function tw(e,t){ty||(ty=new Map),ty.set(t,e)}function tI(e){var t;return null==(t=ty)?void 0:t.get(e)}function tx(e){var t;null==(t=ty)||t.delete(e)}function tT(e,t,n){tv||(tv=new Map),tv.get(e)||tv.set(e,new Map),tv.get(e).set(n,t)}function tP(e,t){var n;return null==(n=tv)||null==(n=n.get(e))?void 0:n.get(t)}function tA(e,t){var n;null==(n=tv)||null==(n=n.get(e))||n.delete(t)}function tO(e){var t,n,r=p(e);return"string"===r?'"'.concat(e,'"'):"number"===r||"bigint"===r||"boolean"===r?"".concat(e):"object"===r||"function"===r?null!=(t=e&&(null==(n=Object.getPrototypeOf(e))||null==(n=n.constructor)?void 0:n.name))?t:"null":r}function tN(e,t,n,r,i){var s,o,a,u,c,l,p,f,d=i&&"input"in i?i.input:n.value,h=null!=(s=null!=(o=null==i?void 0:i.expected)?o:e.expects)?s:null,y=null!=(a=null==i?void 0:i.received)?a:tO(d),v={kind:e.kind,type:e.type,input:d,expected:h,received:y,message:"Invalid ".concat(t,": ").concat(h?"Expected ".concat(h," but r"):"R","eceived ").concat(y),requirement:e.requirement,path:null==i?void 0:i.path,issues:null==i?void 0:i.issues,lang:r.lang,abortEarly:r.abortEarly,abortPipeEarly:r.abortPipeEarly},m="schema"===e.kind,g=null!=(u=null!=(c=null!=(l=null!=(p=null!=(f=null==i?void 0:i.message)?f:e.message)?p:tP(e.reference,v.lang))?l:m?tI(v.lang):null)?c:r.message)?u:tM(v.lang);void 0!==g&&(v.message="function"==typeof g?g(v):g),m&&(n.typed=!1),n.issues?n.issues.push(v):n.issues=[v]}function tR(e){return tm||(tm=new TextEncoder),tm.encode(e).length}function tF(e){tg||(tg=new Intl.Segmenter);var t,n=0,r=D(tg.segment(e));try{for(r.s();!(t=r.n()).done;)t.value,n++}catch(e){r.e(e)}finally{r.f()}return n}function tG(e){return{version:1,vendor:"valibot",validate:function(t){return e["~run"]({value:t},t_())}}}function tj(e,t){tb||(tb=new Map),tb.get(e)||tb.set(e,new Intl.Segmenter(e,{granularity:"word"}));var n,r=0,i=D(tb.get(e).segment(t));try{for(i.s();!(n=i.n()).done;)n.value.isWordLike&&r++}catch(e){i.e(e)}finally{i.f()}return r}var tU=/(?:[\0-\/:-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g;function tB(e){for(var t=e.replace(tU,""),n=t.length,r=1,i=0;n;){var s=+t[--n];i+=(r^=1)?[0,2,4,6,8,1,3,5,7,9][s]:s}return i%10==0}function tL(e,t){return Object.hasOwn(e,t)&&"__proto__"!==t&&"prototype"!==t&&"constructor"!==t}function tq(e,t){var n,r=k(new Set(e));return r.length>1?"(".concat(r.join(" ".concat(t," ")),")"):null!=(n=r[0])?n:"never"}function tV(e,t){var n,r={},i=D(e);try{for(i.s();!(n=i.n()).done;)r[n.value]=t}catch(e){i.e(e)}finally{i.f()}return r}function tz(e){var t,n={},r=D(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;Object.assign(n,i.entries)}}catch(e){r.e(e)}finally{r.f()}return n}function tH(e){if(e.path){var t,n="",r=D(e.path);try{for(r.s();!(t=r.n()).done;){var i=t.value;if("string"!=typeof i.key&&"number"!=typeof i.key)return null;n+=n?".".concat(i.key):i.key}}catch(e){r.e(e)}finally{r.f()}return n}return null}function tW(e,t){return t.kind===e}function tX(e,t){return t.type===e}function tJ(e){return e instanceof t$}var t$=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&g(r,e);var t,n=(t=b(),function(){var e,n=m(r);e=t?Reflect.construct(n,arguments,m(this).constructor):n.apply(this,arguments);if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");if(void 0===this)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return this});function r(e){var t;return h(this,r),(t=n.call(this,e[0].message)).name="ValiError",t.issues=e,t}return v(r)}(S(Error));function tY(e){return{kind:"transformation",type:"args",reference:tY,async:!1,schema:e,"~run":function(e,t){var n=this,r=e.value;return e.value=function(){for(var e=arguments.length,i=Array(e),s=0;s<e;s++)i[s]=arguments[s];var o=n.schema["~run"]({value:i},t);if(o.issues)throw new t$(o.issues);return r.apply(void 0,k(o.value))},e}}}function tQ(e){return{kind:"transformation",type:"args",reference:tQ,async:!1,schema:e,"~run":function(t,n){var r=t.value;return t.value=d(c().mark(function t(){var i,s,o,a,u=arguments;return c().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(s=Array(i=u.length),o=0;o<i;o++)s[o]=u[o];return t.next=3,e["~run"]({value:s},n);case 3:if(!(a=t.sent).issues){t.next=6;break}throw new t$(a.issues);case 6:return t.abrupt("return",r.apply(void 0,k(a.value)));case 7:case"end":return t.stop()}},t)})),t}}}function tK(){return{kind:"transformation",type:"await",reference:tK,async:!0,"~run":function(e){return d(c().mark(function t(){return c().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.value;case 2:return e.value=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}},t)}))()}}}var tZ=/^(?:[\+\/-9a-z\u017F\u212A]{4})*(?:[\+\/-9a-z\u017F\u212A]{2}==|[\+\/-9a-z\u017F\u212A]{3}=)?$/i,t0=/^[A-Z]{6}(?!00)[0-9A-Z]{2}(?:[0-9A-Z]{3})?$/,t1=/^[a-z][0-9a-z]*$/,t2=/^[\+\x2D]?(?:[0-9]*\.)?[0-9]+$/,t3=/^[0-9]+$/,t4=/^[\+\x2D0-9A-Z_a-z\u017F\u212A]+(?:\.[\+\x2D0-9A-Z_a-z\u017F\u212A]+)*@[0-9a-z\u017F\u212A]+(?:[\x2D\.][0-9a-z\u017F\u212A]+)*\.[a-z\u017F\u212A]{2,}$/i,t6=/^(?:(?:\uD83C[\uDDE6-\uDDFF]){2}|(?:\uD83C\uDFF4)(?:\uDB40[\uDC61-\uDC7A]){2}(?:\uDB40[\uDC30-\uDC39\uDC61-\uDC7A]){1,3}(?:\uDB40\uDC7F)|(?:(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEDC-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8])\uFE0F\u20E3?|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDC8F\uDC91\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1F\uDD26\uDD30-\uDD39\uDD3C-\uDD3E\uDD77\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD\uDEC3-\uDEC5\uDEF0-\uDEF8])(?:\uD83C[\uDFFB-\uDFFF])?|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDED5-\uDED7\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8]))(?:\u200D(?:(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEDC-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8])\uFE0F\u20E3?|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDC8F\uDC91\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1F\uDD26\uDD30-\uDD39\uDD3C-\uDD3E\uDD77\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD\uDEC3-\uDEC5\uDEF0-\uDEF8])(?:\uD83C[\uDFFB-\uDFFF])?|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDED5-\uDED7\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8])))*)+$/,t5=/^(?:0[hx])?[0-9A-Fa-f]+$/,t9=/^#(?:[0-9A-Fa-f]{3,4}|[0-9A-Fa-f]{6}|[0-9A-Fa-f]{8})$/,t7=/^[0-9]{15}$|^[0-9]{2}\x2D[0-9]{6}\x2D[0-9]{6}\x2D[0-9]$/,t8=/^(?:(?:[1-9]|1[0-9]|2[0-4])?[0-9]|25[0-5])(?:\.(?:(?:[1-9]|1[0-9]|2[0-4])?[0-9]|25[0-5])){3}$/,ne=/^(?:(?:[0-9a-f]{1,4}:){7}[0-9a-f]{1,4}|(?:[0-9a-f]{1,4}:){1,7}:|(?:[0-9a-f]{1,4}:){1,6}:[0-9a-f]{1,4}|(?:[0-9a-f]{1,4}:){1,5}(?::[0-9a-f]{1,4}){1,2}|(?:[0-9a-f]{1,4}:){1,4}(?::[0-9a-f]{1,4}){1,3}|(?:[0-9a-f]{1,4}:){1,3}(?::[0-9a-f]{1,4}){1,4}|(?:[0-9a-f]{1,4}:){1,2}(?::[0-9a-f]{1,4}){1,5}|[0-9a-f]{1,4}:(?::[0-9a-f]{1,4}){1,6}|:(?:(?::[0-9a-f]{1,4}){1,7}|:)|fe80:(?::[0-9a-f]{0,4}){0,4}%[0-9a-z\u017F\u212A]+|::(?:f{4}(?::0{1,4})?:)?(?:(?:25[0-5]|(?:2[0-4]|1?[0-9])?[0-9])\.){3}(?:25[0-5]|(?:2[0-4]|1?[0-9])?[0-9])|(?:[0-9a-f]{1,4}:){1,4}:(?:(?:25[0-5]|(?:2[0-4]|1?[0-9])?[0-9])\.){3}(?:25[0-5]|(?:2[0-4]|1?[0-9])?[0-9]))$/i,nt=/^(?:(?:[1-9]|1[0-9]|2[0-4])?[0-9]|25[0-5])(?:\.(?:(?:[1-9]|1[0-9]|2[0-4])?[0-9]|25[0-5])){3}$|^(?:(?:[0-9a-f]{1,4}:){7}[0-9a-f]{1,4}|(?:[0-9a-f]{1,4}:){1,7}:|(?:[0-9a-f]{1,4}:){1,6}:[0-9a-f]{1,4}|(?:[0-9a-f]{1,4}:){1,5}(?::[0-9a-f]{1,4}){1,2}|(?:[0-9a-f]{1,4}:){1,4}(?::[0-9a-f]{1,4}){1,3}|(?:[0-9a-f]{1,4}:){1,3}(?::[0-9a-f]{1,4}){1,4}|(?:[0-9a-f]{1,4}:){1,2}(?::[0-9a-f]{1,4}){1,5}|[0-9a-f]{1,4}:(?::[0-9a-f]{1,4}){1,6}|:(?:(?::[0-9a-f]{1,4}){1,7}|:)|fe80:(?::[0-9a-f]{0,4}){0,4}%[0-9a-z\u017F\u212A]+|::(?:f{4}(?::0{1,4})?:)?(?:(?:25[0-5]|(?:2[0-4]|1?[0-9])?[0-9])\.){3}(?:25[0-5]|(?:2[0-4]|1?[0-9])?[0-9])|(?:[0-9a-f]{1,4}:){1,4}:(?:(?:25[0-5]|(?:2[0-4]|1?[0-9])?[0-9])\.){3}(?:25[0-5]|(?:2[0-4]|1?[0-9])?[0-9]))$/i,nn=/^[0-9]{4}\x2D(?:0[1-9]|1[0-2])\x2D(?:[12][0-9]|0[1-9]|3[01])$/,nr=/^[0-9]{4}\x2D(?:0[1-9]|1[0-2])\x2D(?:[12][0-9]|0[1-9]|3[01])[ T](?:0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/,ni=/^(?:0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/,ns=/^(?:0[0-9]|1[0-9]|2[0-3])(?::[0-5][0-9]){2}$/,no=/^[0-9]{4}\x2D(?:0[1-9]|1[0-2])\x2D(?:[12][0-9]|0[1-9]|3[01])[ T](?:0[0-9]|1[0-9]|2[0-3])(?::[0-5][0-9]){2}(?:\.[0-9]{1,9})?(?:Z|[\+\x2D](?:0[0-9]|1[0-9]|2[0-3])(?::?[0-5][0-9])?)$/,na=/^[0-9]{4}\x2DW(?:0[1-9]|[1-4][0-9]|5[0-3])$/,nu=/^(?:[0-9a-f]{2}:){5}[0-9a-f]{2}$|^(?:[0-9a-f]{2}\x2D){5}[0-9a-f]{2}$|^(?:[0-9a-f]{4}\.){2}[0-9a-f]{4}$/i,nc=/^(?:[0-9a-f]{2}:){7}[0-9a-f]{2}$|^(?:[0-9a-f]{2}\x2D){7}[0-9a-f]{2}$|^(?:[0-9a-f]{4}\.){3}[0-9a-f]{4}$|^(?:[0-9a-f]{4}:){3}[0-9a-f]{4}$/i,nl=/^(?:[0-9a-f]{2}:){5}[0-9a-f]{2}$|^(?:[0-9a-f]{2}\x2D){5}[0-9a-f]{2}$|^(?:[0-9a-f]{4}\.){2}[0-9a-f]{4}$|^(?:[0-9a-f]{2}:){7}[0-9a-f]{2}$|^(?:[0-9a-f]{2}\x2D){7}[0-9a-f]{2}$|^(?:[0-9a-f]{4}\.){3}[0-9a-f]{4}$|^(?:[0-9a-f]{4}:){3}[0-9a-f]{4}$/i,np=/^[\x2D0-9A-Z_a-z]+$/,nf=/^(?:0o)?[0-7]+$/,nd=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,nh=/^[0-9a-z]+(?:[\x2D_][0-9a-z]+)*$/,ny=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,nv=/^[0-9a-f]{8}(?:\x2D[0-9a-f]{4}){3}\x2D[0-9a-f]{12}$/i;function nm(e){return{kind:"validation",type:"base64",reference:nm,async:!1,expects:null,requirement:tZ,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"Base64",e,t),e}}}function ng(e){return{kind:"validation",type:"bic",reference:ng,async:!1,expects:null,requirement:t0,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"BIC",e,t),e}}}function nb(e){return{kind:"transformation",type:"brand",reference:nb,async:!1,name:e,"~run":function(e){return e}}}function nE(e,t){return{kind:"validation",type:"bytes",reference:nE,async:!1,expects:"".concat(e),requirement:e,message:t,"~run":function(e,t){if(e.typed){var n=tR(e.value);n!==this.requirement&&tN(this,"bytes",e,t,{received:"".concat(n)})}return e}}}function nS(e,t){return{kind:"validation",type:"check",reference:nS,async:!1,expects:null,requirement:e,message:t,"~run":function(e,t){return e.typed&&!this.requirement(e.value)&&tN(this,"input",e,t),e}}}function n_(e,t){return{kind:"validation",type:"check",reference:n_,async:!0,expects:null,requirement:e,message:t,"~run":function(e,t){var n=this;return d(c().mark(function r(){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=e.typed,!r.t0){r.next=5;break}return r.next=4,n.requirement(e.value);case 4:r.t0=!r.sent;case 5:if(!r.t0){r.next=7;break}tN(n,"input",e,t);case 7:return r.abrupt("return",e);case 8:case"end":return r.stop()}},r)}))()}}}function nk(e,t){return{kind:"validation",type:"check_items",reference:nk,async:!1,expects:null,requirement:e,message:t,"~run":function(e,t){if(e.typed)for(var n=0;n<e.value.length;n++){var r=e.value[n];this.requirement(r,n,e.value)||tN(this,"item",e,t,{input:r,path:[{type:"array",origin:"value",input:e.value,key:n,value:r}]})}return e}}}function nC(e,t){return{kind:"validation",type:"check_items",reference:nC,async:!0,expects:null,requirement:e,message:t,"~run":function(e,t){var n=this;return d(c().mark(function r(){var i,s,o;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.typed){r.next=5;break}return r.next=3,Promise.all(e.value.map(n.requirement));case 3:for(i=r.sent,s=0;s<e.value.length;s++)i[s]||(o=e.value[s],tN(n,"item",e,t,{input:o,path:[{type:"array",origin:"value",input:e.value,key:s,value:o}]}));case 5:return r.abrupt("return",e);case 6:case"end":return r.stop()}},r)}))()}}}var nM=/^(?:[0-9]{14,19}|[0-9]{4}(?: [0-9]{3,6}){2,4}|[0-9]{4}(?:\x2D[0-9]{3,6}){2,4})$/,nD=/[ \x2D]/g,nw=[/^3[47][0-9]{13}$/,/^3(?:0[0-5]|[68][0-9])[0-9]{11,13}$/,/^6(?:011|5[0-9]{2})[0-9]{12,15}$/,/^(?:2131|1800|35[0-9]{3})[0-9]{11}$/,/^5[1-5][0-9]{2}|(?:222[0-9]|22[3-9][0-9]|2[3-6][0-9]{2}|27[01][0-9]|2720)[0-9]{12}$/,/^(?:6[27][0-9]{14,17}|81[0-9]{14,17})$/,/^4[0-9]{12}(?:[0-9]{3,6})?$/];function nI(e){return{kind:"validation",type:"credit_card",reference:nI,async:!1,expects:null,requirement:function(e){var t;return nM.test(e)&&(t=e.replace(nD,""))&&nw.some(function(e){return e.test(t)})&&tB(t)},message:e,"~run":function(e,t){return e.typed&&!this.requirement(e.value)&&tN(this,"credit card",e,t),e}}}function nx(e){return{kind:"validation",type:"cuid2",reference:nx,async:!1,expects:null,requirement:t1,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"Cuid2",e,t),e}}}function nT(e){return{kind:"validation",type:"decimal",reference:nT,async:!1,expects:null,requirement:t2,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"decimal",e,t),e}}}function nP(e){return{kind:"metadata",type:"description",reference:nP,description:e}}function nA(e){return{kind:"validation",type:"digits",reference:nA,async:!1,expects:null,requirement:t3,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"digits",e,t),e}}}function nO(e){return{kind:"validation",type:"email",reference:nO,expects:null,async:!1,requirement:t4,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"email",e,t),e}}}function nN(e){return{kind:"validation",type:"emoji",reference:nN,async:!1,expects:null,requirement:t6,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"emoji",e,t),e}}}function nR(e){return{kind:"validation",type:"empty",reference:nR,async:!1,expects:"0",message:e,"~run":function(e,t){return e.typed&&e.value.length>0&&tN(this,"length",e,t,{received:"".concat(e.value.length)}),e}}}function nF(e,t){return{kind:"validation",type:"ends_with",reference:nF,async:!1,expects:'"'.concat(e,'"'),requirement:e,message:t,"~run":function(e,t){return e.typed&&!e.value.endsWith(this.requirement)&&tN(this,"end",e,t,{received:'"'.concat(e.value.slice(-this.requirement.length),'"')}),e}}}function nG(e,t){return{kind:"validation",type:"every_item",reference:nG,async:!1,expects:null,requirement:e,message:t,"~run":function(e,t){return e.typed&&!e.value.every(this.requirement)&&tN(this,"item",e,t),e}}}function nj(e,t){var n=tO(e);return{kind:"validation",type:"excludes",reference:nj,async:!1,expects:"!".concat(n),requirement:e,message:t,"~run":function(e,t){return e.typed&&e.value.includes(this.requirement)&&tN(this,"content",e,t,{received:n}),e}}}function nU(e){return{kind:"transformation",type:"filter_items",reference:nU,async:!1,operation:e,"~run":function(e){return e.value=e.value.filter(this.operation),e}}}function nB(e){return{kind:"transformation",type:"find_item",reference:nB,async:!1,operation:e,"~run":function(e){return e.value=e.value.find(this.operation),e}}}function nL(e){return{kind:"validation",type:"finite",reference:nL,async:!1,expects:null,requirement:Number.isFinite,message:e,"~run":function(e,t){return e.typed&&!this.requirement(e.value)&&tN(this,"finite",e,t),e}}}function nq(e,t){return{kind:"validation",type:"graphemes",reference:nq,async:!1,expects:"".concat(e),requirement:e,message:t,"~run":function(e,t){if(e.typed){var n=tF(e.value);n!==this.requirement&&tN(this,"graphemes",e,t,{received:"".concat(n)})}return e}}}function nV(e,t){return{kind:"validation",type:"gt_value",reference:nV,async:!1,expects:">".concat(e instanceof Date?e.toJSON():tO(e)),requirement:e,message:t,"~run":function(e,t){return!e.typed||e.value>this.requirement||tN(this,"value",e,t,{received:e.value instanceof Date?e.value.toJSON():tO(e.value)}),e}}}var nz={md4:32,md5:32,sha1:40,sha256:64,sha384:96,sha512:128,ripemd128:32,ripemd160:40,tiger128:32,tiger160:40,tiger192:48,crc32:8,crc32b:8,adler32:8};function nH(e,t){return{kind:"validation",type:"hash",reference:nH,expects:null,async:!1,requirement:RegExp(e.map(function(e){return"^[a-f0-9]{".concat(nz[e],"}$")}).join("|"),"iu"),message:t,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"hash",e,t),e}}}function nW(e){return{kind:"validation",type:"hexadecimal",reference:nW,async:!1,expects:null,requirement:t5,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"hexadecimal",e,t),e}}}function nX(e){return{kind:"validation",type:"hex_color",reference:nX,async:!1,expects:null,requirement:t9,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"hex color",e,t),e}}}function nJ(e){return{kind:"validation",type:"imei",reference:nJ,async:!1,expects:null,requirement:function(e){return t7.test(e)&&tB(e)},message:e,"~run":function(e,t){return e.typed&&!this.requirement(e.value)&&tN(this,"IMEI",e,t),e}}}function n$(e,t){var n=tO(e);return{kind:"validation",type:"includes",reference:n$,async:!1,expects:n,requirement:e,message:t,"~run":function(e,t){return e.typed&&!e.value.includes(this.requirement)&&tN(this,"content",e,t,{received:"!".concat(n)}),e}}}function nY(e){return{kind:"validation",type:"integer",reference:nY,async:!1,expects:null,requirement:Number.isInteger,message:e,"~run":function(e,t){return e.typed&&!this.requirement(e.value)&&tN(this,"integer",e,t),e}}}function nQ(e){return{kind:"validation",type:"ip",reference:nQ,async:!1,expects:null,requirement:nt,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"IP",e,t),e}}}function nK(e){return{kind:"validation",type:"ipv4",reference:nK,async:!1,expects:null,requirement:t8,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"IPv4",e,t),e}}}function nZ(e){return{kind:"validation",type:"ipv6",reference:nZ,async:!1,expects:null,requirement:ne,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"IPv6",e,t),e}}}function n0(e){return{kind:"validation",type:"iso_date",reference:n0,async:!1,expects:null,requirement:nn,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"date",e,t),e}}}function n1(e){return{kind:"validation",type:"iso_date_time",reference:n1,async:!1,expects:null,requirement:nr,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"date-time",e,t),e}}}function n2(e){return{kind:"validation",type:"iso_time",reference:n2,async:!1,expects:null,requirement:ni,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"time",e,t),e}}}function n3(e){return{kind:"validation",type:"iso_time_second",reference:n3,async:!1,expects:null,requirement:ns,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"time-second",e,t),e}}}function n4(e){return{kind:"validation",type:"iso_timestamp",reference:n4,async:!1,expects:null,requirement:no,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"timestamp",e,t),e}}}function n6(e){return{kind:"validation",type:"iso_week",reference:n6,async:!1,expects:null,requirement:na,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"week",e,t),e}}}function n5(e,t){return{kind:"validation",type:"length",reference:n5,async:!1,expects:"".concat(e),requirement:e,message:t,"~run":function(e,t){return e.typed&&e.value.length!==this.requirement&&tN(this,"length",e,t,{received:"".concat(e.value.length)}),e}}}function n9(e,t){return{kind:"validation",type:"lt_value",reference:n9,async:!1,expects:"<".concat(e instanceof Date?e.toJSON():tO(e)),requirement:e,message:t,"~run":function(e,t){return!e.typed||e.value<this.requirement||tN(this,"value",e,t,{received:e.value instanceof Date?e.value.toJSON():tO(e.value)}),e}}}function n7(e){return{kind:"validation",type:"mac",reference:n7,async:!1,expects:null,requirement:nl,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"MAC",e,t),e}}}function n8(e){return{kind:"validation",type:"mac48",reference:n8,async:!1,expects:null,requirement:nu,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"48-bit MAC",e,t),e}}}function re(e){return{kind:"validation",type:"mac64",reference:re,async:!1,expects:null,requirement:nc,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"64-bit MAC",e,t),e}}}function rt(e){return{kind:"transformation",type:"map_items",reference:rt,async:!1,operation:e,"~run":function(e){return e.value=e.value.map(this.operation),e}}}function rn(e,t){return{kind:"validation",type:"max_bytes",reference:rn,async:!1,expects:"<=".concat(e),requirement:e,message:t,"~run":function(e,t){if(e.typed){var n=tR(e.value);n>this.requirement&&tN(this,"bytes",e,t,{received:"".concat(n)})}return e}}}function rr(e,t){return{kind:"validation",type:"max_graphemes",reference:rr,async:!1,expects:"<=".concat(e),requirement:e,message:t,"~run":function(e,t){if(e.typed){var n=tF(e.value);n>this.requirement&&tN(this,"graphemes",e,t,{received:"".concat(n)})}return e}}}function ri(e,t){return{kind:"validation",type:"max_length",reference:ri,async:!1,expects:"<=".concat(e),requirement:e,message:t,"~run":function(e,t){return e.typed&&e.value.length>this.requirement&&tN(this,"length",e,t,{received:"".concat(e.value.length)}),e}}}function rs(e,t){return{kind:"validation",type:"max_size",reference:rs,async:!1,expects:"<=".concat(e),requirement:e,message:t,"~run":function(e,t){return e.typed&&e.value.size>this.requirement&&tN(this,"size",e,t,{received:"".concat(e.value.size)}),e}}}function ro(e,t){return{kind:"validation",type:"max_value",reference:ro,async:!1,expects:"<=".concat(e instanceof Date?e.toJSON():tO(e)),requirement:e,message:t,"~run":function(e,t){return!e.typed||e.value<=this.requirement||tN(this,"value",e,t,{received:e.value instanceof Date?e.value.toJSON():tO(e.value)}),e}}}function ra(e,t,n){return{kind:"validation",type:"max_words",reference:ra,async:!1,expects:"<=".concat(t),locales:e,requirement:t,message:n,"~run":function(e,t){if(e.typed){var n=tj(this.locales,e.value);n>this.requirement&&tN(this,"words",e,t,{received:"".concat(n)})}return e}}}function ru(e){return{kind:"metadata",type:"metadata",reference:ru,metadata:e}}function rc(e,t){return{kind:"validation",type:"mime_type",reference:rc,async:!1,expects:tq(e.map(function(e){return'"'.concat(e,'"')}),"|"),requirement:e,message:t,"~run":function(e,t){return e.typed&&!this.requirement.includes(e.value.type)&&tN(this,"MIME type",e,t,{received:'"'.concat(e.value.type,'"')}),e}}}function rl(e,t){return{kind:"validation",type:"min_bytes",reference:rl,async:!1,expects:">=".concat(e),requirement:e,message:t,"~run":function(e,t){if(e.typed){var n=tR(e.value);n<this.requirement&&tN(this,"bytes",e,t,{received:"".concat(n)})}return e}}}function rp(e,t){return{kind:"validation",type:"min_graphemes",reference:rp,async:!1,expects:">=".concat(e),requirement:e,message:t,"~run":function(e,t){if(e.typed){var n=tF(e.value);n<this.requirement&&tN(this,"graphemes",e,t,{received:"".concat(n)})}return e}}}function rf(e,t){return{kind:"validation",type:"min_length",reference:rf,async:!1,expects:">=".concat(e),requirement:e,message:t,"~run":function(e,t){return e.typed&&e.value.length<this.requirement&&tN(this,"length",e,t,{received:"".concat(e.value.length)}),e}}}function rd(e,t){return{kind:"validation",type:"min_size",reference:rd,async:!1,expects:">=".concat(e),requirement:e,message:t,"~run":function(e,t){return e.typed&&e.value.size<this.requirement&&tN(this,"size",e,t,{received:"".concat(e.value.size)}),e}}}function rh(e,t){return{kind:"validation",type:"min_value",reference:rh,async:!1,expects:">=".concat(e instanceof Date?e.toJSON():tO(e)),requirement:e,message:t,"~run":function(e,t){return!e.typed||e.value>=this.requirement||tN(this,"value",e,t,{received:e.value instanceof Date?e.value.toJSON():tO(e.value)}),e}}}function ry(e,t,n){return{kind:"validation",type:"min_words",reference:ry,async:!1,expects:">=".concat(t),locales:e,requirement:t,message:n,"~run":function(e,t){if(e.typed){var n=tj(this.locales,e.value);n<this.requirement&&tN(this,"words",e,t,{received:"".concat(n)})}return e}}}function rv(e,t){return{kind:"validation",type:"multiple_of",reference:rv,async:!1,expects:"%".concat(e),requirement:e,message:t,"~run":function(e,t){return e.typed&&e.value%this.requirement!=0&&tN(this,"multiple",e,t),e}}}function rm(e){return{kind:"validation",type:"nanoid",reference:rm,async:!1,expects:null,requirement:np,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"Nano ID",e,t),e}}}function rg(e){return{kind:"validation",type:"non_empty",reference:rg,async:!1,expects:"!0",message:e,"~run":function(e,t){return e.typed&&0===e.value.length&&tN(this,"length",e,t,{received:"0"}),e}}}function rb(e){return{kind:"transformation",type:"normalize",reference:rb,async:!1,form:e,"~run":function(e){return e.value=e.value.normalize(this.form),e}}}function rE(e,t){return{kind:"validation",type:"not_bytes",reference:rE,async:!1,expects:"!".concat(e),requirement:e,message:t,"~run":function(e,t){if(e.typed){var n=tR(e.value);n===this.requirement&&tN(this,"bytes",e,t,{received:"".concat(n)})}return e}}}function rS(e,t){return{kind:"validation",type:"not_graphemes",reference:rS,async:!1,expects:"!".concat(e),requirement:e,message:t,"~run":function(e,t){if(e.typed){var n=tF(e.value);n===this.requirement&&tN(this,"graphemes",e,t,{received:"".concat(n)})}return e}}}function r_(e,t){return{kind:"validation",type:"not_length",reference:r_,async:!1,expects:"!".concat(e),requirement:e,message:t,"~run":function(e,t){return e.typed&&e.value.length===this.requirement&&tN(this,"length",e,t,{received:"".concat(e.value.length)}),e}}}function rk(e,t){return{kind:"validation",type:"not_size",reference:rk,async:!1,expects:"!".concat(e),requirement:e,message:t,"~run":function(e,t){return e.typed&&e.value.size===this.requirement&&tN(this,"size",e,t,{received:"".concat(e.value.size)}),e}}}function rC(e,t){return{kind:"validation",type:"not_value",reference:rC,async:!1,expects:e instanceof Date?"!".concat(e.toJSON()):"!".concat(tO(e)),requirement:e,message:t,"~run":function(e,t){return e.typed&&this.requirement<=e.value&&this.requirement>=e.value&&tN(this,"value",e,t,{received:e.value instanceof Date?e.value.toJSON():tO(e.value)}),e}}}function rM(e,t){return{kind:"validation",type:"not_values",reference:rM,async:!1,expects:"!".concat(tq(e.map(function(e){return e instanceof Date?e.toJSON():tO(e)}),"|")),requirement:e,message:t,"~run":function(e,t){return e.typed&&this.requirement.some(function(t){return t<=e.value&&t>=e.value})&&tN(this,"value",e,t,{received:e.value instanceof Date?e.value.toJSON():tO(e.value)}),e}}}function rD(e,t,n){return{kind:"validation",type:"not_words",reference:rD,async:!1,expects:"!".concat(t),locales:e,requirement:t,message:n,"~run":function(e,t){if(e.typed){var n=tj(this.locales,e.value);n===this.requirement&&tN(this,"words",e,t,{received:"".concat(n)})}return e}}}function rw(e){return{kind:"validation",type:"octal",reference:rw,async:!1,expects:null,requirement:nf,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"octal",e,t),e}}}function rI(e,t){if(e.issues){var n,r=D(t);try{for(r.s();!(n=r.n()).done;){var i,s=n.value,o=D(e.issues);try{for(o.s();!(i=o.n()).done;){for(var a,u,c=i.value,l=!1,p=Math.min(s.length,null!=(a=null==(u=c.path)?void 0:u.length)?a:0),f=0;f<p;f++)if(s[f]!==c.path[f].key&&("$"!==s[f]||"array"!==c.path[f].type)){l=!0;break}if(!l)return!1}}catch(e){o.e(e)}finally{o.f()}}}catch(e){r.e(e)}finally{r.f()}}return!0}function rx(e,t,n){return{kind:"validation",type:"partial_check",reference:rx,async:!1,expects:null,paths:e,requirement:t,message:n,"~run":function(t,n){return!t.typed&&!rI(t,e)||this.requirement(t.value)||tN(this,"input",t,n),t}}}function rT(e,t,n){return{kind:"validation",type:"partial_check",reference:rT,async:!0,expects:null,paths:e,requirement:t,message:n,"~run":function(t,n){var r=this;return d(c().mark(function i(){return c().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.t0=t.typed||rI(t,e),!i.t0){i.next=5;break}return i.next=4,r.requirement(t.value);case 4:i.t0=!i.sent;case 5:if(!i.t0){i.next=7;break}tN(r,"input",t,n);case 7:return i.abrupt("return",t);case 8:case"end":return i.stop()}},i)}))()}}}function rP(e){return{kind:"validation",type:"raw_check",reference:rP,async:!1,expects:null,"~run":function(t,n){var r=this;return e({dataset:t,config:n,addIssue:function(e){var i;return tN(r,null!=(i=null==e?void 0:e.label)?i:"input",t,n,e)}}),t}}}function rA(e){return{kind:"validation",type:"raw_check",reference:rA,async:!0,expects:null,"~run":function(t,n){var r=this;return d(c().mark(function i(){return c().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e({dataset:t,config:n,addIssue:function(e){var i;return tN(r,null!=(i=null==e?void 0:e.label)?i:"input",t,n,e)}});case 2:return i.abrupt("return",t);case 3:case"end":return i.stop()}},i)}))()}}}function rO(e){return{kind:"transformation",type:"raw_transform",reference:rO,async:!1,"~run":function(t,n){var r=this,i=e({dataset:t,config:n,addIssue:function(e){var i;return tN(r,null!=(i=null==e?void 0:e.label)?i:"input",t,n,e)},NEVER:null});return t.issues?t.typed=!1:t.value=i,t}}}function rN(e){return{kind:"transformation",type:"raw_transform",reference:rN,async:!0,"~run":function(t,n){var r=this;return d(c().mark(function i(){var s;return c().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e({dataset:t,config:n,addIssue:function(e){var i;return tN(r,null!=(i=null==e?void 0:e.label)?i:"input",t,n,e)},NEVER:null});case 2:return s=i.sent,t.issues?t.typed=!1:t.value=s,i.abrupt("return",t);case 5:case"end":return i.stop()}},i)}))()}}}function rR(){return{kind:"transformation",type:"readonly",reference:rR,async:!1,"~run":function(e){return e}}}function rF(e,t){return{kind:"transformation",type:"reduce_items",reference:rF,async:!1,operation:e,initial:t,"~run":function(e){return e.value=e.value.reduce(this.operation,this.initial),e}}}function rG(e,t){return{kind:"validation",type:"regex",reference:rG,async:!1,expects:"".concat(e),requirement:e,message:t,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"format",e,t),e}}}function rj(e){return{kind:"transformation",type:"returns",reference:rj,async:!1,schema:e,"~run":function(e,t){var n=this,r=e.value;return e.value=function(){var e=n.schema["~run"]({value:r.apply(void 0,arguments)},t);if(e.issues)throw new t$(e.issues);return e.value},e}}}function rU(e){return{kind:"transformation",type:"returns",reference:rU,async:!1,schema:e,"~run":function(e,t){var n=this,r=e.value;return e.value=d(c().mark(function e(){var i,s=arguments;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=n.schema,e.next=3,r.apply(void 0,s);case 3:return e.t1=e.sent,e.t2={value:e.t1},e.t3=t,e.next=8,e.t0["~run"].call(e.t0,e.t2,e.t3);case 8:if(!(i=e.sent).issues){e.next=11;break}throw new t$(i.issues);case 11:return e.abrupt("return",i.value);case 12:case"end":return e.stop()}},e)})),e}}}function rB(e){return{kind:"validation",type:"rfc_email",reference:rB,expects:null,async:!1,requirement:nd,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"email",e,t),e}}}function rL(e){return{kind:"validation",type:"safe_integer",reference:rL,async:!1,expects:null,requirement:Number.isSafeInteger,message:e,"~run":function(e,t){return e.typed&&!this.requirement(e.value)&&tN(this,"safe integer",e,t),e}}}function rq(e,t){return{kind:"validation",type:"size",reference:rq,async:!1,expects:"".concat(e),requirement:e,message:t,"~run":function(e,t){return e.typed&&e.value.size!==this.requirement&&tN(this,"size",e,t,{received:"".concat(e.value.size)}),e}}}function rV(e){return{kind:"validation",type:"slug",reference:rV,async:!1,expects:null,requirement:nh,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"slug",e,t),e}}}function rz(e,t){return{kind:"validation",type:"some_item",reference:rz,async:!1,expects:null,requirement:e,message:t,"~run":function(e,t){return e.typed&&!e.value.some(this.requirement)&&tN(this,"item",e,t),e}}}function rH(e){return{kind:"transformation",type:"sort_items",reference:rH,async:!1,operation:e,"~run":function(e){return e.value=e.value.sort(this.operation),e}}}function rW(e,t){return{kind:"validation",type:"starts_with",reference:rW,async:!1,expects:'"'.concat(e,'"'),requirement:e,message:t,"~run":function(e,t){return e.typed&&!e.value.startsWith(this.requirement)&&tN(this,"start",e,t,{received:'"'.concat(e.value.slice(0,this.requirement.length),'"')}),e}}}function rX(e){return{kind:"metadata",type:"title",reference:rX,title:e}}function rJ(){return{kind:"transformation",type:"to_lower_case",reference:rJ,async:!1,"~run":function(e){return e.value=e.value.toLowerCase(),e}}}function r$(e){return{kind:"transformation",type:"to_max_value",reference:r$,async:!1,requirement:e,"~run":function(e){return e.value=e.value>this.requirement?this.requirement:e.value,e}}}function rY(e){return{kind:"transformation",type:"to_min_value",reference:rY,async:!1,requirement:e,"~run":function(e){return e.value=e.value<this.requirement?this.requirement:e.value,e}}}function rQ(){return{kind:"transformation",type:"to_upper_case",reference:rQ,async:!1,"~run":function(e){return e.value=e.value.toUpperCase(),e}}}function rK(e){return{kind:"transformation",type:"transform",reference:rK,async:!1,operation:e,"~run":function(e){return e.value=this.operation(e.value),e}}}function rZ(e){return{kind:"transformation",type:"transform",reference:rZ,async:!0,operation:e,"~run":function(e){var t=this;return d(c().mark(function n(){return c().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.operation(e.value);case 2:return e.value=n.sent,n.abrupt("return",e);case 4:case"end":return n.stop()}},n)}))()}}}function r0(){return{kind:"transformation",type:"trim",reference:r0,async:!1,"~run":function(e){return e.value=e.value.trim(),e}}}function r1(){return{kind:"transformation",type:"trim_end",reference:r1,async:!1,"~run":function(e){return e.value=e.value.trimEnd(),e}}}function r2(){return{kind:"transformation",type:"trim_start",reference:r2,async:!1,"~run":function(e){return e.value=e.value.trimStart(),e}}}function r3(e){return{kind:"validation",type:"ulid",reference:r3,async:!1,expects:null,requirement:ny,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"ULID",e,t),e}}}function r4(e){return{kind:"validation",type:"url",reference:r4,async:!1,expects:null,requirement:function(e){try{return new URL(e),!0}catch(e){return!1}},message:e,"~run":function(e,t){return e.typed&&!this.requirement(e.value)&&tN(this,"URL",e,t),e}}}function r6(e){return{kind:"validation",type:"uuid",reference:r6,async:!1,expects:null,requirement:nv,message:e,"~run":function(e,t){return e.typed&&!this.requirement.test(e.value)&&tN(this,"UUID",e,t),e}}}function r5(e,t){return{kind:"validation",type:"value",reference:r5,async:!1,expects:e instanceof Date?e.toJSON():tO(e),requirement:e,message:t,"~run":function(e,t){return!e.typed||this.requirement<=e.value&&this.requirement>=e.value||tN(this,"value",e,t,{received:e.value instanceof Date?e.value.toJSON():tO(e.value)}),e}}}function r9(e,t){return{kind:"validation",type:"values",reference:r9,async:!1,expects:"".concat(tq(e.map(function(e){return e instanceof Date?e.toJSON():tO(e)}),"|")),requirement:e,message:t,"~run":function(e,t){return e.typed&&!this.requirement.some(function(t){return t<=e.value&&t>=e.value})&&tN(this,"value",e,t,{received:e.value instanceof Date?e.value.toJSON():tO(e.value)}),e}}}function r7(e,t,n){return{kind:"validation",type:"words",reference:r7,async:!1,expects:"".concat(t),locales:e,requirement:t,message:n,"~run":function(e,t){if(e.typed){var n=tj(this.locales,e.value);n!==this.requirement&&tN(this,"words",e,t,{received:"".concat(n)})}return e}}}function r8(e,t){var n=e["~run"]({value:t},{abortEarly:!0}).issues;if(n)throw new t$(n)}function ie(e,t){return u(u({},e),{},{get"~standard"(){return tG(this)},"~run":function(n,r){return e["~run"](n,u(u({},r),t))}})}function it(e,t,n){return"function"==typeof e.fallback?e.fallback(t,n):e.fallback}function ir(e,t){return u(u({},e),{},{fallback:t,get"~standard"(){return tG(this)},"~run":function(t,n){var r=e["~run"](t,n);return r.issues?{typed:!0,value:it(this,r,n)}:r}})}function ii(e,t){return u(u({},e),{},{fallback:t,async:!0,get"~standard"(){return tG(this)},"~run":function(t,n){var r=this;return d(c().mark(function i(){var s;return c().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e["~run"](t,n);case 2:if(!(s=i.sent).issues){i.next=10;break}return i.next=6,it(r,s,n);case 6:i.t1=i.sent,i.t0={typed:!0,value:i.t1},i.next=11;break;case 10:i.t0=s;case 11:return i.abrupt("return",i.t0);case 12:case"end":return i.stop()}},i)}))()}})}function is(e){var t,n={},r=D(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.path){var s=tH(i);s?(n.nested||(n.nested={}),n.nested[s]?n.nested[s].push(i.message):n.nested[s]=[i.message]):n.other?n.other.push(i.message):n.other=[i.message]}else n.root?n.root.push(i.message):n.root=[i.message]}}catch(e){r.e(e)}finally{r.f()}return n}function io(e,t){return u(u({},e),{},{"~run":function(n,r){var i=n.issues&&k(n.issues);if((n=e["~run"](n,r)).issues){var s,o=D(n.issues);try{for(o.s();!(s=o.n()).done;){var a=s.value;if(null==i||!i.includes(a)){var u,c=n.value,l=D(t);try{for(l.s();!(u=l.n()).done;){var p=u.value,f=c[p],d={type:"unknown",origin:"value",input:c,key:p,value:f};if(a.path?a.path.push(d):a.path=[d],!f)break;c=f}}catch(e){l.e(e)}finally{l.f()}}}}catch(e){o.e(e)}finally{o.f()}}return n}})}function ia(e,t){return u(u({},e),{},{async:!0,"~run":function(n,r){return d(c().mark(function i(){var s,o,a,u,l,p,f,d,h,y;return c().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return s=n.issues&&k(n.issues),i.next=3,e["~run"](n,r);case 3:if(!(n=i.sent).issues){i.next=43;break}o=D(n.issues),i.prev=6,o.s();case 8:if((a=o.n()).done){i.next=35;break}if(u=a.value,null!=s&&s.includes(u)){i.next=33;break}l=n.value,p=D(t),i.prev=13,p.s();case 15:if((f=p.n()).done){i.next=25;break}if(h=l[d=f.value],y={type:"unknown",origin:"value",input:l,key:d,value:h},u.path?u.path.push(y):u.path=[y],h){i.next=22;break}return i.abrupt("break",25);case 22:l=h;case 23:i.next=15;break;case 25:i.next=30;break;case 27:i.prev=27,i.t0=i.catch(13),p.e(i.t0);case 30:return i.prev=30,p.f(),i.finish(30);case 33:i.next=8;break;case 35:i.next=40;break;case 37:i.prev=37,i.t1=i.catch(6),o.e(i.t1);case 40:return i.prev=40,o.f(),i.finish(40);case 43:return i.abrupt("return",n);case 44:case"end":return i.stop()}},i,null,[[6,37,40,43],[13,27,30,33]])}))()}})}function iu(e,t,n){return"function"==typeof e.default?e.default(t,n):e.default}function ic(e){return il.apply(this,arguments)}function il(){return(il=d(c().mark(function e(t){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!("entries"in t)){e.next=6;break}return e.t0=Object,e.next=4,Promise.all(Object.entries(t.entries).map(function(){var e=d(c().mark(function e(t){var n,r,i;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=_(t,2))[0],i=n[1],e.t0=r,e.next=4,ic(i);case 4:return e.t1=e.sent,e.abrupt("return",[e.t0,e.t1]);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 4:return e.t1=e.sent,e.abrupt("return",e.t0.fromEntries.call(e.t0,e.t1));case 6:if(!("items"in t)){e.next=8;break}return e.abrupt("return",Promise.all(t.items.map(ic)));case 8:return e.abrupt("return",iu(t));case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ip(e){return id.apply(this,arguments)}function id(){return(id=d(c().mark(function e(t){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!("entries"in t)){e.next=6;break}return e.t0=Object,e.next=4,Promise.all(Object.entries(t.entries).map(function(){var e=d(c().mark(function e(t){var n,r,i;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=_(t,2))[0],i=n[1],e.t0=r,e.next=4,ip(i);case 4:return e.t1=e.sent,e.abrupt("return",[e.t0,e.t1]);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 4:return e.t1=e.sent,e.abrupt("return",e.t0.fromEntries.call(e.t0,e.t1));case 6:if(!("items"in t)){e.next=8;break}return e.abrupt("return",Promise.all(t.items.map(ip)));case 8:return e.abrupt("return",it(t));case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ih(e,t){return!e["~run"]({value:t},{abortEarly:!0}).issues}function iy(){return{kind:"schema",type:"any",reference:iy,expects:"any",async:!1,get"~standard"(){return tG(this)},"~run":function(e){return e.typed=!0,e}}}function iv(e,t){return{kind:"schema",type:"array",reference:iv,expects:"Array",async:!1,item:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=e.value;if(Array.isArray(n)){e.typed=!0,e.value=[];for(var r=0;r<n.length;r++){var i=n[r],s=this.item["~run"]({value:i},t);if(s.issues){var o,a={type:"array",origin:"value",input:n,key:r,value:i},u=D(s.issues);try{for(u.s();!(o=u.n()).done;){var c,l=o.value;l.path?l.path.unshift(a):l.path=[a],null==(c=e.issues)||c.push(l)}}catch(e){u.e(e)}finally{u.f()}if(e.issues||(e.issues=s.issues),t.abortEarly){e.typed=!1;break}}s.typed||(e.typed=!1),e.value.push(s.value)}}else tN(this,"type",e,t);return e}}}function im(e,t){return{kind:"schema",type:"array",reference:im,expects:"Array",async:!0,item:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){var i,s,o,a,u,l,p,f,d;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!Array.isArray(i=e.value)){r.next=25;break}return e.typed=!0,e.value=[],r.next=6,Promise.all(i.map(function(e){return n.item["~run"]({value:e},t)}));case 6:s=r.sent,o=0;case 8:if(!(o<s.length)){r.next=23;break}if(!(a=s[o]).issues){r.next=18;break}u={type:"array",origin:"value",input:i,key:o,value:i[o]},l=D(a.issues);try{for(l.s();!(p=l.n()).done;)(d=p.value).path?d.path.unshift(u):d.path=[u],null==(f=e.issues)||f.push(d)}catch(e){l.e(e)}finally{l.f()}if(e.issues||(e.issues=a.issues),!t.abortEarly){r.next=18;break}return e.typed=!1,r.abrupt("break",23);case 18:a.typed||(e.typed=!1),e.value.push(a.value);case 20:o++,r.next=8;break;case 23:r.next=26;break;case 25:tN(n,"type",e,t);case 26:return r.abrupt("return",e);case 27:case"end":return r.stop()}},r)}))()}}}function ig(e){return{kind:"schema",type:"bigint",reference:ig,expects:"bigint",async:!1,message:e,get"~standard"(){return tG(this)},"~run":function(e,t){return"bigint"==typeof e.value?e.typed=!0:tN(this,"type",e,t),e}}}function ib(e){return{kind:"schema",type:"blob",reference:ib,expects:"Blob",async:!1,message:e,get"~standard"(){return tG(this)},"~run":function(e,t){return e.value instanceof Blob?e.typed=!0:tN(this,"type",e,t),e}}}function iE(e){return{kind:"schema",type:"boolean",reference:iE,expects:"boolean",async:!1,message:e,get"~standard"(){return tG(this)},"~run":function(e,t){return"boolean"==typeof e.value?e.typed=!0:tN(this,"type",e,t),e}}}function iS(e,t){return{kind:"schema",type:"custom",reference:iS,expects:"unknown",async:!1,check:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){return this.check(e.value)?e.typed=!0:tN(this,"type",e,t),e}}}function i_(e,t){return{kind:"schema",type:"custom",reference:i_,expects:"unknown",async:!0,check:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.check(e.value);case 2:if(!r.sent){r.next=6;break}e.typed=!0,r.next=7;break;case 6:tN(n,"type",e,t);case 7:return r.abrupt("return",e);case 8:case"end":return r.stop()}},r)}))()}}}function ik(e){return{kind:"schema",type:"date",reference:ik,expects:"Date",async:!1,message:e,get"~standard"(){return tG(this)},"~run":function(e,t){return e.value instanceof Date?isNaN(e.value)?tN(this,"type",e,t,{received:'"Invalid Date"'}):e.typed=!0:tN(this,"type",e,t),e}}}function iC(e,t){var n=[];for(var r in e)"".concat(+r)===r&&"string"==typeof e[r]&&Object.is(e[e[r]],+r)||n.push(e[r]);return{kind:"schema",type:"enum",reference:iC,expects:tq(n.map(tO),"|"),async:!1,enum:e,options:n,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){return this.options.includes(e.value)?e.typed=!0:tN(this,"type",e,t),e}}}function iM(e,t){return{kind:"schema",type:"exact_optional",reference:iM,expects:e.expects,async:!1,wrapped:e,default:t,get"~standard"(){return tG(this)},"~run":function(e,t){return this.wrapped["~run"](e,t)}}}function iD(e,t){return{kind:"schema",type:"exact_optional",reference:iD,expects:e.expects,async:!0,wrapped:e,default:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.wrapped["~run"](e,t));case 1:case"end":return r.stop()}},r)}))()}}}function iw(e){return{kind:"schema",type:"file",reference:iw,expects:"File",async:!1,message:e,get"~standard"(){return tG(this)},"~run":function(e,t){return e.value instanceof File?e.typed=!0:tN(this,"type",e,t),e}}}function iI(e){return{kind:"schema",type:"function",reference:iI,expects:"Function",async:!1,message:e,get"~standard"(){return tG(this)},"~run":function(e,t){return"function"==typeof e.value?e.typed=!0:tN(this,"type",e,t),e}}}function ix(e,t){return{kind:"schema",type:"instance",reference:ix,expects:e.name,async:!1,class:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){return e.value instanceof this.class?e.typed=!0:tN(this,"type",e,t),e}}}function iT(e,t){if(p(e)===p(t)){if(e===t||e instanceof Date&&t instanceof Date&&+e==+t)return{value:e};if(e&&t&&e.constructor===Object&&t.constructor===Object){for(var n in t)if(n in e){var r=iT(e[n],t[n]);if(r.issue)return r;e[n]=r.value}else e[n]=t[n];return{value:e}}if(Array.isArray(e)&&Array.isArray(t)&&e.length===t.length){for(var i=0;i<e.length;i++){var s=iT(e[i],t[i]);if(s.issue)return s;e[i]=s.value}return{value:e}}}return{issue:!0}}function iP(e,t){return{kind:"schema",type:"intersect",reference:iP,expects:tq(e.map(function(e){return e.expects}),"&"),async:!1,options:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){if(this.options.length){var n,r=e.value;e.typed=!0;var i,s=D(this.options);try{for(s.s();!(i=s.n()).done;){var o,a=i.value["~run"]({value:r},t);if(a.issues&&(e.issues?(o=e.issues).push.apply(o,k(a.issues)):e.issues=a.issues,t.abortEarly)){e.typed=!1;break}a.typed||(e.typed=!1),e.typed&&(n?n.push(a.value):n=[a.value])}}catch(e){s.e(e)}finally{s.f()}if(e.typed){e.value=n[0];for(var u=1;u<n.length;u++){var c=iT(e.value,n[u]);if(c.issue){tN(this,"type",e,t,{received:"unknown"});break}e.value=c.value}}}else tN(this,"type",e,t);return e}}}function iA(e,t){return{kind:"schema",type:"intersect",reference:iA,expects:tq(e.map(function(e){return e.expects}),"&"),async:!0,options:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){var i,s,o,a,u,l,p,f;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!n.options.length){r.next=42;break}return i=e.value,e.typed=!0,r.next=5,Promise.all(n.options.map(function(e){return e["~run"]({value:i},t)}));case 5:o=D(r.sent),r.prev=7,o.s();case 9:if((a=o.n()).done){r.next=20;break}if(!(u=a.value).issues||(e.issues?(l=e.issues).push.apply(l,k(u.issues)):e.issues=u.issues,!t.abortEarly)){r.next=16;break}return e.typed=!1,r.abrupt("break",20);case 16:u.typed||(e.typed=!1),e.typed&&(s?s.push(u.value):s=[u.value]);case 18:r.next=9;break;case 20:r.next=25;break;case 22:r.prev=22,r.t0=r.catch(7),o.e(r.t0);case 25:return r.prev=25,o.f(),r.finish(25);case 28:if(!e.typed){r.next=40;break}e.value=s[0],p=1;case 31:if(!(p<s.length)){r.next=40;break}if(!(f=iT(e.value,s[p])).issue){r.next=36;break}return tN(n,"type",e,t,{received:"unknown"}),r.abrupt("break",40);case 36:e.value=f.value;case 37:p++,r.next=31;break;case 40:r.next=43;break;case 42:tN(n,"type",e,t);case 43:return r.abrupt("return",e);case 44:case"end":return r.stop()}},r,null,[[7,22,25,28]])}))()}}}function iO(e){return{kind:"schema",type:"lazy",reference:iO,expects:"unknown",async:!1,getter:e,get"~standard"(){return tG(this)},"~run":function(e,t){return this.getter(e.value)["~run"](e,t)}}}function iN(e){return{kind:"schema",type:"lazy",reference:iN,expects:"unknown",async:!0,getter:e,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getter(e.value);case 2:return r.abrupt("return",r.sent["~run"](e,t));case 3:case"end":return r.stop()}},r)}))()}}}function iR(e,t){return{kind:"schema",type:"literal",reference:iR,expects:tO(e),async:!1,literal:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){return e.value===this.literal?e.typed=!0:tN(this,"type",e,t),e}}}function iF(e,t){return{kind:"schema",type:"loose_object",reference:iF,expects:"Object",async:!1,entries:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=e.value;if(n&&"object"===p(n)){for(var r in e.typed=!0,e.value={},this.entries){var i=this.entries[r];if(r in n||("exact_optional"===i.type||"optional"===i.type||"nullish"===i.type)&&void 0!==i.default){var s=r in n?n[r]:iu(i),o=i["~run"]({value:s},t);if(o.issues){var a,u={type:"object",origin:"value",input:n,key:r,value:s},c=D(o.issues);try{for(c.s();!(a=c.n()).done;){var l,f=a.value;f.path?f.path.unshift(u):f.path=[u],null==(l=e.issues)||l.push(f)}}catch(e){c.e(e)}finally{c.f()}if(e.issues||(e.issues=o.issues),t.abortEarly){e.typed=!1;break}}o.typed||(e.typed=!1),e.value[r]=o.value}else if(void 0!==i.fallback)e.value[r]=it(i);else if("exact_optional"!==i.type&&"optional"!==i.type&&"nullish"!==i.type&&(tN(this,"key",e,t,{input:void 0,expected:'"'.concat(r,'"'),path:[{type:"object",origin:"key",input:n,key:r,value:n[r]}]}),t.abortEarly))break}if(!e.issues||!t.abortEarly)for(var d in n)!tL(n,d)||d in this.entries||(e.value[d]=n[d])}else tN(this,"type",e,t);return e}}}function iG(e,t){return{kind:"schema",type:"loose_object",reference:iG,expects:"Object",async:!0,entries:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){var i,s,o,a,u,l,f,h,y,v,m,g,b,E;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=e.value)||"object"!==p(i)){r.next=48;break}return e.typed=!0,e.value={},r.next=6,Promise.all(Object.entries(n.entries).map(function(){var e=d(c().mark(function e(n){var r,s,o,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=(r=_(n,2))[0],o=r[1],!(s in i)&&("exact_optional"!==o.type&&"optional"!==o.type&&"nullish"!==o.type||void 0===o.default)){e.next=17;break}if(!(s in i)){e.next=6;break}e.t0=i[s],e.next=9;break;case 6:return e.next=8,iu(o);case 8:e.t0=e.sent;case 9:return a=e.t0,e.t1=s,e.t2=a,e.t3=o,e.next=15,o["~run"]({value:a},t);case 15:return e.t4=e.sent,e.abrupt("return",[e.t1,e.t2,e.t3,e.t4]);case 17:return e.abrupt("return",[s,i[s],o,null]);case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 6:s=D(r.sent),r.prev=8,s.s();case 10:if((o=s.n()).done){r.next=37;break}if(u=(a=_(o.value,4))[0],l=a[1],f=a[2],!(h=a[3])){r.next=25;break}if(!h.issues){r.next=21;break}y={type:"object",origin:"value",input:i,key:u,value:l},v=D(h.issues);try{for(v.s();!(m=v.n()).done;)(b=m.value).path?b.path.unshift(y):b.path=[y],null==(g=e.issues)||g.push(b)}catch(e){v.e(e)}finally{v.f()}if(e.issues||(e.issues=h.issues),!t.abortEarly){r.next=21;break}return e.typed=!1,r.abrupt("break",37);case 21:h.typed||(e.typed=!1),e.value[u]=h.value,r.next=35;break;case 25:if(void 0===f.fallback){r.next=31;break}return r.next=28,it(f);case 28:e.value[u]=r.sent,r.next=35;break;case 31:if("exact_optional"===f.type||"optional"===f.type||"nullish"===f.type||(tN(n,"key",e,t,{input:void 0,expected:'"'.concat(u,'"'),path:[{type:"object",origin:"key",input:i,key:u,value:l}]}),!t.abortEarly)){r.next=35;break}return r.abrupt("break",37);case 35:r.next=10;break;case 37:r.next=42;break;case 39:r.prev=39,r.t0=r.catch(8),s.e(r.t0);case 42:return r.prev=42,s.f(),r.finish(42);case 45:if(!e.issues||!t.abortEarly)for(E in i)!tL(i,E)||E in n.entries||(e.value[E]=i[E]);r.next=49;break;case 48:tN(n,"type",e,t);case 49:return r.abrupt("return",e);case 50:case"end":return r.stop()}},r,null,[[8,39,42,45]])}))()}}}function ij(e,t){return{kind:"schema",type:"loose_tuple",reference:ij,expects:"Array",async:!1,items:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=e.value;if(Array.isArray(n)){e.typed=!0,e.value=[];for(var r=0;r<this.items.length;r++){var i=n[r],s=this.items[r]["~run"]({value:i},t);if(s.issues){var o,a={type:"array",origin:"value",input:n,key:r,value:i},u=D(s.issues);try{for(u.s();!(o=u.n()).done;){var c,l=o.value;l.path?l.path.unshift(a):l.path=[a],null==(c=e.issues)||c.push(l)}}catch(e){u.e(e)}finally{u.f()}if(e.issues||(e.issues=s.issues),t.abortEarly){e.typed=!1;break}}s.typed||(e.typed=!1),e.value.push(s.value)}if(!e.issues||!t.abortEarly)for(var p=this.items.length;p<n.length;p++)e.value.push(n[p])}else tN(this,"type",e,t);return e}}}function iU(e,t){return{kind:"schema",type:"loose_tuple",reference:iU,expects:"Array",async:!0,items:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){var i,s,o,a,u,l,p,f,h,y,v,m,g;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!Array.isArray(i=e.value)){r.next=35;break}return e.typed=!0,e.value=[],r.next=6,Promise.all(n.items.map(function(){var e=d(c().mark(function e(n,r){var s;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=i[r],e.t0=r,e.t1=s,e.next=5,n["~run"]({value:s},t);case 5:return e.t2=e.sent,e.abrupt("return",[e.t0,e.t1,e.t2]);case 7:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 6:s=D(r.sent),r.prev=8,s.s();case 10:if((o=s.n()).done){r.next=24;break}if(u=(a=_(o.value,3))[0],l=a[1],!(p=a[2]).issues){r.next=20;break}f={type:"array",origin:"value",input:i,key:u,value:l},h=D(p.issues);try{for(h.s();!(y=h.n()).done;)(m=y.value).path?m.path.unshift(f):m.path=[f],null==(v=e.issues)||v.push(m)}catch(e){h.e(e)}finally{h.f()}if(e.issues||(e.issues=p.issues),!t.abortEarly){r.next=20;break}return e.typed=!1,r.abrupt("break",24);case 20:p.typed||(e.typed=!1),e.value.push(p.value);case 22:r.next=10;break;case 24:r.next=29;break;case 26:r.prev=26,r.t0=r.catch(8),s.e(r.t0);case 29:return r.prev=29,s.f(),r.finish(29);case 32:if(!e.issues||!t.abortEarly)for(g=n.items.length;g<i.length;g++)e.value.push(i[g]);r.next=36;break;case 35:tN(n,"type",e,t);case 36:return r.abrupt("return",e);case 37:case"end":return r.stop()}},r,null,[[8,26,29,32]])}))()}}}function iB(e,t,n){return{kind:"schema",type:"map",reference:iB,expects:"Map",async:!1,key:e,value:t,message:n,get"~standard"(){return tG(this)},"~run":function(e,t){var n=e.value;if(n instanceof Map){e.typed=!0,e.value=new Map;var r,i=D(n);try{for(i.s();!(r=i.n()).done;){var s=_(r.value,2),o=s[0],a=s[1],u=this.key["~run"]({value:o},t);if(u.issues){var c,l={type:"map",origin:"key",input:n,key:o,value:a},p=D(u.issues);try{for(p.s();!(c=p.n()).done;){var f,d=c.value;d.path?d.path.unshift(l):d.path=[l],null==(f=e.issues)||f.push(d)}}catch(e){p.e(e)}finally{p.f()}if(e.issues||(e.issues=u.issues),t.abortEarly){e.typed=!1;break}}var h=this.value["~run"]({value:a},t);if(h.issues){var y,v={type:"map",origin:"value",input:n,key:o,value:a},m=D(h.issues);try{for(m.s();!(y=m.n()).done;){var g,b=y.value;b.path?b.path.unshift(v):b.path=[v],null==(g=e.issues)||g.push(b)}}catch(e){m.e(e)}finally{m.f()}if(e.issues||(e.issues=h.issues),t.abortEarly){e.typed=!1;break}}u.typed&&h.typed||(e.typed=!1),e.value.set(u.value,h.value)}}catch(e){i.e(e)}finally{i.f()}}else tN(this,"type",e,t);return e}}}function iL(e,t,n){return{kind:"schema",type:"map",reference:iL,expects:"Map",async:!0,key:e,value:t,message:n,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){var i,s,o,a,u,l,p,f,d,h,y,v,m,g,b,E,S,C;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!((i=e.value)instanceof Map)){r.next=42;break}return e.typed=!0,e.value=new Map,r.next=6,Promise.all(k(i).map(function(e){var r=_(e,2),i=r[0],s=r[1];return Promise.all([i,s,n.key["~run"]({value:i},t),n.value["~run"]({value:s},t)])}));case 6:s=D(r.sent),r.prev=8,s.s();case 10:if((o=s.n()).done){r.next=32;break}if(u=(a=_(o.value,4))[0],l=a[1],p=a[2],f=a[3],!p.issues){r.next=20;break}d={type:"map",origin:"key",input:i,key:u,value:l},h=D(p.issues);try{for(h.s();!(y=h.n()).done;)(m=y.value).path?m.path.unshift(d):m.path=[d],null==(v=e.issues)||v.push(m)}catch(e){h.e(e)}finally{h.f()}if(e.issues||(e.issues=p.issues),!t.abortEarly){r.next=20;break}return e.typed=!1,r.abrupt("break",32);case 20:if(!f.issues){r.next=28;break}g={type:"map",origin:"value",input:i,key:u,value:l},b=D(f.issues);try{for(b.s();!(E=b.n()).done;)(C=E.value).path?C.path.unshift(g):C.path=[g],null==(S=e.issues)||S.push(C)}catch(e){b.e(e)}finally{b.f()}if(e.issues||(e.issues=f.issues),!t.abortEarly){r.next=28;break}return e.typed=!1,r.abrupt("break",32);case 28:p.typed&&f.typed||(e.typed=!1),e.value.set(p.value,f.value);case 30:r.next=10;break;case 32:r.next=37;break;case 34:r.prev=34,r.t0=r.catch(8),s.e(r.t0);case 37:return r.prev=37,s.f(),r.finish(37);case 40:r.next=43;break;case 42:tN(n,"type",e,t);case 43:return r.abrupt("return",e);case 44:case"end":return r.stop()}},r,null,[[8,34,37,40]])}))()}}}function iq(e){return{kind:"schema",type:"nan",reference:iq,expects:"NaN",async:!1,message:e,get"~standard"(){return tG(this)},"~run":function(e,t){return Number.isNaN(e.value)?e.typed=!0:tN(this,"type",e,t),e}}}function iV(e){return{kind:"schema",type:"never",reference:iV,expects:"never",async:!1,message:e,get"~standard"(){return tG(this)},"~run":function(e,t){return tN(this,"type",e,t),e}}}function iz(e,t){return{kind:"schema",type:"non_nullable",reference:iz,expects:"!null",async:!1,wrapped:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){return null!==e.value&&(e=this.wrapped["~run"](e,t)),null===e.value&&tN(this,"type",e,t),e}}}function iH(e,t){return{kind:"schema",type:"non_nullable",reference:iH,expects:"!null",async:!0,wrapped:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null===e.value){r.next=4;break}return r.next=3,n.wrapped["~run"](e,t);case 3:e=r.sent;case 4:return null===e.value&&tN(n,"type",e,t),r.abrupt("return",e);case 6:case"end":return r.stop()}},r)}))()}}}function iW(e,t){return{kind:"schema",type:"non_nullish",reference:iW,expects:"(!null & !undefined)",async:!1,wrapped:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){return null!==e.value&&void 0!==e.value&&(e=this.wrapped["~run"](e,t)),null!==e.value&&void 0!==e.value||tN(this,"type",e,t),e}}}function iX(e,t){return{kind:"schema",type:"non_nullish",reference:iX,expects:"(!null & !undefined)",async:!0,wrapped:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null===e.value||void 0===e.value){r.next=4;break}return r.next=3,n.wrapped["~run"](e,t);case 3:e=r.sent;case 4:return null!==e.value&&void 0!==e.value||tN(n,"type",e,t),r.abrupt("return",e);case 6:case"end":return r.stop()}},r)}))()}}}function iJ(e,t){return{kind:"schema",type:"non_optional",reference:iJ,expects:"!undefined",async:!1,wrapped:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){return void 0!==e.value&&(e=this.wrapped["~run"](e,t)),void 0===e.value&&tN(this,"type",e,t),e}}}function i$(e,t){return{kind:"schema",type:"non_optional",reference:i$,expects:"!undefined",async:!0,wrapped:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0===e.value){r.next=4;break}return r.next=3,n.wrapped["~run"](e,t);case 3:e=r.sent;case 4:return void 0===e.value&&tN(n,"type",e,t),r.abrupt("return",e);case 6:case"end":return r.stop()}},r)}))()}}}function iY(e){return{kind:"schema",type:"null",reference:iY,expects:"null",async:!1,message:e,get"~standard"(){return tG(this)},"~run":function(e,t){return null===e.value?e.typed=!0:tN(this,"type",e,t),e}}}function iQ(e,t){return{kind:"schema",type:"nullable",reference:iQ,expects:"(".concat(e.expects," | null)"),async:!1,wrapped:e,default:t,get"~standard"(){return tG(this)},"~run":function(e,t){return null===e.value&&(void 0!==this.default&&(e.value=iu(this,e,t)),null===e.value)?(e.typed=!0,e):this.wrapped["~run"](e,t)}}}function iK(e,t){return{kind:"schema",type:"nullable",reference:iK,expects:"(".concat(e.expects," | null)"),async:!0,wrapped:e,default:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null!==e.value){r.next=8;break}if(void 0===n.default){r.next=5;break}return r.next=4,iu(n,e,t);case 4:e.value=r.sent;case 5:if(null!==e.value){r.next=8;break}return e.typed=!0,r.abrupt("return",e);case 8:return r.abrupt("return",n.wrapped["~run"](e,t));case 9:case"end":return r.stop()}},r)}))()}}}function iZ(e,t){return{kind:"schema",type:"nullish",reference:iZ,expects:"(".concat(e.expects," | null | undefined)"),async:!1,wrapped:e,default:t,get"~standard"(){return tG(this)},"~run":function(e,t){return null!==e.value&&void 0!==e.value||(void 0!==this.default&&(e.value=iu(this,e,t)),null!==e.value&&void 0!==e.value)?this.wrapped["~run"](e,t):(e.typed=!0,e)}}}function i0(e,t){return{kind:"schema",type:"nullish",reference:i0,expects:"(".concat(e.expects," | null | undefined)"),async:!0,wrapped:e,default:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null!==e.value&&void 0!==e.value){r.next=8;break}if(void 0===n.default){r.next=5;break}return r.next=4,iu(n,e,t);case 4:e.value=r.sent;case 5:if(null!==e.value&&void 0!==e.value){r.next=8;break}return e.typed=!0,r.abrupt("return",e);case 8:return r.abrupt("return",n.wrapped["~run"](e,t));case 9:case"end":return r.stop()}},r)}))()}}}function i1(e){return{kind:"schema",type:"number",reference:i1,expects:"number",async:!1,message:e,get"~standard"(){return tG(this)},"~run":function(e,t){return"number"!=typeof e.value||isNaN(e.value)?tN(this,"type",e,t):e.typed=!0,e}}}function i2(e,t){return{kind:"schema",type:"object",reference:i2,expects:"Object",async:!1,entries:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=e.value;if(n&&"object"===p(n))for(var r in e.typed=!0,e.value={},this.entries){var i=this.entries[r];if(r in n||("exact_optional"===i.type||"optional"===i.type||"nullish"===i.type)&&void 0!==i.default){var s=r in n?n[r]:iu(i),o=i["~run"]({value:s},t);if(o.issues){var a,u={type:"object",origin:"value",input:n,key:r,value:s},c=D(o.issues);try{for(c.s();!(a=c.n()).done;){var l,f=a.value;f.path?f.path.unshift(u):f.path=[u],null==(l=e.issues)||l.push(f)}}catch(e){c.e(e)}finally{c.f()}if(e.issues||(e.issues=o.issues),t.abortEarly){e.typed=!1;break}}o.typed||(e.typed=!1),e.value[r]=o.value}else if(void 0!==i.fallback)e.value[r]=it(i);else if("exact_optional"!==i.type&&"optional"!==i.type&&"nullish"!==i.type&&(tN(this,"key",e,t,{input:void 0,expected:'"'.concat(r,'"'),path:[{type:"object",origin:"key",input:n,key:r,value:n[r]}]}),t.abortEarly))break}else tN(this,"type",e,t);return e}}}function i3(e,t){return{kind:"schema",type:"object",reference:i3,expects:"Object",async:!0,entries:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){var i,s,o,a,u,l,f,h,y,v,m,g,b;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=e.value)||"object"!==p(i)){r.next=47;break}return e.typed=!0,e.value={},r.next=6,Promise.all(Object.entries(n.entries).map(function(){var e=d(c().mark(function e(n){var r,s,o,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=(r=_(n,2))[0],o=r[1],!(s in i)&&("exact_optional"!==o.type&&"optional"!==o.type&&"nullish"!==o.type||void 0===o.default)){e.next=17;break}if(!(s in i)){e.next=6;break}e.t0=i[s],e.next=9;break;case 6:return e.next=8,iu(o);case 8:e.t0=e.sent;case 9:return a=e.t0,e.t1=s,e.t2=a,e.t3=o,e.next=15,o["~run"]({value:a},t);case 15:return e.t4=e.sent,e.abrupt("return",[e.t1,e.t2,e.t3,e.t4]);case 17:return e.abrupt("return",[s,i[s],o,null]);case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 6:s=D(r.sent),r.prev=8,s.s();case 10:if((o=s.n()).done){r.next=37;break}if(u=(a=_(o.value,4))[0],l=a[1],f=a[2],!(h=a[3])){r.next=25;break}if(!h.issues){r.next=21;break}y={type:"object",origin:"value",input:i,key:u,value:l},v=D(h.issues);try{for(v.s();!(m=v.n()).done;)(b=m.value).path?b.path.unshift(y):b.path=[y],null==(g=e.issues)||g.push(b)}catch(e){v.e(e)}finally{v.f()}if(e.issues||(e.issues=h.issues),!t.abortEarly){r.next=21;break}return e.typed=!1,r.abrupt("break",37);case 21:h.typed||(e.typed=!1),e.value[u]=h.value,r.next=35;break;case 25:if(void 0===f.fallback){r.next=31;break}return r.next=28,it(f);case 28:e.value[u]=r.sent,r.next=35;break;case 31:if("exact_optional"===f.type||"optional"===f.type||"nullish"===f.type||(tN(n,"key",e,t,{input:void 0,expected:'"'.concat(u,'"'),path:[{type:"object",origin:"key",input:i,key:u,value:l}]}),!t.abortEarly)){r.next=35;break}return r.abrupt("break",37);case 35:r.next=10;break;case 37:r.next=42;break;case 39:r.prev=39,r.t0=r.catch(8),s.e(r.t0);case 42:return r.prev=42,s.f(),r.finish(42);case 45:r.next=48;break;case 47:tN(n,"type",e,t);case 48:return r.abrupt("return",e);case 49:case"end":return r.stop()}},r,null,[[8,39,42,45]])}))()}}}function i4(e,t,n){return{kind:"schema",type:"object_with_rest",reference:i4,expects:"Object",async:!1,entries:e,rest:t,message:n,get"~standard"(){return tG(this)},"~run":function(e,t){var n=e.value;if(n&&"object"===p(n)){for(var r in e.typed=!0,e.value={},this.entries){var i=this.entries[r];if(r in n||("exact_optional"===i.type||"optional"===i.type||"nullish"===i.type)&&void 0!==i.default){var s=r in n?n[r]:iu(i),o=i["~run"]({value:s},t);if(o.issues){var a,u={type:"object",origin:"value",input:n,key:r,value:s},c=D(o.issues);try{for(c.s();!(a=c.n()).done;){var l,f=a.value;f.path?f.path.unshift(u):f.path=[u],null==(l=e.issues)||l.push(f)}}catch(e){c.e(e)}finally{c.f()}if(e.issues||(e.issues=o.issues),t.abortEarly){e.typed=!1;break}}o.typed||(e.typed=!1),e.value[r]=o.value}else if(void 0!==i.fallback)e.value[r]=it(i);else if("exact_optional"!==i.type&&"optional"!==i.type&&"nullish"!==i.type&&(tN(this,"key",e,t,{input:void 0,expected:'"'.concat(r,'"'),path:[{type:"object",origin:"key",input:n,key:r,value:n[r]}]}),t.abortEarly))break}if(!e.issues||!t.abortEarly){for(var d in n)if(tL(n,d)&&!(d in this.entries)){var h=this.rest["~run"]({value:n[d]},t);if(h.issues){var y,v={type:"object",origin:"value",input:n,key:d,value:n[d]},m=D(h.issues);try{for(m.s();!(y=m.n()).done;){var g,b=y.value;b.path?b.path.unshift(v):b.path=[v],null==(g=e.issues)||g.push(b)}}catch(e){m.e(e)}finally{m.f()}if(e.issues||(e.issues=h.issues),t.abortEarly){e.typed=!1;break}}h.typed||(e.typed=!1),e.value[d]=h.value}}}else tN(this,"type",e,t);return e}}}function i6(e,t,n){return{kind:"schema",type:"object_with_rest",reference:i6,expects:"Object",async:!0,entries:e,rest:t,message:n,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){var i,s,o,a,u,l,f,h,y,v,m,g,b,E,S,k,C,M,w,I,x,T,P,A,O,N,R;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=e.value)||"object"!==p(i)){r.next=76;break}return e.typed=!0,e.value={},r.next=6,Promise.all([Promise.all(Object.entries(n.entries).map(function(){var e=d(c().mark(function e(n){var r,s,o,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=(r=_(n,2))[0],o=r[1],!(s in i)&&("exact_optional"!==o.type&&"optional"!==o.type&&"nullish"!==o.type||void 0===o.default)){e.next=17;break}if(!(s in i)){e.next=6;break}e.t0=i[s],e.next=9;break;case 6:return e.next=8,iu(o);case 8:e.t0=e.sent;case 9:return a=e.t0,e.t1=s,e.t2=a,e.t3=o,e.next=15,o["~run"]({value:a},t);case 15:return e.t4=e.sent,e.abrupt("return",[e.t1,e.t2,e.t3,e.t4]);case 17:return e.abrupt("return",[s,i[s],o,null]);case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())),Promise.all(Object.entries(i).filter(function(e){var t=_(e,1)[0];return tL(i,t)&&!(t in n.entries)}).map(function(){var e=d(c().mark(function e(r){var i,s,o;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=(i=_(r,2))[0],o=i[1],e.t0=s,e.t1=o,e.next=5,n.rest["~run"]({value:o},t);case 5:return e.t2=e.sent,e.abrupt("return",[e.t0,e.t1,e.t2]);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()))]);case 6:o=(s=_(r.sent,2))[0],a=s[1],u=D(o),r.prev=11,u.s();case 13:if((l=u.n()).done){r.next=40;break}if(h=(f=_(l.value,4))[0],y=f[1],v=f[2],!(m=f[3])){r.next=28;break}if(!m.issues){r.next=24;break}g={type:"object",origin:"value",input:i,key:h,value:y},b=D(m.issues);try{for(b.s();!(E=b.n()).done;)(k=E.value).path?k.path.unshift(g):k.path=[g],null==(S=e.issues)||S.push(k)}catch(e){b.e(e)}finally{b.f()}if(e.issues||(e.issues=m.issues),!t.abortEarly){r.next=24;break}return e.typed=!1,r.abrupt("break",40);case 24:m.typed||(e.typed=!1),e.value[h]=m.value,r.next=38;break;case 28:if(void 0===v.fallback){r.next=34;break}return r.next=31,it(v);case 31:e.value[h]=r.sent,r.next=38;break;case 34:if("exact_optional"===v.type||"optional"===v.type||"nullish"===v.type||(tN(n,"key",e,t,{input:void 0,expected:'"'.concat(h,'"'),path:[{type:"object",origin:"key",input:i,key:h,value:y}]}),!t.abortEarly)){r.next=38;break}return r.abrupt("break",40);case 38:r.next=13;break;case 40:r.next=45;break;case 42:r.prev=42,r.t0=r.catch(11),u.e(r.t0);case 45:return r.prev=45,u.f(),r.finish(45);case 48:if(e.issues&&t.abortEarly){r.next=74;break}C=D(a),r.prev=50,C.s();case 52:if((M=C.n()).done){r.next=66;break}if(I=(w=_(M.value,3))[0],x=w[1],!(T=w[2]).issues){r.next=62;break}P={type:"object",origin:"value",input:i,key:I,value:x},A=D(T.issues);try{for(A.s();!(O=A.n()).done;)(R=O.value).path?R.path.unshift(P):R.path=[P],null==(N=e.issues)||N.push(R)}catch(e){A.e(e)}finally{A.f()}if(e.issues||(e.issues=T.issues),!t.abortEarly){r.next=62;break}return e.typed=!1,r.abrupt("break",66);case 62:T.typed||(e.typed=!1),e.value[I]=T.value;case 64:r.next=52;break;case 66:r.next=71;break;case 68:r.prev=68,r.t1=r.catch(50),C.e(r.t1);case 71:return r.prev=71,C.f(),r.finish(71);case 74:r.next=77;break;case 76:tN(n,"type",e,t);case 77:return r.abrupt("return",e);case 78:case"end":return r.stop()}},r,null,[[11,42,45,48],[50,68,71,74]])}))()}}}function i5(e,t){return{kind:"schema",type:"optional",reference:i5,expects:"(".concat(e.expects," | undefined)"),async:!1,wrapped:e,default:t,get"~standard"(){return tG(this)},"~run":function(e,t){return void 0===e.value&&(void 0!==this.default&&(e.value=iu(this,e,t)),void 0===e.value)?(e.typed=!0,e):this.wrapped["~run"](e,t)}}}function i9(e,t){return{kind:"schema",type:"optional",reference:i9,expects:"(".concat(e.expects," | undefined)"),async:!0,wrapped:e,default:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0!==e.value){r.next=8;break}if(void 0===n.default){r.next=5;break}return r.next=4,iu(n,e,t);case 4:e.value=r.sent;case 5:if(void 0!==e.value){r.next=8;break}return e.typed=!0,r.abrupt("return",e);case 8:return r.abrupt("return",n.wrapped["~run"](e,t));case 9:case"end":return r.stop()}},r)}))()}}}function i7(e,t){return{kind:"schema",type:"picklist",reference:i7,expects:tq(e.map(tO),"|"),async:!1,options:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){return this.options.includes(e.value)?e.typed=!0:tN(this,"type",e,t),e}}}function i8(e){return{kind:"schema",type:"promise",reference:i8,expects:"Promise",async:!1,message:e,get"~standard"(){return tG(this)},"~run":function(e,t){return e.value instanceof Promise?e.typed=!0:tN(this,"type",e,t),e}}}function se(e,t,n){return{kind:"schema",type:"record",reference:se,expects:"Object",async:!1,key:e,value:t,message:n,get"~standard"(){return tG(this)},"~run":function(e,t){var n=e.value;if(n&&"object"===p(n)){for(var r in e.typed=!0,e.value={},n)if(tL(n,r)){var i=n[r],s=this.key["~run"]({value:r},t);if(s.issues){var o,a={type:"object",origin:"key",input:n,key:r,value:i},u=D(s.issues);try{for(u.s();!(o=u.n()).done;){var c,l=o.value;l.path=[a],null==(c=e.issues)||c.push(l)}}catch(e){u.e(e)}finally{u.f()}if(e.issues||(e.issues=s.issues),t.abortEarly){e.typed=!1;break}}var f=this.value["~run"]({value:i},t);if(f.issues){var d,h={type:"object",origin:"value",input:n,key:r,value:i},y=D(f.issues);try{for(y.s();!(d=y.n()).done;){var v,m=d.value;m.path?m.path.unshift(h):m.path=[h],null==(v=e.issues)||v.push(m)}}catch(e){y.e(e)}finally{y.f()}if(e.issues||(e.issues=f.issues),t.abortEarly){e.typed=!1;break}}s.typed&&f.typed||(e.typed=!1),s.typed&&(e.value[s.value]=f.value)}}else tN(this,"type",e,t);return e}}}function st(e,t,n){return{kind:"schema",type:"record",reference:st,expects:"Object",async:!0,key:e,value:t,message:n,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){var i,s,o,a,u,l,f,d,h,y,v,m,g,b,E,S,k,C;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=e.value)||"object"!==p(i)){r.next=42;break}return e.typed=!0,e.value={},r.next=6,Promise.all(Object.entries(i).filter(function(e){var t=_(e,1)[0];return tL(i,t)}).map(function(e){var r=_(e,2),i=r[0],s=r[1];return Promise.all([i,s,n.key["~run"]({value:i},t),n.value["~run"]({value:s},t)])}));case 6:s=D(r.sent),r.prev=8,s.s();case 10:if((o=s.n()).done){r.next=32;break}if(u=(a=_(o.value,4))[0],l=a[1],f=a[2],d=a[3],!f.issues){r.next=20;break}h={type:"object",origin:"key",input:i,key:u,value:l},y=D(f.issues);try{for(y.s();!(v=y.n()).done;)(g=v.value).path=[h],null==(m=e.issues)||m.push(g)}catch(e){y.e(e)}finally{y.f()}if(e.issues||(e.issues=f.issues),!t.abortEarly){r.next=20;break}return e.typed=!1,r.abrupt("break",32);case 20:if(!d.issues){r.next=28;break}b={type:"object",origin:"value",input:i,key:u,value:l},E=D(d.issues);try{for(E.s();!(S=E.n()).done;)(C=S.value).path?C.path.unshift(b):C.path=[b],null==(k=e.issues)||k.push(C)}catch(e){E.e(e)}finally{E.f()}if(e.issues||(e.issues=d.issues),!t.abortEarly){r.next=28;break}return e.typed=!1,r.abrupt("break",32);case 28:f.typed&&d.typed||(e.typed=!1),f.typed&&(e.value[f.value]=d.value);case 30:r.next=10;break;case 32:r.next=37;break;case 34:r.prev=34,r.t0=r.catch(8),s.e(r.t0);case 37:return r.prev=37,s.f(),r.finish(37);case 40:r.next=43;break;case 42:tN(n,"type",e,t);case 43:return r.abrupt("return",e);case 44:case"end":return r.stop()}},r,null,[[8,34,37,40]])}))()}}}function sn(e,t){return{kind:"schema",type:"set",reference:sn,expects:"Set",async:!1,value:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=e.value;if(n instanceof Set){e.typed=!0,e.value=new Set;var r,i=D(n);try{for(i.s();!(r=i.n()).done;){var s=r.value,o=this.value["~run"]({value:s},t);if(o.issues){var a,u={type:"set",origin:"value",input:n,key:null,value:s},c=D(o.issues);try{for(c.s();!(a=c.n()).done;){var l,p=a.value;p.path?p.path.unshift(u):p.path=[u],null==(l=e.issues)||l.push(p)}}catch(e){c.e(e)}finally{c.f()}if(e.issues||(e.issues=o.issues),t.abortEarly){e.typed=!1;break}}o.typed||(e.typed=!1),e.value.add(o.value)}}catch(e){i.e(e)}finally{i.f()}}else tN(this,"type",e,t);return e}}}function sr(e,t){return{kind:"schema",type:"set",reference:sr,expects:"Set",async:!0,value:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){var i,s,o,a,u,l,p,f,h,y,v;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!((i=e.value)instanceof Set)){r.next=34;break}return e.typed=!0,e.value=new Set,r.next=6,Promise.all(k(i).map(function(){var e=d(c().mark(function e(r){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=r,e.next=3,n.value["~run"]({value:r},t);case 3:return e.t1=e.sent,e.abrupt("return",[e.t0,e.t1]);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 6:s=D(r.sent),r.prev=8,s.s();case 10:if((o=s.n()).done){r.next=24;break}if(u=(a=_(o.value,2))[0],!(l=a[1]).issues){r.next=20;break}p={type:"set",origin:"value",input:i,key:null,value:u},f=D(l.issues);try{for(f.s();!(h=f.n()).done;)(v=h.value).path?v.path.unshift(p):v.path=[p],null==(y=e.issues)||y.push(v)}catch(e){f.e(e)}finally{f.f()}if(e.issues||(e.issues=l.issues),!t.abortEarly){r.next=20;break}return e.typed=!1,r.abrupt("break",24);case 20:l.typed||(e.typed=!1),e.value.add(l.value);case 22:r.next=10;break;case 24:r.next=29;break;case 26:r.prev=26,r.t0=r.catch(8),s.e(r.t0);case 29:return r.prev=29,s.f(),r.finish(29);case 32:r.next=35;break;case 34:tN(n,"type",e,t);case 35:return r.abrupt("return",e);case 36:case"end":return r.stop()}},r,null,[[8,26,29,32]])}))()}}}function si(e,t){return{kind:"schema",type:"strict_object",reference:si,expects:"Object",async:!1,entries:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=e.value;if(n&&"object"===p(n)){for(var r in e.typed=!0,e.value={},this.entries){var i=this.entries[r];if(r in n||("exact_optional"===i.type||"optional"===i.type||"nullish"===i.type)&&void 0!==i.default){var s=r in n?n[r]:iu(i),o=i["~run"]({value:s},t);if(o.issues){var a,u={type:"object",origin:"value",input:n,key:r,value:s},c=D(o.issues);try{for(c.s();!(a=c.n()).done;){var l,f=a.value;f.path?f.path.unshift(u):f.path=[u],null==(l=e.issues)||l.push(f)}}catch(e){c.e(e)}finally{c.f()}if(e.issues||(e.issues=o.issues),t.abortEarly){e.typed=!1;break}}o.typed||(e.typed=!1),e.value[r]=o.value}else if(void 0!==i.fallback)e.value[r]=it(i);else if("exact_optional"!==i.type&&"optional"!==i.type&&"nullish"!==i.type&&(tN(this,"key",e,t,{input:void 0,expected:'"'.concat(r,'"'),path:[{type:"object",origin:"key",input:n,key:r,value:n[r]}]}),t.abortEarly))break}if(!e.issues||!t.abortEarly){for(var d in n)if(!(d in this.entries)){tN(this,"key",e,t,{input:d,expected:"never",path:[{type:"object",origin:"key",input:n,key:d,value:n[d]}]});break}}}else tN(this,"type",e,t);return e}}}function ss(e,t){return{kind:"schema",type:"strict_object",reference:ss,expects:"Object",async:!0,entries:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){var i,s,o,a,u,l,f,h,y,v,m,g,b,E;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=e.value)||"object"!==p(i)){r.next=56;break}return e.typed=!0,e.value={},r.next=6,Promise.all(Object.entries(n.entries).map(function(){var e=d(c().mark(function e(n){var r,s,o,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=(r=_(n,2))[0],o=r[1],!(s in i)&&("exact_optional"!==o.type&&"optional"!==o.type&&"nullish"!==o.type||void 0===o.default)){e.next=17;break}if(!(s in i)){e.next=6;break}e.t0=i[s],e.next=9;break;case 6:return e.next=8,iu(o);case 8:e.t0=e.sent;case 9:return a=e.t0,e.t1=s,e.t2=a,e.t3=o,e.next=15,o["~run"]({value:a},t);case 15:return e.t4=e.sent,e.abrupt("return",[e.t1,e.t2,e.t3,e.t4]);case 17:return e.abrupt("return",[s,i[s],o,null]);case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 6:s=D(r.sent),r.prev=8,s.s();case 10:if((o=s.n()).done){r.next=37;break}if(u=(a=_(o.value,4))[0],l=a[1],f=a[2],!(h=a[3])){r.next=25;break}if(!h.issues){r.next=21;break}y={type:"object",origin:"value",input:i,key:u,value:l},v=D(h.issues);try{for(v.s();!(m=v.n()).done;)(b=m.value).path?b.path.unshift(y):b.path=[y],null==(g=e.issues)||g.push(b)}catch(e){v.e(e)}finally{v.f()}if(e.issues||(e.issues=h.issues),!t.abortEarly){r.next=21;break}return e.typed=!1,r.abrupt("break",37);case 21:h.typed||(e.typed=!1),e.value[u]=h.value,r.next=35;break;case 25:if(void 0===f.fallback){r.next=31;break}return r.next=28,it(f);case 28:e.value[u]=r.sent,r.next=35;break;case 31:if("exact_optional"===f.type||"optional"===f.type||"nullish"===f.type||(tN(n,"key",e,t,{input:void 0,expected:'"'.concat(u,'"'),path:[{type:"object",origin:"key",input:i,key:u,value:l}]}),!t.abortEarly)){r.next=35;break}return r.abrupt("break",37);case 35:r.next=10;break;case 37:r.next=42;break;case 39:r.prev=39,r.t0=r.catch(8),s.e(r.t0);case 42:return r.prev=42,s.f(),r.finish(42);case 45:if(e.issues&&t.abortEarly){r.next=54;break}r.t1=c().keys(i);case 47:if((r.t2=r.t1()).done){r.next=54;break}if((E=r.t2.value)in n.entries){r.next=52;break}return tN(n,"key",e,t,{input:E,expected:"never",path:[{type:"object",origin:"key",input:i,key:E,value:i[E]}]}),r.abrupt("break",54);case 52:r.next=47;break;case 54:r.next=57;break;case 56:tN(n,"type",e,t);case 57:return r.abrupt("return",e);case 58:case"end":return r.stop()}},r,null,[[8,39,42,45]])}))()}}}function so(e,t){return{kind:"schema",type:"strict_tuple",reference:so,expects:"Array",async:!1,items:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=e.value;if(Array.isArray(n)){e.typed=!0,e.value=[];for(var r=0;r<this.items.length;r++){var i=n[r],s=this.items[r]["~run"]({value:i},t);if(s.issues){var o,a={type:"array",origin:"value",input:n,key:r,value:i},u=D(s.issues);try{for(u.s();!(o=u.n()).done;){var c,l=o.value;l.path?l.path.unshift(a):l.path=[a],null==(c=e.issues)||c.push(l)}}catch(e){u.e(e)}finally{u.f()}if(e.issues||(e.issues=s.issues),t.abortEarly){e.typed=!1;break}}s.typed||(e.typed=!1),e.value.push(s.value)}e.issues&&t.abortEarly||!(this.items.length<n.length)||tN(this,"type",e,t,{input:n[this.items.length],expected:"never",path:[{type:"array",origin:"value",input:n,key:this.items.length,value:n[this.items.length]}]})}else tN(this,"type",e,t);return e}}}function sa(e,t){return{kind:"schema",type:"strict_tuple",reference:sa,expects:"Array",async:!0,items:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){var i,s,o,a,u,l,p,f,h,y,v,m;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!Array.isArray(i=e.value)){r.next=35;break}return e.typed=!0,e.value=[],r.next=6,Promise.all(n.items.map(function(){var e=d(c().mark(function e(n,r){var s;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=i[r],e.t0=r,e.t1=s,e.next=5,n["~run"]({value:s},t);case 5:return e.t2=e.sent,e.abrupt("return",[e.t0,e.t1,e.t2]);case 7:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 6:s=D(r.sent),r.prev=8,s.s();case 10:if((o=s.n()).done){r.next=24;break}if(u=(a=_(o.value,3))[0],l=a[1],!(p=a[2]).issues){r.next=20;break}f={type:"array",origin:"value",input:i,key:u,value:l},h=D(p.issues);try{for(h.s();!(y=h.n()).done;)(m=y.value).path?m.path.unshift(f):m.path=[f],null==(v=e.issues)||v.push(m)}catch(e){h.e(e)}finally{h.f()}if(e.issues||(e.issues=p.issues),!t.abortEarly){r.next=20;break}return e.typed=!1,r.abrupt("break",24);case 20:p.typed||(e.typed=!1),e.value.push(p.value);case 22:r.next=10;break;case 24:r.next=29;break;case 26:r.prev=26,r.t0=r.catch(8),s.e(r.t0);case 29:return r.prev=29,s.f(),r.finish(29);case 32:e.issues&&t.abortEarly||!(n.items.length<i.length)||tN(n,"type",e,t,{input:i[n.items.length],expected:"never",path:[{type:"array",origin:"value",input:i,key:n.items.length,value:i[n.items.length]}]}),r.next=36;break;case 35:tN(n,"type",e,t);case 36:return r.abrupt("return",e);case 37:case"end":return r.stop()}},r,null,[[8,26,29,32]])}))()}}}function su(e){return{kind:"schema",type:"string",reference:su,expects:"string",async:!1,message:e,get"~standard"(){return tG(this)},"~run":function(e,t){return"string"==typeof e.value?e.typed=!0:tN(this,"type",e,t),e}}}function sc(e){return{kind:"schema",type:"symbol",reference:sc,expects:"symbol",async:!1,message:e,get"~standard"(){return tG(this)},"~run":function(e,t){return"symbol"===p(e.value)?e.typed=!0:tN(this,"type",e,t),e}}}function sl(e,t){return{kind:"schema",type:"tuple",reference:sl,expects:"Array",async:!1,items:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=e.value;if(Array.isArray(n)){e.typed=!0,e.value=[];for(var r=0;r<this.items.length;r++){var i=n[r],s=this.items[r]["~run"]({value:i},t);if(s.issues){var o,a={type:"array",origin:"value",input:n,key:r,value:i},u=D(s.issues);try{for(u.s();!(o=u.n()).done;){var c,l=o.value;l.path?l.path.unshift(a):l.path=[a],null==(c=e.issues)||c.push(l)}}catch(e){u.e(e)}finally{u.f()}if(e.issues||(e.issues=s.issues),t.abortEarly){e.typed=!1;break}}s.typed||(e.typed=!1),e.value.push(s.value)}}else tN(this,"type",e,t);return e}}}function sp(e,t){return{kind:"schema",type:"tuple",reference:sp,expects:"Array",async:!0,items:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){var i,s,o,a,u,l,p,f,h,y,v,m;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!Array.isArray(i=e.value)){r.next=34;break}return e.typed=!0,e.value=[],r.next=6,Promise.all(n.items.map(function(){var e=d(c().mark(function e(n,r){var s;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=i[r],e.t0=r,e.t1=s,e.next=5,n["~run"]({value:s},t);case 5:return e.t2=e.sent,e.abrupt("return",[e.t0,e.t1,e.t2]);case 7:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()));case 6:s=D(r.sent),r.prev=8,s.s();case 10:if((o=s.n()).done){r.next=24;break}if(u=(a=_(o.value,3))[0],l=a[1],!(p=a[2]).issues){r.next=20;break}f={type:"array",origin:"value",input:i,key:u,value:l},h=D(p.issues);try{for(h.s();!(y=h.n()).done;)(m=y.value).path?m.path.unshift(f):m.path=[f],null==(v=e.issues)||v.push(m)}catch(e){h.e(e)}finally{h.f()}if(e.issues||(e.issues=p.issues),!t.abortEarly){r.next=20;break}return e.typed=!1,r.abrupt("break",24);case 20:p.typed||(e.typed=!1),e.value.push(p.value);case 22:r.next=10;break;case 24:r.next=29;break;case 26:r.prev=26,r.t0=r.catch(8),s.e(r.t0);case 29:return r.prev=29,s.f(),r.finish(29);case 32:r.next=35;break;case 34:tN(n,"type",e,t);case 35:return r.abrupt("return",e);case 36:case"end":return r.stop()}},r,null,[[8,26,29,32]])}))()}}}function sf(e,t,n){return{kind:"schema",type:"tuple_with_rest",reference:sf,expects:"Array",async:!1,items:e,rest:t,message:n,get"~standard"(){return tG(this)},"~run":function(e,t){var n=e.value;if(Array.isArray(n)){e.typed=!0,e.value=[];for(var r=0;r<this.items.length;r++){var i=n[r],s=this.items[r]["~run"]({value:i},t);if(s.issues){var o,a={type:"array",origin:"value",input:n,key:r,value:i},u=D(s.issues);try{for(u.s();!(o=u.n()).done;){var c,l=o.value;l.path?l.path.unshift(a):l.path=[a],null==(c=e.issues)||c.push(l)}}catch(e){u.e(e)}finally{u.f()}if(e.issues||(e.issues=s.issues),t.abortEarly){e.typed=!1;break}}s.typed||(e.typed=!1),e.value.push(s.value)}if(!e.issues||!t.abortEarly)for(var p=this.items.length;p<n.length;p++){var f=n[p],d=this.rest["~run"]({value:f},t);if(d.issues){var h,y={type:"array",origin:"value",input:n,key:p,value:f},v=D(d.issues);try{for(v.s();!(h=v.n()).done;){var m,g=h.value;g.path?g.path.unshift(y):g.path=[y],null==(m=e.issues)||m.push(g)}}catch(e){v.e(e)}finally{v.f()}if(e.issues||(e.issues=d.issues),t.abortEarly){e.typed=!1;break}}d.typed||(e.typed=!1),e.value.push(d.value)}}else tN(this,"type",e,t);return e}}}function sd(e,t,n){return{kind:"schema",type:"tuple_with_rest",reference:sd,expects:"Array",async:!0,items:e,rest:t,message:n,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){var i,s,o,a,u,l,p,f,h,y,v,m,g,b,E,S,k,C,M,w,I,x,T,P,A,O;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!Array.isArray(i=e.value)){r.next=63;break}return e.typed=!0,e.value=[],r.next=6,Promise.all([Promise.all(n.items.map(function(){var e=d(c().mark(function e(n,r){var s;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=i[r],e.t0=r,e.t1=s,e.next=5,n["~run"]({value:s},t);case 5:return e.t2=e.sent,e.abrupt("return",[e.t0,e.t1,e.t2]);case 7:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}())),Promise.all(i.slice(n.items.length).map(function(){var e=d(c().mark(function e(r,i){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=i+n.items.length,e.t1=r,e.next=4,n.rest["~run"]({value:r},t);case 4:return e.t2=e.sent,e.abrupt("return",[e.t0,e.t1,e.t2]);case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()))]);case 6:o=(s=_(r.sent,2))[0],a=s[1],u=D(o),r.prev=11,u.s();case 13:if((l=u.n()).done){r.next=27;break}if(f=(p=_(l.value,3))[0],h=p[1],!(y=p[2]).issues){r.next=23;break}v={type:"array",origin:"value",input:i,key:f,value:h},m=D(y.issues);try{for(m.s();!(g=m.n()).done;)(E=g.value).path?E.path.unshift(v):E.path=[v],null==(b=e.issues)||b.push(E)}catch(e){m.e(e)}finally{m.f()}if(e.issues||(e.issues=y.issues),!t.abortEarly){r.next=23;break}return e.typed=!1,r.abrupt("break",27);case 23:y.typed||(e.typed=!1),e.value.push(y.value);case 25:r.next=13;break;case 27:r.next=32;break;case 29:r.prev=29,r.t0=r.catch(11),u.e(r.t0);case 32:return r.prev=32,u.f(),r.finish(32);case 35:if(e.issues&&t.abortEarly){r.next=61;break}S=D(a),r.prev=37,S.s();case 39:if((k=S.n()).done){r.next=53;break}if(M=(C=_(k.value,3))[0],w=C[1],!(I=C[2]).issues){r.next=49;break}x={type:"array",origin:"value",input:i,key:M,value:w},T=D(I.issues);try{for(T.s();!(P=T.n()).done;)(O=P.value).path?O.path.unshift(x):O.path=[x],null==(A=e.issues)||A.push(O)}catch(e){T.e(e)}finally{T.f()}if(e.issues||(e.issues=I.issues),!t.abortEarly){r.next=49;break}return e.typed=!1,r.abrupt("break",53);case 49:I.typed||(e.typed=!1),e.value.push(I.value);case 51:r.next=39;break;case 53:r.next=58;break;case 55:r.prev=55,r.t1=r.catch(37),S.e(r.t1);case 58:return r.prev=58,S.f(),r.finish(58);case 61:r.next=64;break;case 63:tN(n,"type",e,t);case 64:return r.abrupt("return",e);case 65:case"end":return r.stop()}},r,null,[[11,29,32,35],[37,55,58,61]])}))()}}}function sh(e){return{kind:"schema",type:"undefined",reference:sh,expects:"undefined",async:!1,message:e,get"~standard"(){return tG(this)},"~run":function(e,t){return void 0===e.value?e.typed=!0:tN(this,"type",e,t),e}}}function sy(e,t){return{kind:"schema",type:"undefinedable",reference:sy,expects:"(".concat(e.expects," | undefined)"),async:!1,wrapped:e,default:t,get"~standard"(){return tG(this)},"~run":function(e,t){return void 0===e.value&&(void 0!==this.default&&(e.value=iu(this,e,t)),void 0===e.value)?(e.typed=!0,e):this.wrapped["~run"](e,t)}}}function sv(e,t){return{kind:"schema",type:"undefinedable",reference:sv,expects:"(".concat(e.expects," | undefined)"),async:!0,wrapped:e,default:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0!==e.value){r.next=8;break}if(void 0===n.default){r.next=5;break}return r.next=4,iu(n,e,t);case 4:e.value=r.sent;case 5:if(void 0!==e.value){r.next=8;break}return e.typed=!0,r.abrupt("return",e);case 8:return r.abrupt("return",n.wrapped["~run"](e,t));case 9:case"end":return r.stop()}},r)}))()}}}function sm(e){var t;if(e){var n,r=D(e);try{for(r.s();!(n=r.n()).done;){var i,s=n.value;t?(i=t).push.apply(i,k(s.issues)):t=s.issues}}catch(e){r.e(e)}finally{r.f()}}return t}function sg(e,t){return{kind:"schema",type:"union",reference:sg,expects:tq(e.map(function(e){return e.expects}),"|"),async:!1,options:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n,r,i,s,o,a=D(this.options);try{for(a.s();!(o=a.n()).done;){var u=o.value["~run"]({value:e.value},t);if(u.typed){if(!u.issues){r=u;break}i?i.push(u):i=[u]}else s?s.push(u):s=[u]}}catch(e){a.e(e)}finally{a.f()}if(r)return r;if(i){if(1===i.length)return i[0];tN(this,"type",e,t,{issues:sm(i)}),e.typed=!0}else{if(1===(null==(n=s)?void 0:n.length))return s[0];tN(this,"type",e,t,{issues:sm(s)})}return e}}}function sb(e,t){return{kind:"schema",type:"union",reference:sb,expects:tq(e.map(function(e){return e.expects}),"|"),async:!0,options:e,message:t,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){var i,s,o,a,u,l,p,f;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:u=D(n.options),r.prev=1,u.s();case 3:if((l=u.n()).done){r.next=20;break}return p=l.value,r.next=7,p["~run"]({value:e.value},t);case 7:if(!(f=r.sent).typed){r.next=17;break}if(!f.issues){r.next=13;break}o?o.push(f):o=[f],r.next=15;break;case 13:return s=f,r.abrupt("break",20);case 15:r.next=18;break;case 17:a?a.push(f):a=[f];case 18:r.next=3;break;case 20:r.next=25;break;case 22:r.prev=22,r.t0=r.catch(1),u.e(r.t0);case 25:return r.prev=25,u.f(),r.finish(25);case 28:if(!s){r.next=30;break}return r.abrupt("return",s);case 30:if(!o){r.next=37;break}if(1!==o.length){r.next=33;break}return r.abrupt("return",o[0]);case 33:tN(n,"type",e,t,{issues:sm(o)}),e.typed=!0,r.next=42;break;case 37:if(1!==(null==(i=a)?void 0:i.length)){r.next=41;break}return r.abrupt("return",a[0]);case 41:tN(n,"type",e,t,{issues:sm(a)});case 42:return r.abrupt("return",e);case 43:case"end":return r.stop()}},r,null,[[1,22,25,28]])}))()}}}function sE(){return{kind:"schema",type:"unknown",reference:sE,expects:"unknown",async:!1,get"~standard"(){return tG(this)},"~run":function(e){return e.typed=!0,e}}}function sS(e,t,n){return{kind:"schema",type:"variant",reference:sS,expects:"Object",async:!1,key:e,options:t,message:n,get"~standard"(){return tG(this)},"~run":function(e,t){var n=e.value;if(n&&"object"===p(n)){var r,i=0,s=this.key,o=[];if(function e(a,u){var c,l=D(a.options);try{for(l.s();!(c=l.n()).done;){var p=c.value;if("variant"===p.type)e(p,new Set(u).add(p.key));else{var f,d=!0,h=0,y=D(u);try{for(y.s();!(f=y.n()).done;){var v=f.value,m=p.entries[v];if(v in n?m["~run"]({typed:!1,value:n[v]},t).issues:"exact_optional"!==m.type&&"optional"!==m.type&&"nullish"!==m.type){d=!1,s!==v&&(i<h||i===h&&v in n&&!(s in n))&&(i=h,s=v,o=[]),s===v&&o.push(p.entries[v].expects);break}h++}}catch(e){y.e(e)}finally{y.f()}if(d){var g=p["~run"]({value:n},t);r&&(r.typed||!g.typed)||(r=g)}}if(r&&!r.issues)break}}catch(e){l.e(e)}finally{l.f()}}(this,new Set([this.key])),r)return r;tN(this,"type",e,t,{input:n[s],expected:tq(o,"|"),path:[{type:"object",origin:"value",input:n,key:s,value:n[s]}]})}else tN(this,"type",e,t);return e}}}function s_(e,t,n){return{kind:"schema",type:"variant",reference:s_,expects:"Object",async:!0,key:e,options:t,message:n,get"~standard"(){return tG(this)},"~run":function(e,t){var n=this;return d(c().mark(function r(){var i,s,o,a,u,l;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=e.value)||"object"!==p(i)){r.next=13;break}return o=0,a=n.key,u=[],l=function(){var e=d(c().mark(function e(n,r){var p,f,d,h,y,v,m,g,b,E;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:p=D(n.options),e.prev=1,p.s();case 3:if((f=p.n()).done){e.next=50;break}if("variant"!==(d=f.value).type){e.next=10;break}return e.next=8,l(d,new Set(r).add(d.key));case 8:e.next=46;break;case 10:h=!0,y=0,v=D(r),e.prev=13,v.s();case 15:if((m=v.n()).done){e.next=33;break}if(g=m.value,b=d.entries[g],!(g in i)){e.next=24;break}return e.next=21,b["~run"]({typed:!1,value:i[g]},t);case 21:e.t0=e.sent.issues,e.next=25;break;case 24:e.t0="exact_optional"!==b.type&&"optional"!==b.type&&"nullish"!==b.type;case 25:if(!e.t0){e.next=30;break}return h=!1,a!==g&&(o<y||o===y&&g in i&&!(a in i))&&(o=y,a=g,u=[]),a===g&&u.push(d.entries[g].expects),e.abrupt("break",33);case 30:y++;case 31:e.next=15;break;case 33:e.next=38;break;case 35:e.prev=35,e.t1=e.catch(13),v.e(e.t1);case 38:return e.prev=38,v.f(),e.finish(38);case 41:if(!h){e.next=46;break}return e.next=44,d["~run"]({value:i},t);case 44:E=e.sent,s&&(s.typed||!E.typed)||(s=E);case 46:if(!s||s.issues){e.next=48;break}return e.abrupt("break",50);case 48:e.next=3;break;case 50:e.next=55;break;case 52:e.prev=52,e.t2=e.catch(1),p.e(e.t2);case 55:return e.prev=55,p.f(),e.finish(55);case 58:case"end":return e.stop()}},e,null,[[1,52,55,58],[13,35,38,41]])}));return function(t,n){return e.apply(this,arguments)}}(),r.next=8,l(n,new Set([n.key]));case 8:if(!s){r.next=10;break}return r.abrupt("return",s);case 10:tN(n,"type",e,t,{input:i[a],expected:tq(u,"|"),path:[{type:"object",origin:"value",input:i,key:a,value:i[a]}]}),r.next=14;break;case 13:tN(n,"type",e,t);case 14:return r.abrupt("return",e);case 15:case"end":return r.stop()}},r)}))()}}}function sk(e){return{kind:"schema",type:"void",reference:sk,expects:"void",async:!1,message:e,get"~standard"(){return tG(this)},"~run":function(e,t){return void 0===e.value?e.typed=!0:tN(this,"type",e,t),e}}}function sC(e,t){return i7(Object.keys(e.entries),t)}function sM(e,t){var n,r=u({},e.entries),i=D(t);try{for(i.s();!(n=i.n()).done;)delete r[n.value]}catch(e){i.e(e)}finally{i.f()}return u(u({},e),{},{entries:r,get"~standard"(){return tG(this)}})}function sD(e,t,n){var r=e["~run"]({value:t},t_(n));if(r.issues)throw new t$(r.issues);return r.value}function sw(e,t,n){return sI.apply(this,arguments)}function sI(){return(sI=d(c().mark(function e(t,n,r){var i;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t["~run"]({value:n},t_(r));case 2:if(!(i=e.sent).issues){e.next=5;break}throw new t$(i.issues);case 5:return e.abrupt("return",i.value);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function sx(e,t){var n=function(n){return sD(e,n,t)};return n.schema=e,n.config=t,n}function sT(e,t){var n=function(n){return sw(e,n,t)};return n.schema=e,n.config=t,n}function sP(e,t){var n={};for(var r in e.entries)n[r]=!t||t.includes(r)?i5(e.entries[r]):e.entries[r];return u(u({},e),{},{entries:n,get"~standard"(){return tG(this)}})}function sA(e,t){var n={};for(var r in e.entries)n[r]=!t||t.includes(r)?i9(e.entries[r]):e.entries[r];return u(u({},e),{},{entries:n,get"~standard"(){return tG(this)}})}function sO(e,t){var n,r={},i=D(t);try{for(i.s();!(n=i.n()).done;){var s=n.value;r[s]=e.entries[s]}}catch(e){i.e(e)}finally{i.f()}return u(u({},e),{},{entries:r,get"~standard"(){return tG(this)}})}function sN(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return u(u({},t[0]),{},{pipe:t,get"~standard"(){return tG(this)},"~run":function(e,n){for(var r=0;r<t.length;r++){var i=t[r];if("metadata"!==i.kind){if(e.issues&&("schema"===i.kind||"transformation"===i.kind)){e.typed=!1;break}e.issues&&(n.abortEarly||n.abortPipeEarly)||(e=i["~run"](e,n))}}return e}})}function sR(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return u(u({},t[0]),{},{pipe:t,async:!0,get"~standard"(){return tG(this)},"~run":function(e,n){return d(c().mark(function r(){var i,s,o;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=0,s=t;case 1:if(!(i<s.length)){r.next=14;break}if("metadata"===(o=s[i]).kind){r.next=11;break}if(!e.issues||"schema"!==o.kind&&"transformation"!==o.kind){r.next=7;break}return e.typed=!1,r.abrupt("break",14);case 7:if(e.issues&&(n.abortEarly||n.abortPipeEarly)){r.next=11;break}return r.next=10,o["~run"](e,n);case 10:e=r.sent;case 11:i++,r.next=1;break;case 14:return r.abrupt("return",e);case 15:case"end":return r.stop()}},r)}))()}})}function sF(e,t,n){var r=Array.isArray(t)?t:void 0,i=Array.isArray(t)?n:t,s={};for(var o in e.entries)s[o]=!r||r.includes(o)?iJ(e.entries[o],i):e.entries[o];return u(u({},e),{},{entries:s,get"~standard"(){return tG(this)}})}function sG(e,t,n){var r=Array.isArray(t)?t:void 0,i=Array.isArray(t)?n:t,s={};for(var o in e.entries)s[o]=!r||r.includes(o)?i$(e.entries[o],i):e.entries[o];return u(u({},e),{},{entries:s,get"~standard"(){return tG(this)}})}function sj(e,t,n){var r=e["~run"]({value:t},t_(n));return{typed:r.typed,success:!r.issues,output:r.value,issues:r.issues}}function sU(e,t,n){return sB.apply(this,arguments)}function sB(){return(sB=d(c().mark(function e(t,n,r){var i;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t["~run"]({value:n},t_(r));case 2:return i=e.sent,e.abrupt("return",{typed:i.typed,success:!i.issues,output:i.value,issues:i.issues});case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function sL(e,t){var n=function(n){return sj(e,n,t)};return n.schema=e,n.config=t,n}function sq(e,t){var n=function(n){return sU(e,n,t)};return n.schema=e,n.config=t,n}function sV(e){return e.wrapped}var sz,sH={};Object.defineProperty(sH,"__esModule",{value:!0}),sH.MessageType=void 0,(o_=sz||(sH.MessageType=sz={})).TEXT="text",o_.IMAGE="image",o_.FILE="file",o_.VIDEO="video",o_.AUDIO="audio";var sW={};Object.defineProperty(sW,"__esModule",{value:!0}),sW.Target=void 0,sW.Target=function(){function e(e,t,n){this.scene=e,this.id=t,ev.default.isDef(n)&&(this.teamId=n)}return e.prototype.toString=function(){return el.Scene.PRIVATE===this.scene||el.Scene.GROUP===this.scene?this.scene+"#"+this.id:this.scene+"#"+this.id+"#"+this.teamId},e.prototype.customerId=function(){if(el.Scene.CS===this.scene)return this.id===this.teamId?e8.G.Socket.user().id:this.id},e.byScene=function(t,n,r){return new e(t,n,r)},e.byIMMessage=function(t){var n,r,i=t.scene();if(i===el.Scene.PRIVATE){var s=t.senderId,o=t.targetId();r=e8.G.Socket.user().id===s?o:s}else if(i===el.Scene.GROUP)r=t.targetId();else{if(i!==el.Scene.CS)throw{code:400,content:"scene ".concat(i," not exists")};r=t.targetId(),n=t.teamId}return new e(i,r,n)},e.byMessageReadRemoteEvent=function(t){var n,r=t.scene,i=t.targetId,s=t.markerId,o=t.teamId;return r===el.Scene.PRIVATE?n=e8.G.Socket.user().id===s?i:s:r===el.Scene.GROUP?n=i:r===el.Scene.CS&&(n=i===o?s===e8.G.Socket.user().id?o:s:s===e8.G.Socket.user().id?i:o),new e(r,n,o)},e.byIMMessageDeletedEvent=function(t){var n=t.scene,r=t.deleterId;return n===el.Scene.PRIVATE?new e(n,e8.G.Socket.user().id===r?t.targetId:r):n===el.Scene.GROUP?new e(n,t.targetId):void 0},e.byConversationDTO=function(e){var t=e.lastMessage;return this.byIMMessage(t)},e.byConversationId=function(t,n){var r;if(t===el.Scene.PRIVATE){var i=n.split(":",2);r=i[0]===e8.G.Socket.user().id?i[1]:i[0]}else r=n;return new e(t,r)},e}();var sX={},sJ={};Object.defineProperty(sJ,"__esModule",{value:!0}),sJ.AbstractMessage=void 0,sJ.AbstractMessage=function(){function e(){}return e.prototype.clearUseLessAttribute=function(){delete this.buildOptions},e.prototype.isOtherSent=function(){return this.senderId!==e8.G.Socket.user().id},e}(),Object.defineProperty(sX,"__esModule",{value:!0}),sX.PrivateMessage=void 0,sX.PrivateMessage=function(e){function t(){var t=e.apply(this,es.__spreadArray([],es.__read(arguments),!1))||this;return t.read=!1,t}return es.__extends(t,e),t.prototype.scene=function(){return el.Scene.PRIVATE},t.prototype.targetId=function(){return this.receiverId},t}(sJ.AbstractMessage);var s$={};Object.defineProperty(s$,"__esModule",{value:!0}),s$.GroupMessage=void 0,s$.GroupMessage=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.scene=function(){return el.Scene.GROUP},t.prototype.targetId=function(){return this.groupId},t}(sJ.AbstractMessage);var sY={};Object.defineProperty(sY,"__esModule",{value:!0}),sY.CSMessage=void 0,sY.CSMessage=function(e){function t(){var t=e.apply(this,es.__spreadArray([],es.__read(arguments),!1))||this;return t.accepted=!1,t}return es.__extends(t,e),t.prototype.scene=function(){return el.Scene.CS},t.prototype.targetId=function(){return e8.G.Socket.user().id===this.customerId()?this.teamId:this.customerId()},t.prototype.sendByCustomer=function(){return this.to===this.teamId},t.prototype.customerId=function(){return this.sendByCustomer()?this.senderId:this.to},t.prototype.isOtherSent=function(){return e8.G.Socket.user().id===this.customerId()?this.senderId!==e8.G.Socket.user().id:this.senderId===this.customerId()},t}(sJ.AbstractMessage),Object.defineProperty(ts,"__esModule",{value:!0}),ts.validateChannel=ts.validateUnSubscribeGroupPresence=ts.validateSubscribePresence=ts.validateSubscribeOptions=ts.validatePublish=ts.validateGroupIds=ts.validateUserIds=ts.validateCSTransfer=ts.validateCSAccept=ts.validateHistoryQuery=ts.validateDeleteMessage=ts.validateRecallMessage=ts.validateMessage=ts.validateIdType=ts.validateGroupId=ts.validateUserId=ts.validateId=ts.validateCustomId=ts.validateConnectOptions=ts.validateGoEasyOptions=void 0;var sQ={maxString:function(e){return tE.pipe(tE.string(),tE.nonEmpty(),tE.maxLength(e))},nonEmptyString:tE.pipe(tE.string(),tE.nonEmpty()),object:tE.custom(function(e){return"object"===p(e)&&null!==e&&!Array.isArray(e)},"must be an object."),userId:tE.pipe(tE.string(),tE.nonEmpty(),tE.maxLength(60),tE.custom(function(e){if(e8.G.Socket.user().id===e)throw Error("id can not be the same as your id");return e})),sceneType:tE.pipe(tE.string(),tE.picklist([el.Scene.PRIVATE,el.Scene.GROUP,el.Scene.CS]))},sK={onSuccess:tE.optional(tE.function()),onFailed:tE.optional(tE.function())},sZ=tE.object({appkey:sQ.nonEmptyString,host:sQ.nonEmptyString,modules:tE.array(sQ.nonEmptyString),allowNotification:tE.optional(tE.boolean()),forceTLS:tE.optional(tE.boolean()),supportOldBrowser:tE.optional(tE.boolean()),reactNativeOptions:tE.optional(tE.object({platform:tE.any(),asyncStorage:tE.any()})),customProvider:tE.optional(tE.object({loadConversations:tE.function(),loadHistory:tE.function()}))}),s0=tE.pipe(tE.object(es.__assign({id:tE.optional(sQ.nonEmptyString),data:tE.optional(sQ.object),otp:tE.optional(sQ.nonEmptyString),wxmpId:tE.optional(tE.object({appid:sQ.nonEmptyString,openid:sQ.nonEmptyString})),onProgress:tE.optional(tE.function())},sK)),tE.forward(tE.partialCheck([["id"],["data"]],function(e){return!e8.GModules.modules.get("GIM")||e.id&&e.data},"id and data are required for IM module"),["data"])),s1=tE.object({id:sQ.userId,data:sQ.object}),s2=tE.pipe(tE.union([tE.object({type:sQ.sceneType,id:sQ.userId,data:sQ.object}),tE.object({type:sQ.sceneType,receivers:tE.array(s1)})]),tE.custom(function(e){if(!e.receivers)return!0;var t=e.receivers.map(function(e){return e.id});if(Array.from(new Set(t)).length<t.length)throw Error("receivers cannot have duplicate ids");if(e.type===el.Scene.PRIVATE&&e.receivers.length>200)throw Error("private message cannot have more than 200 receivers");if(e.type===el.Scene.GROUP&&e.receivers.length>3)throw Error("group message cannot have more than 3 receivers");return!0})),s3=tE.optional(tE.object({template_id:tE.string(),url:tE.optional(tE.string()),miniprogram:tE.optional(tE.object({appid:tE.string(),pagepath:tE.string()})),data:sQ.object})),s4=tE.optional(tE.object({title:sQ.maxString(32),body:sQ.maxString(50),sound:tE.optional(tE.string()),badge:tE.optional(tE.string()),vendorOptions:tE.optional(tE.object({huawei:tE.optional(tE.object({category:tE.string()})),xiaomi:tE.optional(tE.object({channel_id:tE.string()})),oppo:tE.optional(tE.object({channel_id:tE.string()})),vivo:tE.optional(tE.object({classification:tE.number(),category:tE.string()}))}))})),s6={image:["gif","jpg","png","jpeg"],video:["avi","mov","rmvb","rm","flv","mp4","3gp","quicktime"],audio:["mp3","ogg","wav","wma","ape","acc","mpeg"]},s5=function(e,t){return void 0===e&&(e=30),tE.pipe(tE.any(),tE.nonEmpty(),tE.custom(function(n){var r;if(n.size&&n.size>1024*e*1024)throw Error("File size must be <= ".concat(e,"MB."));if(t){var i=n.type||n.tempFile&&n.tempFile.type;if(!i)return!0;var s=null==(r=i.split("/")[1])?void 0:r.toLowerCase();if(s&&!s6[t].includes(s))throw Error("Only ".concat(s6[t].join(",")," is supported for ").concat(t,"."))}return!0}))};function s9(e){return tE.object(es.__assign(es.__assign(es.__assign({},e),{to:s2,notification:s4,wxmpTemplateMsg:s3,beforeSend:tE.optional(tE.function()),onProgress:tE.optional(tE.function())}),sK))}var s7=tE.variant("type",[s9({type:tE.literal(sH.MessageType.TEXT),text:sQ.maxString(2500)}),s9({type:tE.literal(sH.MessageType.IMAGE),file:s5(30,"image")}),s9({type:tE.literal(sH.MessageType.VIDEO),file:s5(30,"video")}),s9({type:tE.literal(sH.MessageType.AUDIO),file:s5(30,"audio")}),s9({type:tE.literal(sH.MessageType.FILE),file:s5(500)}),s9({type:tE.string(),payload:tE.union([sQ.maxString(2500),sQ.object])})]),s8=tE.object(es.__assign({messages:tE.pipe(tE.array(tE.instance(sX.PrivateMessage)),tE.nonEmpty(),tE.maxLength(20),tE.custom(function(e){for(var t=sW.Target.byIMMessage(e[0]),n=1;n<e.length;n++){var r=sW.Target.byIMMessage(e[n]);if(r.scene!==t.scene||r.id!==t.id)throw Error("each message must be from the same friend or group");var i=e[n];if(i.status!==el.MessageStatus.SUCCESS)throw Error("message[".concat(n,"] is '").concat(i.status,"' and cannot be recalled"));if(i.recalled)throw Error("message[".concat(n,"] has been recalled"));if(i.senderId!==e8.G.Socket.user().id)throw Error("it is not allowed to recall messages sent by others")}return!0}))},sK)),oe=tE.object(es.__assign({messages:tE.pipe(tE.array(tE.union([tE.instance(sX.PrivateMessage),tE.instance(s$.GroupMessage),tE.instance(sY.CSMessage)])),tE.nonEmpty(),tE.maxLength(20),tE.custom(function(e){for(var t=sW.Target.byIMMessage(e[0]),n=1;n<e.length;n++){var r=sW.Target.byIMMessage(e[n]);if(r.scene!==t.scene||r.id!==t.id)throw Error("each message must be from the same friend or group");var i=e[n];if(i.status===el.MessageStatus.SENDING)throw Error("message[".concat(n,"] is '").concat(i.status,"' and cannot be deleted"))}return!0}))},sK)),ot=function(e){return tE.pipe(tE.string(),tE.nonEmpty(),tE.custom(function(t){if(!t)throw Error("".concat(e," is required."));return t}))},on=ot("customId"),or=ot("id"),oi=tE.object({userId:sQ.nonEmptyString}),os=tE.object({groupId:sQ.nonEmptyString}),oo=tE.object({type:sQ.sceneType,id:sQ.nonEmptyString}),oa=tE.union([oi,os,oo]),ou=tE.object({customer:s1}),oc=tE.object({customerId:sQ.nonEmptyString,agentId:sQ.nonEmptyString}),ol=tE.pipe(tE.union([tE.string(),tE.number()]),tE.custom(function(e){if(!e&&0!==e)throw Error("param require string or number.");return!0})),op=function(e){return void 0===e&&(e=100),tE.pipe(tE.array(ol),tE.nonEmpty(),tE.maxLength(e),tE.custom(function(e){if(e.some(function(e){return 0===e.length}))throw Error("array has empty item.");if(Array.from(new Set(e)).length<e.length)throw Error("Duplicate element found in array");return!0}))},of=tE.object(es.__assign({channel:ol,message:sQ.maxString(2500),qos:tE.optional(tE.picklist([0,1])),notification:s4,wxmpTemplateMsg:s3,accessToken:tE.optional(tE.string())},sK)),od=tE.pipe(tE.object({channel:tE.optional(ol),channels:tE.optional(op(100)),presence:tE.optional(tE.object({enable:tE.boolean()})),accessToken:tE.optional(tE.string()),onMessage:tE.function()}),tE.forward(tE.partialCheck([["channel"],["channels"]],function(e){return!e.channel!=!e.channels},"Must provide either channel or channels, but not both or neither"),["channels"]),tE.forward(tE.partialCheck([["channel"],["presence"]],function(e){var t;return!(null==(t=e.presence)?void 0:t.enable)||!!e8.G.Socket.user().id},"Subscription failed. If presence is enable, the id must be specified when calling the connect method"),["presence"])),oh=tE.object({userIds:op(100)}),oy=tE.object({groupIds:op(100)}),ov=tE.object({channel:ol}),om=tE.object({channel:ol,membersLimit:tE.optional(tE.pipe(tE.number(),tE.maxValue(100))),onPresence:tE.function()}),og=tE.object({groupId:ol});function ob(e,t){var n;try{return tE.parse(e,t)}catch(e){if(e instanceof tE.ValiError){var r=e.issues[0],i=null==(n=r.path)?void 0:n.map(function(e){return e.key}).filter(Boolean),s=(null==i?void 0:i.join("."))||"value";throw{code:400,content:({string:"TypeError: ".concat(s," must be a string."),number:"TypeError: ".concat(s," must be a number."),non_empty:"".concat(s," cannot be empty."),max_length:"".concat(s," over max length."),picklist:"".concat(s," has invalid value.")})[r.type]||"".concat(s,": ").concat(r.message)}}throw e}}ts.validateGoEasyOptions=function(e){return ob(sZ,e)},ts.validateConnectOptions=function(e){return ob(s0,e)},ts.validateCustomId=function(e){return ob(on,e)},ts.validateId=function(e){return ob(or,e)},ts.validateUserId=function(e){return ob(oi,e)},ts.validateGroupId=function(e){return ob(os,e)},ts.validateIdType=function(e){return ob(oo,e)},ts.validateMessage=function(e){return ob(s7,e)},ts.validateRecallMessage=function(e){return ob(s8,e)},ts.validateDeleteMessage=function(e){return ob(oe,e)},ts.validateHistoryQuery=function(e){return ob(oa,e)},ts.validateCSAccept=function(e){return ob(ou,e)},ts.validateCSTransfer=function(e){return ob(oc,e)},ts.validateUserIds=function(e){return ob(oh,e)},ts.validateGroupIds=function(e){return ob(oy,e)},ts.validatePublish=function(e){return ob(of,e)},ts.validateSubscribeOptions=function(e){return ob(od,e)},ts.validateSubscribePresence=function(e){return ob(om,e)},ts.validateUnSubscribeGroupPresence=function(e){return ob(og,e)},ts.validateChannel=function(e){return ob(ov,e)},Object.defineProperty(tr,"__esModule",{value:!0}),tr.default=function(){function e(){}return e.prototype.publish=function(e){(0,ts.validatePublish)(e),e.channel=e.channel.toString();var t={channel:e.channel,content:e.message,nt:e.notification,at:e.accessToken,guid:e8.UUID.get(),q:e.qos};e.wxmpTemplateMsg&&(t.wxmpTemplateMsg=(0,ti.default)(e.wxmpTemplateMsg),t.wxmpTemplateMsg.data=JSON.stringify(t.wxmpTemplateMsg.data));var n=new e8.Rocket({name:ex.RocketTypes.publish,params:t,unique:!0,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,permission:e8.Permission.WRITE,success:function(t){eO.CallbackUtils.onSuccess(e,{code:200,content:"ok"})},fail:function(t){eO.CallbackUtils.onFailed(e,{code:t.resultCode,content:t.content})}});e8.G.Socket.e(n)},e}();var oE={},oS={};Object.defineProperty(oS,"__esModule",{value:!0}),oS.Subscription=void 0,oS.Subscription=function(e){if(this.options=e,this.channels=e.channels||[e.channel],!ev.default.isEmpty(e.channel)){var t=e.channel.toString();this.channels=[t]}ev.default.isEmpty(e.channels)||(this.channels=e.channels.toString().split(","))};var o_,ok,oC={};Object.defineProperty(oC,"__esModule",{value:!0}),oC.RemoteEvents=void 0,(oM=ok||(oC.RemoteEvents=ok={})).message="message",oM.imMessage="imMessage",oM.IM_MSG_SYNC="im:msg:sync",oM.IM_MSG_NEW="im:msg:new",oM.userPresence="userPresence",oM.groupPresence="groupPresence",oM.PS_PRESENCE_EVENT="PS_PRESENCE_EVENT",oM.IM_MSG_READ="IM_MSG_READ",oM.IM_MSG_DELETED="IM_MSG_DELETED",oM.IM_MSG_RECALLED="IM_MSG_RECALLED",oM.CS_ONLINE_CHANGED="CS_ONLINE_CHANGED";var oM,oD,ow={};Object.defineProperty(ow,"__esModule",{value:!0}),ow.SocketEvent=void 0,(oU=oD||(ow.SocketEvent=oD={})).CONNECTED="CONNECTED",oU.RECONNECTED="RECONNECTED",oU.DISCONNECTED="DISCONNECTED",oU.LOST="LOST",oU.EXPIRED_RECONNECTED="EXPIRED_RECONNECTED",oU.NEW_MESSAGE="NEW_MESSAGE",oU.CONNECTING="CONNECTING",Object.defineProperty(oE,"__esModule",{value:!0}),oE.Subscriber=void 0,oE.Subscriber=function(){function e(){this.subscriptions=[],e8.G.Socket.onMessage(oC.RemoteEvents.message,this.onNewMessage.bind(this)),e8.G.Socket.on(ow.SocketEvent.EXPIRED_RECONNECTED,this.expiredResubscribe.bind(this)),e8.G.Socket.on(ow.SocketEvent.RECONNECTED,this.resubscribePresenceChannel.bind(this))}return e.prototype.expiredResubscribe=function(){var e=this;this.subscriptions.forEach(function(t){e.doSubscribe(t,!1)})},e.prototype.resubscribePresenceChannel=function(){var e=this;this.subscriptions.forEach(function(t){var n=t.options;n.presence&&n.presence.enable&&e.doSubscribe(t,!0)})},e.prototype.onNewMessage=function(e){if(!(e.n.indexOf("_presence")>-1)){e.a&&e8.G.Socket.sendAck("ack",{i:e.i,c:e.n});var t={time:e.t,channel:e.n,content:e.c};this.createNotification(e),this.findSubscriptionByChannel(t.channel).options.onMessage(t)}},e.prototype.createNotification=function(e){var t=e8.G.N.supportAppNotification();if(ev.default.isObject(e.nt)&&t){var n={ch:e.n,ctt:e.c};e8.G.N.createLocalNotification(e.nt.t,e.nt.c,n,e.nt.sound,e.nt.badge)}},e.prototype.subscribe=function(e){var t=this;(0,ts.validateSubscribeOptions)(e);var n=new oS.Subscription(e);this.doSubscribe(n,!1).then(function(){t.subscriptions.push(n),eO.CallbackUtils.onSuccess(e,{code:200,content:"ok"})}).catch(function(t){eO.CallbackUtils.onFailed(e,{code:t.resultCode,content:t.content})})},e.prototype.doSubscribe=function(e,t){var n=e.options;return new Promise(function(r,i){var s=new e8.Rocket({name:ex.RocketTypes.subscribe,permission:e8.Permission.READ,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,params:{channels:e.channels,accessToken:n.accessToken,presence:n.presence,resubscribe:t},success:function(){r()},fail:function(e){i(e)}});e8.G.Socket.e(s)})},e.prototype.unsubscribe=function(e){var t=this;(0,ts.validateChannel)(e),e.channel=e.channel.toString();var n=this.findSubscriptionByChannel(e.channel);if(n){var r=new e8.Rocket({name:ex.RocketTypes.unsubscribe,params:{channel:e.channel,presence:n.options.presence},permission:e8.Permission.READ,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,success:function(){e.onSuccess({code:200,content:"ok"}),t.removeChannel(e.channel)},fail:function(t){e.onFailed({code:t.resultCode,content:t.content})}});e8.G.Socket.e(r)}else e.onFailed({code:400,content:"channel["+e.channel+"] is not subscribed"})},e.prototype.removeChannel=function(e){for(var t=this.subscriptions.length-1;t>=0;t--){var n=this.subscriptions[t].channels,r=n.indexOf(e);if(r>-1){n.splice(r,1),0===n.length&&this.subscriptions.splice(t,1);break}}},e.prototype.findSubscriptionByChannel=function(e){for(var t=!1,n=null,r=this.subscriptions.length-1;r>=0;r--){for(var i=this.subscriptions[r].channels,s=0;s<i.length;s++)if(i[s]==e){t=!0,n=this.subscriptions[r];break}if(t)break}return n},e}();var oI={};Object.defineProperty(oI,"__esModule",{value:!0}),oI.History=void 0,oI.History=function(){function e(){}return e.prototype.get=function(e){(0,ts.validateChannel)(e),e.channel=e.channel.toString();var t=new e8.Rocket({name:ex.RocketTypes.historyMessages,permission:e8.Permission.READ,params:e,singleTimeout:eA.SocketTimeout.commonQuerySingle,totalTimeout:eA.SocketTimeout.commonQueryTotal,success:function(t){eO.CallbackUtils.onSuccess(e,{code:t.resultCode||t.code||200,content:t.content})},fail:function(t){eO.CallbackUtils.onFailed(e,{code:t.resultCode||t.code,content:t.content})}});e8.G.Socket.e(t)},e}();var ox={};Object.defineProperty(ox,"__esModule",{value:!0}),ox.ChannelPresence=ox.PresenceService=void 0,ox.PresenceService=function(){function e(){var e=this;this.channelPresenceMap=new Map,this.onPresenceEvent=function(t){var n=e.channelPresenceMap.get(t.channel);null==n||n.onPresence(t)},this.expireAllChannelPresences=function(){e.channelPresenceMap.forEach(function(e,t){e.expire()})},this.resubscribe=function(){e.channelPresenceMap.forEach(function(e,t){e.subscribed()&&e.doSubscribe()})},e8.G.Socket.on(ow.SocketEvent.LOST,this.expireAllChannelPresences),e8.G.Socket.on(ow.SocketEvent.RECONNECTED,this.resubscribe),e8.G.Socket.onMessage(oC.RemoteEvents.PS_PRESENCE_EVENT,this.onPresenceEvent)}return e.prototype.hereNow=function(e){(0,ts.validateChannel)(e);var t,n=this.channelPresenceMap.get(e.channel.toString());n&&n.queryPromise?(e.limit&&e.limit>n.membersLimit&&n.doQuery(e.limit),t=n.queryPromise):t=oP(e.channel,e.limit),t.then(function(t){e.onSuccess(t)}).catch(function(t){e.onFailed(t)})},e.prototype.subscribe=function(e){(0,ts.validateSubscribePresence)(e);var t=e.channel.toString(),n=this.channelPresenceMap.get(t);n||(n=new oT(t),this.channelPresenceMap.set(t,n)),n.subscribe(e)},e.prototype.unsubscribe=function(e){var t=this;(0,ts.validateChannel)(e);var n=e.channel.toString();if(this.channelPresenceMap.get(n)){var r=new e8.Rocket({name:ex.RocketTypes.PUBSUB_PRESENCE_UNSUBSCRIBE,permission:e8.Permission.READ,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,params:{channel:n},success:function(r){t.channelPresenceMap.delete(n),e.onSuccess()},fail:function(t){e.onFailed(t)}});e8.G.Socket.e(r)}else e.onSuccess()},e}();var oT=function(){function e(e){this.membersLimit=10,this.queried=!1,this.channel=e}return e.prototype.onPresence=function(e){return es.__awaiter(this,void 0,void 0,function(){return es.__generator(this,function(t){switch(t.label){case 0:return this.queried?(this.update(e),[3,3]):[3,1];case 1:return[4,this.queryPromise];case 2:t.sent(),t.label=3;case 3:return this.on({channel:this.channel,action:e.action,member:e.member,time:e.time,amount:this.amount,members:this.membersByLimit()}),[2]}})})},e.prototype.membersByLimit=function(){return this.members.slice(0,this.membersLimit)},e.prototype.subscribe=function(e){return es.__awaiter(this,void 0,void 0,function(){var t;return es.__generator(this,function(n){switch(n.label){case 0:if(e.membersLimit&&(this.membersLimit=Math.min(e.membersLimit,300)),this.subscribed())return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.doSubscribe()];case 2:return n.sent(),[3,4];case 3:return t=n.sent(),e.onFailed(t),[2];case 4:return this.on=e.onPresence,e.onSuccess(),[2]}})})},e.prototype.doSubscribe=function(){var e=this;return this.doQuery(this.membersLimit),new Promise(function(t,n){var r=new e8.Rocket({name:ex.RocketTypes.PUBSUB_PRESENCE_SUBSCRIBE,permission:e8.Permission.READ,params:{channel:e.channel},singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,success:function(e){t()},fail:function(e){n(e)}});e8.G.Socket.e(r)})},e.prototype.doQuery=function(e){var t=this;this.queryPromise=oP(this.channel,e),this.queryPromise.then(function(e){t.members=e.content.members,t.amount=e.content.amount,t.queried=!0}).catch(function(e){throw e})},e.prototype.update=function(e){if(["join","back"].includes(e.action))this.members.unshift(e.member);else if(["leave","timeout"].includes(e.action)){var t=this.members.findIndex(function(t){return t.id===e.member.id});t>-1&&this.members.splice(t,1)}this.amount=e.amount},e.prototype.expire=function(){this.queried=!1,this.queryPromise=null},e.prototype.subscribed=function(){return void 0!==this.on},e}();function oP(e,t){return t||(t=10),new Promise(function(n,r){var i={channel:e,limit:t},s=new e8.Rocket({name:ex.RocketTypes.PUBSUB_PRESENCE_HERENOW,permission:e8.Permission.READ,params:i,singleTimeout:eA.SocketTimeout.commonQuerySingle,totalTimeout:eA.SocketTimeout.commonQueryTotal,success:function(e){n(e)},fail:function(e){r(e)}});e8.G.Socket.e(s)})}ox.ChannelPresence=oT,Object.defineProperty(tn,"__esModule",{value:!0}),tn.PubSub=void 0,tn.PubSub=function(){function e(){this.publisher=new tr.default,this.subscriber=new oE.Subscriber,this.presence2=new ox.PresenceService,this.histories=new oI.History}return e.init=function(){this.instance=new e},e.prototype.publish=function(e){this.publisher.publish(e)},e.prototype.subscribe=function(e){this.subscriber.subscribe(e)},e.prototype.unsubscribe=function(e){this.subscriber.unsubscribe(e)},e.prototype.subscribePresence=function(e){this.presence2.subscribe(e)},e.prototype.unsubscribePresence=function(e){this.presence2.unsubscribe(e)},e.prototype.history=function(e){this.histories.get(e)},e.prototype.hereNow=function(e){this.presence2.hereNow(e)},e}();var oA={};Object.defineProperty(oA,"__esModule",{value:!0}),oA.GWSModule=void 0,oA.GWSModule=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.init=function(){return this.module=new t,this.module.name=this.GWS_MODULE_NAME,this.initGN(),this.module},t.initGN=function(){ey.GN.addAssembler(new(function(){function e(){}return e.prototype.assemble=function(e){return{channel:e.ch,content:e.ctt}},e.prototype.support=function(e){return!!e.ch},e}()))},t.prototype.postConnect=function(){tn.PubSub.init()},t.check=function(){if(!this.module)throw{code:400,content:"PubSub not initialized. Please include 'PUBSUB' in the 'modules' during GoEasy initialization."}},t.GWS_MODULE_NAME="GWS",t}(e8.GModule),Object.defineProperty(te,"__esModule",{value:!0}),te.GWS=void 0,te.GWS=function(){function e(){}return e.publish=function(e){this.catch(function(){tn.PubSub.instance.publish(e)},e)},e.subscribe=function(e){this.catch(function(){tn.PubSub.instance.subscribe(e)},e)},e.unsubscribe=function(e){this.catch(function(){tn.PubSub.instance.unsubscribe(e)},e)},e.subscribePresence=function(e){this.catch(function(){tn.PubSub.instance.subscribePresence(e)},e)},e.unsubscribePresence=function(e){this.catch(function(){tn.PubSub.instance.unsubscribePresence(e)},e)},e.history=function(e){this.catch(function(){tn.PubSub.instance.history(e)},e)},e.hereNow=function(e){this.catch(function(){tn.PubSub.instance.hereNow(e)},e)},e.catch=function(e,t){try{if(oA.GWSModule.check(),[ec.NetworkStatus.DISCONNECTED,ec.NetworkStatus.DISCONNECTING,ec.NetworkStatus.CONNECT_FAILED].includes(e8.G.Socket.status()))throw Error("Please call connect() first.");e()}catch(e){eO.CallbackUtils.onFailed(t,e)}},e}();var oO={},oN={},oR={},oF={},oG={},oj={};Object.defineProperty(oj,"__esModule",{value:!0}),oj.default=function(){};var oU,oB,oL={};Object.defineProperty(oL,"__esModule",{value:!0}),oL.FileStorageLocation=void 0,(o4=oB||(oL.FileStorageLocation=oB={})).aliYun="ALI",o4.qiNiu="QN",o4.tencent="TX",o4.s3="S3",Object.defineProperty(oG,"__esModule",{value:!0}),oG.uniAppFileUploader=void 0,oG.uniAppFileUploader=new(function(e){function t(){return e.call(this)||this}return es.__extends(t,e),t.prototype.upload=function(e,t){var n=this;try{return e.storageLocation===oL.FileStorageLocation.s3?this.uploadToS3(e,t):(delete e.parameters.fileRes,new Promise(function(r,i){uni.uploadFile({url:e.host,filePath:n.getTempFilePath(e),name:"file",formData:e.parameters,success:function(e){200===e.statusCode?r():i({code:e.statusCode,content:e.errMsg})},fail:function(e){i({code:500,content:e.errMsg})}}).onProgressUpdate(function(e){t&&t(e)})}))}catch(e){return new Promise(function(t,n){n({code:500,content:e})})}},t.prototype.getTempFilePath=function(e){var t=e.file;return t.tempFilePath||t.fullPath||t.path},t.prototype.uploadToS3=function(e,t){var n=this;return new Promise(function(t,r){return es.__awaiter(n,void 0,void 0,function(){var n;return es.__generator(this,function(i){switch(i.label){case 0:return[4,this.fileToArrayBuffer(e)];case 1:return n=i.sent(),uni.request({url:e.url,method:"PUT",header:e.headers,data:n,success:function(n){200===n.statusCode?(e.storageLocation===oL.FileStorageLocation.s3&&(e.url=e.url.split("?")[0]),t()):r({code:n.statusCode,content:n.errMsg})},fail:function(e){r({code:500,content:e.errMsg})}}),[2]}})})})},t.prototype.fileToArrayBuffer=function(e){var t=this;return new Promise(function(n,r){var i=t.getTempFilePath(e);if("undefined"!=typeof plus)plus.io.resolveLocalFileSystemURL(i,function(e){e.file(function(e){var t=new plus.io.FileReader;t.onloadend=function(e){n(uni.base64ToArrayBuffer(e.target.result.split(",")[1]))},t.onerror=function(e){r(e)},t.readAsDataURL(e)})},function(e){r("Resolve file URL failed: "+e.message)});else if("undefined"!=typeof FileReader){var s=new FileReader;s.onload=function(){n(s.result)},s.onerror=function(e){r(e)},s.readAsArrayBuffer(e.file)}else if("object"===("undefined"==typeof wx?"undefined":p(wx))&&wx.canIUse("getFileSystemManager"))try{var o=wx.getFileSystemManager().readFileSync(i);n(o)}catch(e){r(e)}})},t}(oj.default));var oq={};Object.defineProperty(oq,"__esModule",{value:!0}),oq.wxFileUploader=void 0,oq.wxFileUploader=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.upload=function(e,t){var n=this;try{return e.storageLocation===oL.FileStorageLocation.s3?this.uploadToS3(e,t):new Promise(function(r,i){wx.uploadFile({url:e.host,filePath:n.getTempFilePath(e),name:"file",formData:e.parameters,success:function(e){200===e.statusCode?r():i({code:e.statusCode,content:e.errMsg})},fail:function(e){i({code:500,content:e.errMsg})}}).onProgressUpdate(function(e){t&&t(e)})})}catch(e){return new Promise(function(t,n){n({code:500,content:e})})}},t.prototype.getTempFilePath=function(e){var t=e.file||e.fileRes;return t.path||t.tempFilePath},t.prototype.uploadToS3=function(e,t){var n=this;return new Promise(function(t,r){return es.__awaiter(n,void 0,void 0,function(){var n;return es.__generator(this,function(i){switch(i.label){case 0:return[4,this.fileToArrayBuffer(this.getTempFilePath(e))];case 1:return n=i.sent(),wx.request({url:e.url,method:"PUT",header:e.headers,data:n,success:function(n){200===n.statusCode?(e.storageLocation===oL.FileStorageLocation.s3&&(e.url=e.url.split("?")[0]),t()):r({code:n.statusCode,content:n.errMsg})},fail:function(e){r({code:500,content:e.errMsg})}}),[2]}})})})},t.prototype.fileToArrayBuffer=function(e){return new Promise(function(t,n){try{t(wx.getFileSystemManager().readFileSync(e))}catch(e){n(e)}})},t}(oj.default));var oV={};Object.defineProperty(oV,"__esModule",{value:!0}),oV.htmlFileUploader=void 0,oV.htmlFileUploader=new(function(e){function t(){return e.call(this)||this}return es.__extends(t,e),t.prototype.upload=function(e,t){return new Promise(function(n,r){try{var i=new XMLHttpRequest,s=e.storageLocation===oL.FileStorageLocation.s3,o=s?"PUT":"POST",a=s?e.url:e.host;for(var u in i.open(o,a,!0),e.headers)i.setRequestHeader(u,e.headers[u]);i.upload.onprogress=function(e){t&&t(e)},i.upload.onloadstart=function(e){t&&t(e)},i.upload.onloadend=function(e){t&&t(e)};var c=new FormData;for(var l in e.parameters)"fileRes"==l?c.append("file",e.parameters[l]):c.append(l,e.parameters[l]);var p=s?e.file:c;i.send(p),i.onreadystatechange=function(){4==i.readyState&&(i.status>=200&&i.status<300||304==i.status?(s&&(e.url=e.url.split("?")[0]),n()):r({code:i.status,content:i.responseText}))}}catch(e){r({code:500,content:e})}})},t.prototype.fileToArrayBuffer=function(e){return new Promise(function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=function(e){n(e)},r.readAsArrayBuffer(e)})},t}(oj.default));var oz={};Object.defineProperty(oz,"__esModule",{value:!0}),oz.aliFileUploader=void 0,oz.aliFileUploader=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.upload=function(e,t){var n=this;try{return e.storageLocation===oL.FileStorageLocation.s3?this.uploadToS3(e,t):(delete e.parameters.fileRes,new Promise(function(r,i){my.uploadFile({url:e.host,filePath:n.getTempFilePath(e),fileType:"image",name:"file",formData:e.parameters,success:function(e){200===e.statusCode?r():i({code:e.statusCode,content:e.errMsg})},fail:function(e){i({code:500,content:e.errMsg})}}).onProgressUpdate(function(e){t&&t(e)})}))}catch(e){return new Promise(function(t,n){n({code:500,content:e})})}},t.prototype.getTempFilePath=function(e){var t=e.file;return t.path||t.tempFilePath},t.prototype.uploadToS3=function(e,t){var n=this;return new Promise(function(t,r){return es.__awaiter(n,void 0,void 0,function(){var n;return es.__generator(this,function(i){switch(i.label){case 0:return[4,this.fileToArrayBuffer(this.getTempFilePath(e))];case 1:return n=i.sent(),my.request({url:e.url,method:"PUT",header:e.headers,data:n,success:function(n){200===n.statusCode?(e.storageLocation===oL.FileStorageLocation.s3&&(e.url=e.url.split("?")[0]),t()):r({code:n.statusCode,content:n.errMsg})},fail:function(e){r({code:500,content:e.errMsg})}}),[2]}})})})},t.prototype.fileToArrayBuffer=function(e){return new Promise(function(t,n){my.getFileSystemManager().readFile({filePath:e,success:function(e){t(e.data)},fail:function(e){n(e)}})})},t}(oj.default));var oH={};Object.defineProperty(oH,"__esModule",{value:!0}),oH.baiduFileUploader=void 0,oH.baiduFileUploader=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.upload=function(e,t){var n=this;try{return e.storageLocation===oL.FileStorageLocation.s3?this.uploadToS3(e,t):(delete e.parameters.fileRes,new Promise(function(r,i){swan.uploadFile({url:e.host,filePath:n.getTempFilePath(e),name:"file",formData:e.parameters,success:function(e){200===e.statusCode?r():i({code:e.statusCode,content:e.errMsg})},fail:function(e){i({code:500,content:e.errMsg})}}).onProgressUpdate(function(e){t&&t(e)})}))}catch(e){return new Promise(function(t,n){n({code:500,content:e})})}},t.prototype.getTempFilePath=function(e){var t=e.file;return t.path||t.tempFilePath},t.prototype.uploadToS3=function(e,t){var n=this;return new Promise(function(t,r){return es.__awaiter(n,void 0,void 0,function(){var n;return es.__generator(this,function(i){switch(i.label){case 0:return[4,this.fileToArrayBuffer(this.getTempFilePath(e))];case 1:return n=i.sent(),swan.request({url:e.url,method:"PUT",header:e.headers,data:n,success:function(n){200===n.statusCode?(e.storageLocation===oL.FileStorageLocation.s3&&(e.url=e.url.split("?")[0]),t()):r({code:n.statusCode,content:n.errMsg})},fail:function(e){r({code:500,content:e.errMsg})}}),[2]}})})})},t.prototype.fileToArrayBuffer=function(e){return new Promise(function(t,n){swan.getFileSystemManager().readFile({filePath:e,success:function(e){t(e.data)},fail:function(e){n(e)}})})},t}(oj.default));var oW={};Object.defineProperty(oW,"__esModule",{value:!0}),oW.FileUploadResponse=void 0,oW.FileUploadResponse=function(e,t,n){this.storageLocation=e,this.url=t,this.name=n},Object.defineProperty(oF,"__esModule",{value:!0}),oF.fileUploader=oF.FileUploader=void 0;var oX=function(){function e(){var e;this.uploader=((e={})[w.Framework.UNIAPP]=oG.uniAppFileUploader,e[em.PlatformType.MP_WX]=oq.wxFileUploader,e[em.PlatformType.BROWSER]=oV.htmlFileUploader,e[em.PlatformType.MP_ALI]=oz.aliFileUploader,e[em.PlatformType.MP_BAIDU]=oH.baiduFileUploader,e[w.Framework.REACT_NATIVE]=oV.htmlFileUploader,e[em.PlatformType.MP_BYTE]=oq.wxFileUploader,e)}return e.prototype.upload=function(e,t){return es.__awaiter(this,void 0,void 0,function(){var n,r,i;return es.__generator(this,function(s){switch(s.label){case 0:return n=w.FrameworkDetector.currentFramework(),r=em.PlatformDetector.currentPlatform(),i=n===w.Framework.UNKNOWN?r:n,[4,this.uploader[i].upload(e,t)];case 1:return s.sent(),[2,new oW.FileUploadResponse(e.storageLocation,e.url,e.newFileName)]}})})},e}();oF.FileUploader=oX,oF.fileUploader=new oX;var oJ={},o$={};Object.defineProperty(o$,"__esModule",{value:!0}),o$.default=function(){function e(){}return e.prototype.resolve=function(e){return new Promise(function(t,n){var r=new e8.Rocket({name:"uploadToken",params:{filename:e},permission:e8.Permission.WRITE,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,fail:function(e){n(e.content)},success:function(e){200===e.code?t(e.content):n(e.content)}});e8.G.Socket.e(r)})},e}();var oY={},oQ={};Object.defineProperty(oQ,"__esModule",{value:!0}),oQ.default=function(e,t,n,r,i,s,o){this.storageLocation=e,this.host=t,this.headers=n,this.parameters=r,this.file=i,this.newFileName=s,this.url=o};var oK={};Object.defineProperty(oK,"__esModule",{value:!0}),oK.default=function(){function e(){}return e.prototype.newFileName=function(e){return e&&e.newFilename||""},e}(),Object.defineProperty(oY,"__esModule",{value:!0}),oY.aliYunOSSRequestBuilder=oY.AliYunOSSRequestBuilder=void 0;var oZ=function(e){function t(){return e.call(this)||this}return es.__extends(t,e),t.prototype.url=function(e){return e.host+"/"+e.dir+"/"+this.newFileName(e)},t.prototype.build=function(e,t,n){var r,i=this.newFileName(e);return r={key:e.dir+"/"+i,OSSAccessKeyId:e.accessKeyId,policy:e.policy,signature:e.signature,success_action_status:"200",fileRes:t},n&&(r={key:e.dir+"/"+i,OSSAccessKeyId:e.accessKeyId,policy:e.policy,signature:e.signature,success_action_status:"200","Content-Disposition":"attachment;filename="+t.name,fileRes:t}),new oQ.default(oL.FileStorageLocation.aliYun,e.host,null,r,t,i,this.url(e))},t}(oK.default);oY.AliYunOSSRequestBuilder=oZ,oY.aliYunOSSRequestBuilder=new oZ;var o0={};Object.defineProperty(o0,"__esModule",{value:!0}),o0.tencentOSSRequestBuilder=o0.TencentOSSRequestBuilder=void 0;var o1=function(e){function t(){return e.call(this)||this}return es.__extends(t,e),t.prototype.url=function(e){return e.host+"/"+e.key},t.prototype.build=function(e,t,n){var r={"q-sign-algorithm":e.qSignAlgorithm,"q-ak":e.qAk,"q-key-time":e.qKeyTime,"q-signature":e.qSignature,policy:e.policy,"x-cos-security-token":e.xCosSecurityToken,success_action_status:"200",key:e.key,fileRes:t};return n&&(r={"q-sign-algorithm":e.qSignAlgorithm,"q-ak":e.qAk,"q-key-time":e.qKeyTime,"q-signature":e.qSignature,policy:e.policy,"x-cos-security-token":e.xCosSecurityToken,success_action_status:"200",key:e.key,"Content-Disposition":"attachment;filename=".concat(t.name),fileRes:t}),new oQ.default(oL.FileStorageLocation.tencent,e.host,null,r,t,e.key,this.url(e))},t}(oK.default);o0.TencentOSSRequestBuilder=o1,o0.tencentOSSRequestBuilder=new o1;var o2={};Object.defineProperty(o2,"__esModule",{value:!0}),o2.s3OSSRequestBuilder=o2.S3OSSRequestBuilder=void 0;var o3=function(e){function t(){return e.call(this)||this}return es.__extends(t,e),t.prototype.url=function(e){return e.uploadUrl},t.prototype.build=function(e,t,n){return new oQ.default(oL.FileStorageLocation.s3,null,{"Content-Type":"application/octet-stream"},{file:t},t,t.name,this.url(e))},t}(oK.default);o2.S3OSSRequestBuilder=o3,o2.s3OSSRequestBuilder=new o3,Object.defineProperty(oJ,"__esModule",{value:!0}),oJ.default=function(){function e(){this.uploadTokenResolver=new o$.default}return e.prototype.builder=function(e){if(e===oL.FileStorageLocation.aliYun)return oY.aliYunOSSRequestBuilder;if(e===oL.FileStorageLocation.tencent)return o0.tencentOSSRequestBuilder;if(e===oL.FileStorageLocation.s3)return o2.s3OSSRequestBuilder;throw Error("Only Ali OSS and Tencent COS are supported, unknown storage location:"+e)},e.prototype.build=function(e,t,n){return es.__awaiter(this,void 0,void 0,function(){var r;return es.__generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.uploadTokenResolver.resolve(t)];case 1:return r=i.sent(),[2,Promise.resolve(this.builder(r.vendor).build(r,e,n))];case 2:return[2,Promise.reject(i.sent())];case 3:return[2]}})})},e}(),Object.defineProperty(oR,"__esModule",{value:!0}),oR.GoEasyUploader=void 0,oR.GoEasyUploader=function(){function e(){this.requestBuilder=new oJ.default,this.fileUploader=oF.fileUploader}return e.prototype.upload=function(e,t,n,r){return es.__awaiter(this,void 0,void 0,function(){var i;return es.__generator(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.requestBuilder.build(e,t,r)];case 1:return i=s.sent(),[2,this.fileUploader.upload(i,n)];case 2:return[2,Promise.reject(s.sent())];case 3:return[2]}})})},e}();var o4,o6,o5={},o9={};Object.defineProperty(o9,"__esModule",{value:!0}),o9.IM_INTERNAL_EVENTS=void 0,(am=o6||(o9.IM_INTERNAL_EVENTS=o6={})).MESSAGE_SENDING="IM_INTERNAL_MESSAGE_SENDING",am.MESSAGE_SEND_SUCCESS="IM_INTERNAL_MESSAGE_SEND_SUCCESS",am.MESSAGE_SEND_FAILED="IM_INTERNAL_MESSAGE_SEND_FAILED",am.MESSAGE_RECEIVED="IM_INTERNAL_MESSAGE_RECEIVED",am.MESSAGE_RECALLED="IM_INTERNAL_MESSAGE_RECALLED",am.MAX_MESSAGE_CHANGED="IM_INTERNAL_MAX_MESSAGE_CHANGED",am.MAX_MESSAGE_DELETED="IM_INTERNAL_MAX_MESSAGE_DELETED",am.UNREAD_AMOUNT_CHANGED="IM_INTERNAL_UNREAD_MESSAGE_CHANGED",am.CS_ONLINE_SUCCESS="CS_ONLINE_SUCCESS",am.CS_OFFLINE_SUCCESS="CS_OFFLINE_SUCCESS",am.CS_ACCEPTED="CS_ACCEPTED",am.CS_ENDED="CS_ENDED",am.CS_TRANSFER="CS_TRANSFER",am.CS_AGENT_MESSAGE_RECEIVED="CS_AGENT_MESSAGE_RECEIVED";var o7={},o8={},ae={};Object.defineProperty(ae,"__esModule",{value:!0}),ae.AbstractPayloadImprover=void 0,ae.AbstractPayloadImprover=function(){},Object.defineProperty(o8,"__esModule",{value:!0}),o8.FileMessagePayloadImprover=void 0,o8.FileMessagePayloadImprover=function(e){function t(){var t=e.apply(this,es.__spreadArray([],es.__read(arguments),!1))||this;return t.goEasyUploader=new oR.GoEasyUploader,t}return es.__extends(t,e),t.prototype.improve=function(e){var t=this,n=e.message;return new Promise(function(e,r){var i,s=n.buildOptions.createOptions;i=n.type===sH.MessageType.VIDEO?n.payload.video.name:n.payload.name,t.goEasyUploader.upload(s.file,i,s.onProgress,n.type===sH.MessageType.FILE).then(function(r){r.storageLocation!==oL.FileStorageLocation.s3&&(r.url=encodeURI(r.url)),t.setPayload(r,n),e()}).catch(function(e){r(e)})})},t.prototype.setPayload=function(e,t){t.payload.url=e.url},t}(ae.AbstractPayloadImprover);var at={};Object.defineProperty(at,"__esModule",{value:!0}),at.VideoMessagePayloadImprover=void 0,at.VideoMessagePayloadImprover=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.setPayload=function(e,t){var n,r=t.payload;switch(r.video.url=e.url,r.video.name=e.name,r.thumbnail.height>200&&(r.thumbnail.height=200,r.thumbnail.width=200*r.video.width/r.video.height),e.storageLocation){case oL.FileStorageLocation.aliYun:n="?x-oss-process=video/snapshot,t_0000,f_jpg,h_"+r.thumbnail.height+",m_fast,ar_auto";break;case oL.FileStorageLocation.tencent:n="?ci-process=snapshot&time=1&format=jpg&height="+r.thumbnail.height;break;case oL.FileStorageLocation.s3:n="?process=video&height="+r.thumbnail.height;break;default:throw Error("Only Ali OSS and Tencent COS are supported, unknown storage location:"+e.storageLocation)}r.thumbnail.url=e.url+n},t}(o8.FileMessagePayloadImprover);var an={};Object.defineProperty(an,"__esModule",{value:!0}),an.ImageMessagePayloadImprover=void 0,an.ImageMessagePayloadImprover=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.setPayload=function(e,t){var n,r=t.payload;r.url=e.url;var i=r.height>200?200:r.height;switch(e.storageLocation){case oL.FileStorageLocation.aliYun:n="?x-oss-process=image/resize,m_lfit,h_"+i;break;case oL.FileStorageLocation.tencent:n="?imageMogr2/thumbnail/x".concat(i);break;case oL.FileStorageLocation.s3:n="?process=image&height=".concat(i);break;default:throw Error("Only Ali OSS and Tencent COS are supported, unknown storage location:"+e.storageLocation)}r.thumbnail=e.url+n},t}(o8.FileMessagePayloadImprover),Object.defineProperty(o7,"__esModule",{value:!0}),o7.PayloadImprover=void 0,o7.PayloadImprover=function(){function e(){var e;this.improvers=((e={})[sH.MessageType.FILE]=new o8.FileMessagePayloadImprover,e[sH.MessageType.AUDIO]=new o8.FileMessagePayloadImprover,e[sH.MessageType.IMAGE]=new an.ImageMessagePayloadImprover,e[sH.MessageType.VIDEO]=new at.VideoMessagePayloadImprover,e)}return e.prototype.improve=function(e){var t=this.improvers[e.message.type];if(t)try{return t.improve(e)}catch(e){return Promise.reject(e)}return Promise.resolve()},e}();var ar={};Object.defineProperty(ar,"__esModule",{value:!0}),ar.IMEC=void 0,ar.IMEC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.init=function(){this.i=new t},t}(e8.AbstractEventCenter);var ai={};Object.defineProperty(ai,"__esModule",{value:!0}),ai.default=function(){function e(e,t,n,r,i){this.validate(e),this.mt=e.type,"receivers"in t?this.receivers=t.receivers:(this.to=t.id,this.d=JSON.stringify(t.data)),this.p=JSON.stringify(e.payload),n&&(this.nt=n),i&&(this.at=i),r&&(this.wxmpTemplateMsg=(0,ti.default)(r),this.wxmpTemplateMsg.data=JSON.stringify(this.wxmpTemplateMsg.data));var s=t.type;this.t=s,s===el.Scene.CS&&(this.tid=e.teamId),this.guid=e.messageId}return e.prototype.validate=function(e){if(e.type===sH.MessageType.TEXT&&JSON.stringify(e.payload).length>3072)throw Error("message-length limit 3kb")},e}(),Object.defineProperty(o5,"__esModule",{value:!0}),o5.default=function(){function e(){this.payloadImprover=new o7.PayloadImprover}return e.prototype.send=function(e){var t=this;this.validate(e);var n=e.message,r=e.accessToken,i=n.buildOptions,s=i.createOptions,o=s.notification,a=s.wxmpTemplateMsg,u=s.to;n.status=el.MessageStatus.SENDING,Promise.all([i.complete,this.payloadImprover.improve(e)]).then(function(){return es.__awaiter(t,void 0,void 0,function(){var t,i,c;return es.__generator(this,function(l){switch(l.label){case 0:return s.beforeSend?(t=JSON.parse(JSON.stringify(n)),[4,s.beforeSend(t)]):[3,2];case 1:l.sent(),l.label=2;case 2:return"receivers"in s.to?(i=[],u.receivers.forEach(function(e){var t=Object.assign(Object.create(Object.getPrototypeOf(n)),n);u.type===el.Scene.PRIVATE?t.receiverId=e.id:u.type===el.Scene.GROUP&&(t.groupId=e.id),i.push(t);var r={message:t,receiver:e.data};ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.MESSAGE_SENDING,r)}),this.doSend(u,o,a,r,e,i,n)):(c={message:n,receiver:u.data},ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.MESSAGE_SENDING,c),this.doSend(u,o,a,r,e,[n])),[2]}})})}).catch(function(t){n.status=el.MessageStatus.FAIL,eO.CallbackUtils.onFailed(e,{code:t&&t.code||400,content:t&&t.content||t})})},e.prototype.doSend=function(e,t,n,r,i,s,o){var a=new ai.default(s[0],e,t,n,r),u=new e8.Rocket({name:ex.RocketTypes.publishIM,params:a,unique:!0,permission:e8.Permission.WRITE,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,fail:function(e){s.forEach(function(e){e.status=el.MessageStatus.FAIL,ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.MESSAGE_SEND_FAILED,e)}),o&&(o.status=el.MessageStatus.FAIL),eO.CallbackUtils.onFailed(i,{code:e.resultCode,content:e.content})},success:function(e){s.forEach(function(t){t.status=el.MessageStatus.SUCCESS,t.timestamp=e.content.timestamp,t.messageId=JSON.stringify(e.content.id),t.scene()===el.Scene.CS&&t.customerId()!==e8.G.Socket.user().id&&(t.sessionId=e.content.sessionId),t.clearUseLessAttribute(),ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.MESSAGE_SEND_SUCCESS,t)}),o&&(o.status=el.MessageStatus.SUCCESS,o.clearUseLessAttribute()),eO.CallbackUtils.onSuccess(i)}});e8.G.Socket.e(u)},e.prototype.validate=function(e){var t=e.message;if(!(t instanceof sJ.AbstractMessage))throw Error("it is invalid message");if(t.status!==el.MessageStatus.NEW)throw Error("Please create a new message, a message can only be sent once")},e}();var as={},ao={},aa={},au={},ac={},al={},ap={};Object.defineProperty(ap,"__esModule",{value:!0}),ap.SortedInserter=void 0,ap.SortedInserter=function(){function e(){}return e.prototype.insert=function(e,t){var n=this.binarySearch(e,t);n>=0?e.splice(n,1,t):e.splice(-n-1,0,t)},e.prototype.binarySearch=function(e,t){for(var n=0,r=e.length-1;n<=r;){var i=r+n>>1,s=this.compare(t,e[i]);if(s>0)n=i+1;else{if(!(s<0))return i;r=i-1}}return-n-1},e}(),Object.defineProperty(al,"__esModule",{value:!0}),al.default=function(){function e(e){this.messages=[],this.allLoaded=!1,this.target=e}return e.prototype.all=function(){return this.messages},e.prototype.sliceOverLengthMessages=function(){this.messages.length>e.CACHE_MAX_LENGTH&&(this.messages=this.messages.slice(-e.CACHE_MAX_LENGTH),!0===this.allLoaded&&(this.allLoaded=!1))},e.prototype.getMaxMessage=function(){return this.messages[this.messages.length-1]},e.prototype.loadLocalMessages=function(e,t){var n=[],r=this.messages.length;if(t){if(r>0){var i=this.messages[0].timestamp,s=this.messages[r-1].timestamp;if(t>=i&&t<=s)for(var o=r-1;o>=0;o--){var a=this.messages[o];if(a.timestamp<t){if(!(n.length<e))break;n.unshift(a)}}}}else n=this.messages.slice(-e);return n},e.prototype.cacheServerMessages=function(t,n){var r=this,i=this.messages[0];this.messages.length<e.CACHE_MAX_LENGTH&&(!t.lastTimestamp||this.messages.length>0&&i.timestamp===t.lastTimestamp)&&(n.forEach(function(t){e.sortedInserter.insert(r.messages,t)}),n.length<t.limit&&(this.allLoaded=!0))},e.prototype.findMessageByTime=function(e){return this.messages.find(function(t){return e===t.timestamp})},e.prototype.findMessagesByTimes=function(e){var t=this,n=[];return e.forEach(function(e){var r=t.findMessageByTime(e);ev.default.isDef(r)&&n.push(r)}),n},e.prototype.existsMessage=function(e){return this.findMessageIndexById(e)>-1},e.prototype.findMessageIndexById=function(e){return this.messages.findIndex(function(t){return e===t.messageId})},e.prototype.deleteMessage=function(e){var t=this.findMessageIndexById(e);t>=0&&this.messages.splice(t,1)},e.prototype.recallMessage=function(e){var t=this;return e.times.map(function(e){return t.findMessageByTime(e)}).filter(function(e){return ev.default.isDef(e)}).map(function(t){return t.recalled=!0,t.recaller=e.recaller,t})},e.prototype.isEmpty=function(){return 0===this.messages.length},e.prototype.deleteMessages=function(e){var t=this;e.forEach(function(e){t.deleteMessage(e.messageId)})},e.prototype.saveMessage=function(t){e.sortedInserter.insert(this.messages,t),this.deleteGroupConversationMessage(),this.sliceOverLengthMessages()},e.prototype.deleteGroupConversationMessage=function(){this.target.scene===el.Scene.GROUP&&this.messages.length>=2&&1===this.messages[0].x&&this.messages.shift()},e.prototype.maxSuccessMessageTime=function(){for(var e=this.messages.length-1;e>=0;e--)if(this.messages[e].status===el.MessageStatus.SUCCESS)return this.messages[e].timestamp;return 0},e.prototype.minTime=function(){return this.isEmpty()?0:this.messages[0].timestamp},e.prototype.correctPosition=function(e){this.deleteMessage(e.messageId),this.saveMessage(e)},e.CACHE_MAX_LENGTH=200,e.sortedInserter=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.compare=function(e,t){var n=e.timestamp-t.timestamp;return n>0?1:0===n?0:-1},t}(ap.SortedInserter)),e}();var af={},ad={};Object.defineProperty(ad,"__esModule",{value:!0}),ad.DeleteMessageRequest=void 0,ad.DeleteMessageRequest=function(e){var t=this;this.times=[];var n=e[0],r=sW.Target.byIMMessage(n);this.scene=r.scene,this.targetId=r.id,e.forEach(function(e){e.status===el.MessageStatus.SUCCESS&&t.times.push(e.timestamp)}),this.times.sort(function(e,t){return e<t?-1:+(e!=t)})},Object.defineProperty(af,"__esModule",{value:!0}),af.default=function(){function e(){}return e.deleteServerMessages=function(e){var t=new ad.DeleteMessageRequest(e);return t.times.length<0?Promise.resolve():new Promise(function(e,n){var r=new e8.Rocket({name:ex.RocketTypes.IM_DELETE_MESSAGE,params:t,permission:e8.Permission.WRITE,singleTimeout:eA.SocketTimeout.commonQuerySingle,totalTimeout:eA.SocketTimeout.commonQueryTotal,success:function(t){200===t.code?e(t):n(t)},fail:function(e){n(e)}});e8.G.Socket.e(r)})},e}();var ah={},ay={};Object.defineProperty(ay,"__esModule",{value:!0}),ay.default=function(e,t,n,r,i){this.scene=e,this.id=t,this.after=n,this.min=r,this.teamId=i};var av={};Object.defineProperty(av,"__esModule",{value:!0}),av.ReadMessageMarkRequest=void 0,av.ReadMessageMarkRequest=function(e,t,n,r){this.id=e,this.scene=t,this.lastTimestamp=n,this.teamId=r};var am,ag,ab={},aE={};Object.defineProperty(aE,"__esModule",{value:!0}),aE.CSMessageType=void 0,(aD=ag||(aE.CSMessageType=ag={})).ACCEPT="CS_ACCEPT",aD.END="CS_END",aD.TRANSFER="CS_TRANSFER",Object.defineProperty(ab,"__esModule",{value:!0}),ab.RemoteAbbrMessageBuilder=void 0,ab.RemoteAbbrMessageBuilder=function(){function e(){}return e.prototype.build=function(e){var t,n=e.t;n===el.Scene.PRIVATE?((t=new sX.PrivateMessage).read=!1,e.r?t.receiverId=e.r:t.receiverId=e8.G.Socket.user().id):n===el.Scene.GROUP?((t=new s$.GroupMessage).groupId=e.r,t.senderData=e.d?JSON.parse(e.d):{}):n===el.Scene.CS&&((t=new sY.CSMessage).to=e.r,t.teamId=e.tid,t.senderData=e.d?JSON.parse(e.d):{},t.accepted=e.accepted,t.customerId()!==e8.G.Socket.user().id&&(t.sessionId=e.sessionId)),t.senderId=e.s,t.messageId=e.i,t.timestamp=e.ts,t.type=e.mt;var r=e.p;if(ev.default.isDef(r))if(n===el.Scene.CS&&t.type===aE.CSMessageType.TRANSFER){var i=JSON.parse(r);i.transferTo.data=JSON.parse(i.transferTo.data),t.payload=i}else t.payload=JSON.parse(r);var s=e.rc;return ev.default.isDef(s)&&!0===s?(t.recalled=s,t.recaller=e.recaller):t.recalled=!1,t.status=el.MessageStatus.SUCCESS,t},e}(),Object.defineProperty(ah,"__esModule",{value:!0}),ah.RemoteHistory=void 0,ah.RemoteHistory=function(){function e(){this.builder=new ab.RemoteAbbrMessageBuilder}return e.prototype.sync=function(e,t,n,r,i){var s=new ay.default(e,t,n,r,i);return new Promise(function(e,t){var n=new e8.Rocket({name:ex.RocketTypes.IM_HISTORY_CHANGE,params:s,permission:e8.Permission.READ,singleTimeout:eA.SocketTimeout.commonQuerySingle,totalTimeout:eA.SocketTimeout.commonQueryTotal,fail:function(e){t(e)},success:function(t){e(t.content)}});e8.G.Socket.e(n)})},e.prototype.loadServerMessages=function(e,t){var n=this;return new Promise(function(r,i){var s=new e8.Rocket({name:ex.RocketTypes.IM_HISTORY,params:t,permission:e8.Permission.READ,singleTimeout:eA.SocketTimeout.commonQuerySingle,totalTimeout:eA.SocketTimeout.commonQueryTotal,fail:function(e){r({messages:[],userOffsets:[]})},success:function(t){var i=t.content;i.messages=n.convertServerMessages(e,i.messages),r(i)}});e8.G.Socket.e(s)})},e.prototype.convertServerMessages=function(e,t){var n=this,r=[],i=e.scene,s=e.id;return t.forEach(function(t){if(t.t=i,el.Scene.PRIVATE===i)t.r=t.s===e8.G.Socket.user().id?s:e8.G.Socket.user().id;else if(el.Scene.GROUP===i)t.r=s;else if(el.Scene.CS===i){var o=e.customerId(),a=e.teamId;o===e8.G.Socket.user().id?t.r=a:t.r=o}var u=n.builder.build(t);r.push(u)}),r},e.prototype.updateServerOffsets=function(e,t){return es.__awaiter(this,void 0,void 0,function(){var n;return es.__generator(this,function(r){return n=new av.ReadMessageMarkRequest(t.id,t.scene,e,t.teamId),[2,new Promise(function(e,t){var r=new e8.Rocket({name:ex.RocketTypes.IM_MARK_AS_READ,params:n,permission:e8.Permission.WRITE,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,success:function(t){e(t)},fail:function(e){t(e)}});e8.G.Socket.e(r)})]})})},e.instance=new e,e}();var aS={};Object.defineProperty(aS,"__esModule",{value:!0}),aS.UserOffsets=void 0,aS.UserOffsets=function(){function e(){this.offsetMap=new Map,this.markingTime=0,this.userId=e8.G.Socket.user().id}return e.prototype.updateOffset=function(e,t){var n=this.offsetMap.get(e);return ev.default.isDef(n)?t>n&&(this.offsetMap.set(e,t),!0):(this.offsetMap.set(e,t),!0)},e.prototype.updateUserOffsets=function(e){var t=this;e.forEach(function(e){var n=e.userId,r=e.offset;t.updateOffset(n,r)})},e.prototype.updateMyOffset=function(e){return this.updateOffset(this.userId,e)},e.prototype.myOffset=function(){return this.getOffset(this.userId)},e.prototype.getOffset=function(e){return this.offsetMap.get(e)||0},e}();var a_={};Object.defineProperty(a_,"__esModule",{value:!0}),a_.default=function(e,t,n,r,i){this.id=e,this.scene=t,this.lastTimestamp=n,this.limit=r,this.teamId=i};var ak={};Object.defineProperty(ak,"__esModule",{value:!0}),ak.UnreadAmountMaxMessageChangeDetector=void 0,ak.UnreadAmountMaxMessageChangeDetector=function(){function e(e){this.history=e}return e.prototype.pre=function(){this.oldLastMessage=this.history.getMaxMessage(),this.oldUnreadAmount=this.history.unreadAmount(),this.oldLastMessage&&(this.oldLastMessageRecalled=this.oldLastMessage.recalled,this.oldLastMessageRead=this.oldLastMessage.read,this.oldLastMessageStatus=this.oldLastMessage.status)},e.prototype.post=function(){var e,t,n,r=this.history.unreadAmount(),i=this.history.getMaxMessage();i&&(n=i.status,e=i.read,t=i.recalled);var s=this.history.target;if(this.oldLastMessage!==i||this.oldLastMessageRead!==e||this.oldLastMessageRecalled!==t||this.oldLastMessageStatus!==n)if(i){var o={message:i,receiver:this.history.to};ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.MAX_MESSAGE_CHANGED,o)}else ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.MAX_MESSAGE_DELETED,s);else this.oldUnreadAmount!==r&&ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.UNREAD_AMOUNT_CHANGED,s)},e}();var aC={};Object.defineProperty(aC,"__esModule",{value:!0}),aC.ServerRecalledEvent=void 0,aC.ServerRecalledEvent=function(e,t,n,r){this.scene=e,this.conversationId=t,this.recaller=n,this.times=r};var aM={};Object.defineProperty(aM,"__esModule",{value:!0}),aM.AEC=void 0,aM.AEC=function(){function e(){}return e.init=function(){this.eventCenter=new e8.ApiEventCenter},e.on=function(e,t){this.eventCenter.on(e,t)},e.fire=function(e,t){this.eventCenter.fire(e,t)},e.off=function(e,t){this.eventCenter.off(e,t)},e}();var aD,aw,aI={};Object.defineProperty(aI,"__esModule",{value:!0}),aI.ImApiEvents=void 0,(ue=aw||(aI.ImApiEvents=aw={})).PRIVATE_MESSAGE_RECEIVED="PRIVATE_MESSAGE_RECEIVED",ue.GROUP_MESSAGE_RECEIVED="GROUP_MESSAGE_RECEIVED",ue.SYSTEM_MESSAGE_RECEIVED="SYSTEM_MESSAGE_RECEIVED",ue.CONVERSATIONS_UPDATED="CONVERSATIONS_UPDATED",ue.HISTORY_EXPIRED="HISTORY_EXPIRED",ue.USER_PRESENCE="USER_PRESENCE",ue.GROUP_PRESENCE="GROUP_PRESENCE",ue.MESSAGE_DELETED="MESSAGE_DELETED",ue.MESSAGE_READ="MESSAGE_READ",ue.MESSAGE_RECALLED="MESSAGE_RECALLED",ue.CS_MESSAGE_RECEIVED="CS_MESSAGE_RECEIVED",ue.PENDING_CONVERSATIONS_UPDATED="PENDING_CONVERSATIONS_UPDATED";var ax={};Object.defineProperty(ax,"__esModule",{value:!0}),ax.WebhookMessage=ax.WebhookConversation=ax.IMCustomProvider=void 0,ax.IMCustomProvider=function(){function e(){}return e.init=function(t){e.instance=t},e.loadCustomMessages=function(e,t,n){return es.__awaiter(this,void 0,void 0,function(){var r,i=this;return es.__generator(this,function(s){switch(s.label){case 0:return r=t?t.messageId:"",[4,this.instance.loadHistory(e8.G.Socket.user().id,e.scene,e.id,r,n)];case 1:return[2,s.sent().map(function(e){return i.convertAbstractMessage(e)})]}})})},e.convertAbstractMessage=function(e){var t={type:e.type,timestamp:e.timestamp,senderId:e.senderId,messageId:e.messageId,payload:e.payload};if(e.groupId){var n=new s$.GroupMessage;return n.groupId=e.groupId,n.senderData=e.senderData,Object.assign(n,es.__assign(es.__assign({},t),{recalled:!1,status:el.MessageStatus.SUCCESS})),n}var r=new sX.PrivateMessage;return r.receiverId=e.receiverId,Object.assign(r,es.__assign(es.__assign({},t),{read:!0,recalled:!1,status:el.MessageStatus.SUCCESS})),r},e}(),ax.WebhookConversation=function(){},ax.WebhookMessage=function(){},Object.defineProperty(ac,"__esModule",{value:!0}),ac.default=function(){function e(e){this.expiredTime=0,this.remoteHistory=ah.RemoteHistory.instance,this.target=e,this.userOffsets=new aS.UserOffsets,this.messageCache=new al.default(e)}return e.prototype.initMaxMessageAndOffsets=function(e,t){var n=this;this.existsMessage(e)||(this.messageCache.saveMessage(e),t.forEach(function(e){n.markLocalMessagesRead(n.messageCache.all(),e.userId,e.offset,!1)}))},e.prototype.existsMessage=function(e){return this.messageCache.existsMessage(e.messageId)},e.prototype.loadHistory=function(e,t){return es.__awaiter(this,void 0,void 0,function(){return es.__generator(this,function(n){switch(n.label){case 0:return this.expiredTime>0&&!this.messageCache.isEmpty()?[4,this.updateByServerChange()]:[3,2];case 1:n.sent(),n.label=2;case 2:return ev.default.isUndef(t)?t=10:t>30&&(t=30),[4,this.loadServerMessages(e,t)];case 3:return[2,n.sent()]}})})},e.prototype.loadCustomMessages=function(e,t,n){return es.__awaiter(this,void 0,void 0,function(){var r;return es.__generator(this,function(i){switch(i.label){case 0:return n>0&&void 0!==ax.IMCustomProvider.instance?(r=e,t&&(r=this.messageCache.findMessageByTime(t)),[4,ax.IMCustomProvider.loadCustomMessages(this.target,r,n)]):[3,2];case 1:return[2,i.sent()];case 2:return[2,[]]}})})},e.prototype.loadServerMessages=function(e,t){return es.__awaiter(this,void 0,void 0,function(){var n,r,i,s,o,a,u,c=this;return es.__generator(this,function(l){switch(l.label){case 0:return n=this.messageCache.loadLocalMessages(t,e),!1!==this.messageCache.allLoaded||n.length===t?[3,3]:(r=t-n.length,i=n[0]?n[0].timestamp:e,s=new a_.default(this.target.id.toString(),this.target.scene,i,r,this.target.teamId),[4,this.remoteHistory.loadServerMessages(this.target,s)]);case 1:return n=(a=(o=l.sent()).messages).concat(n),[4,this.loadCustomMessages(n[0],e,t-n.length)];case 2:u=l.sent(),a=a.concat(u),n=es.__spreadArray(es.__spreadArray([],es.__read(u),!1),es.__read(n),!1),this.messageCache.cacheServerMessages(s,a),o.userOffsets.forEach(function(e){c.userOffsets.updateOffset(e.userId,e.offset)}),this.userOffsets.offsetMap.forEach(function(e,t){c.markLocalMessagesRead(a,t,e,!1)}),l.label=3;case 3:return[2,n]}})})},e.prototype.deleteMessages=function(e){return es.__awaiter(this,void 0,void 0,function(){var t=this;return es.__generator(this,function(n){switch(n.label){case 0:return[4,this.aopUnreadAmountMaxMessage(function(){return es.__awaiter(t,void 0,void 0,function(){var t;return es.__generator(this,function(n){switch(n.label){case 0:return t=e.messages,[4,af.default.deleteServerMessages(t)];case 1:return n.sent(),this.messageCache.deleteMessages(t),eO.CallbackUtils.onSuccess(e),[2]}})})})];case 1:return n.sent(),[2]}})})},e.prototype.syncDeletedMessage=function(e,t){var n=this;this.aopUnreadAmountMaxMessage(function(){n.doSyncDeletedMessage(e,t)})},e.prototype.doSyncDeletedMessage=function(e,t){if(e===e8.G.Socket.user().id){var n=this.messageCache.findMessagesByTimes(t);this.messageCache.deleteMessages(n),n.length>0&&aM.AEC.fire(aI.ImApiEvents.MESSAGE_DELETED,n)}},e.prototype.recallMessages=function(e){return es.__awaiter(this,void 0,void 0,function(){var t=this;return es.__generator(this,function(n){switch(n.label){case 0:return[4,this.aopUnreadAmountMaxMessage(function(){return es.__awaiter(t,void 0,void 0,function(){return es.__generator(this,function(t){return this.doRecall(e),[2]})})})];case 1:return n.sent(),[2]}})})},e.prototype.doRecall=function(e){var t=this.messageCache.recallMessage(e);t.length>0&&aM.AEC.fire(aI.ImApiEvents.MESSAGE_RECALLED,t)},e.prototype.expire=function(){this.messageCache.isEmpty()||(this.expiredTime=this.messageCache.maxSuccessMessageTime())},e.prototype.updateByServerChange=function(){return es.__awaiter(this,void 0,void 0,function(){var e=this;return es.__generator(this,function(t){switch(t.label){case 0:return[4,this.aopUnreadAmountMaxMessage(function(){return es.__awaiter(e,void 0,void 0,function(){var e,t,n,r=this;return es.__generator(this,function(i){switch(i.label){case 0:return[4,this.remoteHistory.sync(this.target.scene,this.target.id,this.expiredTime,this.messageCache.minTime(),this.target.teamId)];case 1:return(e=i.sent()).userOffsets.forEach(function(e){r.markLocalMessagesRead(r.messageCache.all(),e.userId,e.offset,!0)}),(t=e.deletedMessageTimes).length>0&&this.doSyncDeletedMessage(e8.G.Socket.user().id,t),(n=e.recalledMessages).length>0&&n.forEach(function(e){var t=new aC.ServerRecalledEvent(r.target.scene,r.target.id,e.recaller,e.times);r.doRecall(t)}),this.expiredTime=0,[2]}})})})];case 1:return t.sent(),[2]}})})},e.prototype.markRead=function(){return es.__awaiter(this,void 0,void 0,function(){var e=this;return es.__generator(this,function(t){switch(t.label){case 0:return[4,this.aopUnreadAmountMaxMessage(function(){return es.__awaiter(e,void 0,void 0,function(){var e,t;return es.__generator(this,function(n){switch(n.label){case 0:return e=this.messageCache.maxSuccessMessageTime(),t=this.userOffsets.myOffset(),e>t?(this.userOffsets.markingTime=e,[4,this.remoteHistory.updateServerOffsets(e,this.target)]):[3,2];case 1:n.sent(),e===this.userOffsets.markingTime&&this.markLocalMessagesRead(this.messageCache.all(),e8.G.Socket.user().id,e,!0),n.label=2;case 2:return[2]}})})})];case 1:return t.sent(),[2]}})})},e.prototype.syncMarkedMessage=function(e){var t=this;this.aopUnreadAmountMaxMessage(function(){t.markLocalMessagesRead(t.messageCache.all(),e.markerId,e.time,!0)})},e.prototype.onMessageSending=function(e){var t=this;this.aopUnreadAmountMaxMessage(function(){t.messageCache.saveMessage(e)})},e.prototype.onMessageSendSuccess=function(e){var t=this;this.aopUnreadAmountMaxMessage(function(){t.messageCache.correctPosition(e),t.markLocalMessagesRead(t.messageCache.all(),e8.G.Socket.user().id,e.timestamp,!0)})},e.prototype.onMessageSendFailed=function(e){this.getMaxMessage()===e&&ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.MAX_MESSAGE_CHANGED,{message:e,receiver:this.to})},e.prototype.onMessageReceived=function(e){var t=this;this.aopUnreadAmountMaxMessage(function(){t.messageCache.saveMessage(e),t.markLocalMessagesRead(t.messageCache.all(),e.senderId,e.timestamp,!0)})},e.prototype.aopUnreadAmountMaxMessage=function(e,t){return es.__awaiter(this,void 0,void 0,function(){var n,r;return es.__generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),(n=new ak.UnreadAmountMaxMessageChangeDetector(this)).pre(),[4,e()];case 1:return i.sent(),n.post(),[3,3];case 2:return r=i.sent(),eO.CallbackUtils.onFailed(t,r),[3,3];case 3:return[2]}})})},e.prototype.markLocalMessagesRead=function(e,t,n,r){if(this.userOffsets.updateOffset(t,n),this.isOtherUserId(t)){var i=this.markMySentRead(e,n);r&&i.length>0&&aM.AEC.fire(aI.ImApiEvents.MESSAGE_READ,i)}else t===e8.G.Socket.user().id&&this.markOthersSentRead(e,n)},e.prototype.markOthersSentRead=function(e,t){if(this.target.scene===el.Scene.PRIVATE)for(var n=e.length-1;n>=0;n--){var r=e[n];if(r.isOtherSent()&&r.timestamp<=t){if(r.read)break;r.read=!0}}},e.prototype.markMySentRead=function(e,t){var n=[];if(this.target.scene===el.Scene.PRIVATE)for(var r=e.length-1;r>=0;r--){var i=e[r];if(!i.isOtherSent()&&i.timestamp<=t&&i.status===el.MessageStatus.SUCCESS){if(i.read)break;i.read=!0,n.push(i)}}return n},e.prototype.isOtherUserId=function(e){if(this.target.scene===el.Scene.CS){var t=this.target.customerId();return e8.G.Socket.user().id===t?e!==e8.G.Socket.user().id:e===t}return e!==e8.G.Socket.user().id},e.prototype.unreadAmount=function(e){var t,n,r=0,i=this.userOffsets.myOffset(),s=this.messageCache.all();try{for(var o=es.__values(s),a=o.next();!a.done;a=o.next()){var u=a.value;u.isOtherSent()&&!1===u.recalled&&u.timestamp>i&&(r+=1)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r},e.prototype.getMaxMessage=function(e){return this.messageCache.getMaxMessage()},e.prototype.maxTime=function(e){var t=this.getMaxMessage();return ev.default.isDef(t)?t.timestamp:0},e}();var aT={},aP={},aA={};Object.defineProperty(aA,"__esModule",{value:!0}),aA.LiveSessionRequest=void 0,aA.LiveSessionRequest=function(e,t){this.teamId=e,this.customerId=t};var aO={};Object.defineProperty(aO,"__esModule",{value:!0}),aO.CustomerStatus=void 0,aO.CustomerStatus=function(){};var aN={},aR={};Object.defineProperty(aR,"__esModule",{value:!0}),aR.CSOnlineRequest=void 0,aR.CSOnlineRequest=function(e,t,n){this.teamId=e,this.teamData=JSON.stringify(t),this.agentData=JSON.stringify(n)};var aF={};Object.defineProperty(aF,"__esModule",{value:!0}),aF.CSOfflineRequest=void 0,aF.CSOfflineRequest=function(e){this.teamId=e};var aG={};Object.defineProperty(aG,"__esModule",{value:!0}),aG.CsAgentsQueryRequest=void 0,aG.CsAgentsQueryRequest=function(e){this.teamId=e};var aj={},aU={},aB={},aL={exports:{}},aq=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,aV=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],az=function(e){var t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));for(var i=aq.exec(e||""),s={},o=14;o--;)s[aV[o]]=i[o]||"";return -1!=n&&-1!=r&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s},aH={exports:{}},aW={exports:{}},aX=function(e,t){t=t||{};var n=p(e);if("string"===n&&e.length>0){var r=e;if((r=String(r)).length>100)return;var i=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(r);if(i){var s=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return 864e5*s;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*s;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*s;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s}}return}if("number"===n&&!1===isNaN(e))return t.long?aJ(e,864e5,"day")||aJ(e,36e5,"hour")||aJ(e,6e4,"minute")||aJ(e,1e3,"second")||e+" ms":e>=864e5?Math.round(e/864e5)+"d":e>=36e5?Math.round(e/36e5)+"h":e>=6e4?Math.round(e/6e4)+"m":e>=1e3?Math.round(e/1e3)+"s":e+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function aJ(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}!function(e,t){function n(e){var n;function i(){if(i.enabled){var e=+new Date;i.diff=e-(n||e),i.prev=n,i.curr=e,n=e;for(var r=Array(arguments.length),s=0;s<r.length;s++)r[s]=arguments[s];r[0]=t.coerce(r[0]),"string"!=typeof r[0]&&r.unshift("%O");var o=0;r[0]=r[0].replace(/%([a-zA-Z%])/g,function(e,n){if("%%"===e)return e;o++;var s=t.formatters[n];if("function"==typeof s){var a=r[o];e=s.call(i,a),r.splice(o,1),o--}return e}),t.formatArgs.call(i,r),(i.log||t.log||console.log.bind(console)).apply(i,r)}}return i.namespace=e,i.enabled=t.enabled(e),i.useColors=t.useColors(),i.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n)|0;return t.colors[Math.abs(r)%t.colors.length]}(e),i.destroy=r,"function"==typeof t.init&&t.init(i),t.instances.push(i),i}function r(){var e=t.instances.indexOf(this);return -1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];var n,r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(RegExp("^"+e.substr(1)+"$")):t.names.push(RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var s=t.instances[n];s.enabled=t.enabled(s.namespace)}},t.enabled=function(e){var n,r;if("*"===e[e.length-1])return!0;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=aX,t.instances=[],t.names=[],t.skips=[],t.formatters={}}(aW,aW.exports),function(e,t){function n(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}(t=e.exports=aW.exports).log=function(){return"object"===("undefined"==typeof console?"undefined":p(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,s=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(s=i))}),e.splice(s,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return"undefined"!=typeof window&&!!window.process&&"renderer"===window.process.type||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(n())}(aH,aH.exports);var a$=aH.exports("socket.io-client:url"),aY=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(a$("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),a$("parse %s",e),n=az(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var r=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+r+":"+n.port,n.href=n.protocol+"://"+r+(t&&t.port===n.port?"":":"+n.port),n},aQ={},aK={}.toString,aZ=Array.isArray||function(e){return"[object Array]"==aK.call(e)};!function(e){aH.exports("socket.io-parser");var t=eR.exports;function n(){}e.protocol=4,e.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],e.CONNECT=0,e.DISCONNECT=1,e.EVENT=2,e.ACK=3,e.ERROR=4,e.BINARY_EVENT=5,e.BINARY_ACK=6,e.Encoder=n,e.Decoder=i;var r=e.ERROR+'"encode error"';function i(){this.reconstructor=null}function s(t){return{type:e.ERROR,data:"parser error: "+t}}n.prototype.encode=function(t,n){n([function(t){var n=""+t.type;if(e.BINARY_EVENT!==t.type&&e.BINARY_ACK!==t.type||(n+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(n+=t.nsp+","),null!=t.id&&(n+=t.id),null!=t.data){var i=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(t.data);if(!1===i)return r;n+=i}return n}(t)])},t(i.prototype),i.prototype.add=function(t){var n;if("string"!=typeof t)throw Error("Unknown type: "+t);n=function(t){var n,r=0,i={type:Number(t.charAt(0))};if(null==e.types[i.type])return s("unknown packet type "+i.type);if(e.BINARY_EVENT===i.type||e.BINARY_ACK===i.type){for(var o="";"-"!==t.charAt(++r)&&(o+=t.charAt(r),r!=t.length););if(o!=Number(o)||"-"!==t.charAt(r))throw Error("Illegal attachments");i.attachments=Number(o)}if("/"===t.charAt(r+1))for(i.nsp="";++r&&","!==(n=t.charAt(r))&&(i.nsp+=n,r!==t.length););else i.nsp="/";var a=t.charAt(r+1);if(""!==a&&Number(a)==a){for(i.id="";++r;){if(null==(n=t.charAt(r))||Number(n)!=n){--r;break}if(i.id+=t.charAt(r),r===t.length)break}i.id=Number(i.id)}if(t.charAt(++r)){var u=function(e){try{return JSON.parse(e)}catch(e){return!1}}(t.substr(r));if(!(!1!==u&&(i.type===e.ERROR||aZ(u))))return s("invalid payload");i.data=u}return i}(t),this.emit("decoded",n)},i.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}(aQ);var a0={exports:{}},a1={},a2={},a3=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t},a4=Object.prototype.toString,a6="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===a4.call(Blob),a5="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===a4.call(File),a9=function e(t){if(!t||"object"!==p(t))return!1;if(aZ(t)){for(var n=0,r=t.length;n<r;n++)if(e(t[n]))return!0;return!1}if("function"==typeof i&&i.isBuffer&&i.isBuffer(t)||"function"==typeof ArrayBuffer&&t instanceof ArrayBuffer||a6&&t instanceof Blob||a5&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1==arguments.length)return e(t.toJSON(),!0);for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e(t[s]))return!0;return!1},a7=function(e,t,n){var r=!1;return n=n||a8,i.count=e,0===e?t():i;function i(e,s){if(i.count<=0)throw Error("after called too many times");--i.count,e?(r=!0,t(e),t=n):0!==i.count||r||t(null,s)}};function a8(){}var ue,ut,un,ur,ui=String.fromCharCode;function us(e){for(var t,n,r=[],i=0,s=e.length;i<s;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<s?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function uo(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function ua(e,t){return ui(e>>t&63|128)}function uu(){if(ur>=un)throw Error("Invalid byte index");var e=255&ut[ur];if(ur++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}var uc={encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=us(e),i=r.length,s=-1,o="";++s<i;)o+=function(e,t){if(0==(0xffffff80&e))return ui(e);var n="";return 0==(0xfffff800&e)?n=ui(e>>6&31|192):0==(0xffff0000&e)?(uo(e,t)||(e=65533),n=ui(e>>12&15|224)+ua(e,6)):0==(0xffe00000&e)&&(n=ui(e>>18&7|240)+ua(e,12)+ua(e,6)),n+=ui(63&e|128)}(r[s],n);return o},decode:function(e,t){var n=!1!==(t=t||{}).strict;un=(ut=us(e)).length,ur=0;for(var r,i=[];!1!==(r=function(e){var t,n;if(ur>un)throw Error("Invalid byte index");if(ur==un)return!1;if(t=255&ut[ur],ur++,0==(128&t))return t;if(192==(224&t)){if((n=(31&t)<<6|uu())>=128)return n;throw Error("Invalid continuation byte")}if(224==(240&t)){if((n=(15&t)<<12|uu()<<6|uu())>=2048)return uo(n,e)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(n=(7&t)<<18|uu()<<12|uu()<<6|uu())>=65536&&n<=1114111)return n;throw Error("Invalid UTF-8 detected")}(n));)i.push(r);for(var s,o=i.length,a=-1,u="";++a<o;)(s=i[a])>65535&&(u+=ui((s-=65536)>>>10&1023|55296),s=56320|1023&s),u+=ui(s);return u}},ul=void 0!==ul?ul:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,up=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),uf=up&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),ud=ul&&ul.prototype.append&&ul.prototype.getBlob;function uh(e){return e.map(function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e})}function uy(e,t){t=t||{};var n=new ul;return uh(e).forEach(function(e){n.append(e)}),t.type?n.getBlob(t.type):n.getBlob()}function uv(e,t){return new Blob(uh(e),t||{})}"undefined"!=typeof Blob&&(uy.prototype=Blob.prototype,uv.prototype=Blob.prototype);var um=up?uf?Blob:uv:ud?uy:void 0;function ug(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}"undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),"undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),a2.protocol=3,uE=a3(ub=a2.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6}),uS={type:"error",data:"parser error"},a2.encodePacket=function(e,t,n,r){"function"==typeof t&&(r=t,t=!1),"function"==typeof n&&(r=n,n=null),void 0===e.data||e.data.buffer||e.data;var i=ub[e.type];return void 0!==e.data&&(i+=n?uc.encode(String(e.data),{strict:!1}):String(e.data)),r(""+i)},a2.decodePacket=function(e,t,n){if(void 0===e)return uS;if("string"==typeof e){if(n&&!1===(e=function(e){try{e=uc.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return uS;var r=e.charAt(0);return Number(r)==r&&uE[r]?e.length>1?{type:uE[r],data:e.substring(1)}:{type:uE[r]}:uS}r=new Uint8Array(e)[0];var i=sliceBuffer(e,1);return um&&"blob"===t&&(i=new um([i])),{type:uE[r],data:i}},a2.encodePayload=function(e,t,n){"function"==typeof t&&(n=t,t=null);var r=a9(e);if(!e.length)return n("0:");!function(e,t,n){for(var r=Array(e.length),i=a7(e.length,n),s=function(e,n,i){t(n,function(t,n){r[e]=n,i(t,r)})},o=0;o<e.length;o++)s(o,e[o],i)}(e,function(e,n){a2.encodePacket(e,!!r&&t,!0,function(e){n(null,e.length+":"+e)})},function(e,t){return n(t.join(""))})},a2.decodePayload=function(e,t,n){var r;if("function"==typeof t&&(n=t,t=null),""===e)return n(uS,0,1);for(var i,s,o="",a=0,u=e.length;a<u;a++){var c=e.charAt(a);if(":"===c){if(""===o||o!=(i=Number(o))||o!=(s=e.substr(a+1,i)).length)return n(uS,0,1);if(s.length){if(r=a2.decodePacket(s,t,!0),uS.type===r.type&&uS.data===r.data)return n(uS,0,1);if(!1===n(r,a+i,u))return}a+=i,o=""}else o+=c}return""!==o?n(uS,0,1):void 0},(0,eR.exports)(ug.prototype),ug.prototype.onError=function(e,t){var n=Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},ug.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},ug.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},ug.prototype.send=function(e){if("open"!==this.readyState)throw Error("Transport not open");this.write(e)},ug.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},ug.prototype.onData=function(e){var t=a2.decodePacket(e,this.socket.binaryType);this.onPacket(t)},ug.prototype.onPacket=function(e){this.emit("packet",e)},ug.prototype.onClose=function(){this.readyState="closed",this.emit("close")};var ub,uE,uS,u_,uk={encode:function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},decode:function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var s=n[r].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}},uC=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},uM="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),uD={},uw=0,uI=0;function ux(e){var t="";do t=uM[e%64]+t,e=Math.floor(e/64);while(e>0);return t}function uT(){var e=ux(+new Date);return e!==u_?(uw=0,u_=e):e+"."+ux(uw++)}for(;uI<64;uI++)uD[uM[uI]]=uI;uT.encode=ux,uT.decode=function(e){var t=0;for(uI=0;uI<e.length;uI++)t=64*t+uD[e.charAt(uI)];return t};var uP={exports:{}};try{uP.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){uP.exports=!1}var uA=uP.exports,uO=aH.exports("engine.io-client:polling"),uN=null!=new function(e){var t=e.xdomain,n=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||uA))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&r)return new XDomainRequest}catch(e){}if(!t)try{return new self[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(e){}}({xdomain:!1}).responseType;function uR(e){var t=e&&e.forceBase64;uN&&!t||(this.supportsBinary=!1),ug.call(this,e)}uC(uR,ug),uR.prototype.name="polling",uR.prototype.doOpen=function(){this.poll()},uR.prototype.pause=function(e){var t=this;function n(){uO("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(uO("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){uO("pre-pause polling complete"),--r||n()})),this.writable||(uO("we are currently writing - waiting to pause"),r++,this.once("drain",function(){uO("pre-pause writing complete"),--r||n()}))}else n()},uR.prototype.poll=function(){uO("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},uR.prototype.onData=function(e){var t=this;uO("polling got data %s",e),a2.decodePayload(e,this.socket.binaryType,function(e,n,r){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():uO('ignoring poll - transport state "%s"',this.readyState))},uR.prototype.doClose=function(){var e=this;function t(){uO("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(uO("transport open - closing"),t()):(uO("transport not open - deferring close"),this.once("open",t))},uR.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};a2.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},uR.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=uT()),this.supportsBinary||e.sid||(e.b64=1),e=uk.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e};var uF,uG=/\n/g,uj=/\\n/g;function uU(){}function uB(t){if(uR.call(this,t),this.query=this.query||{},!uF){var n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:{};uF=n.___eio=n.___eio||[]}this.index=uF.length;var r=this;uF.push(function(e){r.onData(e)}),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",function(){r.script&&(r.script.onerror=uU)},!1)}uC(uB,uR),uB.prototype.supportsBinary=!1,uB.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),uR.prototype.doClose.call(this)},uB.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},uB.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,i=document.createElement("form"),s=document.createElement("textarea"),o=this.iframeId="eio_iframe_"+this.index;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=o,i.method="POST",i.setAttribute("accept-charset","utf-8"),s.name="d",i.appendChild(s),document.body.appendChild(i),this.form=i,this.area=s}function a(){u(),t()}function u(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),u(),e=e.replace(uj,"\\\n"),this.area.value=e.replace(uG,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&a()}:this.iframe.onload=a};var uL,uq,uV=aH.exports("engine.io-client:websocket");("undefined"==typeof uni&&"undefined"==typeof wx&&"undefined"==typeof my&&"undefined"==typeof swan||"undefined"!=typeof WebSocket)&&("undefined"!=typeof WebSocket?uL=WebSocket:"undefined"!=typeof self&&(uL=self.WebSocket||self.MozWebSocket));var uz=uL||uq;function uH(e){e&&e.forceBase64&&(this.supportsBinary=!1),("undefined"==typeof uni&&"undefined"==typeof wx&&"undefined"==typeof my&&"undefined"==typeof swan||"undefined"!=typeof WebSocket)&&(this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=uL&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(uz=uq)),ug.call(this,e)}("undefined"==typeof uni&&"undefined"==typeof wx&&"undefined"==typeof my&&"undefined"==typeof swan||"undefined"!=typeof WebSocket)&&"undefined"==typeof GameGlobal||(uz=function(e){var t=this;if(t.onopen=function(){},t.onclose=function(){},t.onmessage=function(e){},t.onerror=function(e){},"object"===("undefined"==typeof tt?"undefined":p(tt))&&tt.getSystemInfo){var n=tt.connectSocket({url:e});t.send=function(e){n.send({data:e})},t.close=function(){n.close()},n.onOpen(function(){t.onopen()}),n.onError(function(e){t.onerror(e)}),n.onMessage(function(e){t.onmessage(e)}),n.onClose(function(){t.onclose()})}else if("undefined"!=typeof my)my.connectSocket({url:e}),t.send=function(e){my.sendSocketMessage({data:e})},t.close=function(e){my.closeSocket()},my.onSocketOpen(function(e){t.onopen()}),my.onSocketError(function(e){t.onerror(e)}),my.onSocketMessage(function(e){t.onmessage(e)}),my.onSocketClose(function(e){t.onclose(e)});else if("undefined"!=typeof swan)swan.connectSocket({url:e}),t.send=function(e){swan.sendSocketMessage({data:e})},t.close=function(e){swan.closeSocket()},swan.onSocketOpen(function(e){t.onopen()}),swan.onSocketError(function(e){t.onerror(e)}),swan.onSocketMessage(function(e){t.onmessage(e)}),swan.onSocketClose(function(e){t.onclose(e)});else if("undefined"!=typeof uni){var r=uni.connectSocket({url:e,complete:function(){}});t.send=function(e){r.send({data:e})},t.close=function(){r.close()},r.onOpen(function(e){t.onopen()}),r.onError(function(e){t.onerror(e)}),r.onMessage(function(e){t.onmessage(e)}),r.onClose(function(e){t.onclose()})}else{var i=wx.connectSocket({url:e});t.send=function(e){i.send({data:e})},t.close=function(e){i.close({code:1e3})},i.onOpen(function(){t.onopen()}),i.onError(function(e){t.onerror(e)}),i.onMessage(function(e){t.onmessage(e)}),i.onClose(function(e){t.onclose(e)})}}),uC(uH,ug),uH.prototype.name="websocket",uH.prototype.supportsBinary=!1,uH.prototype.doOpen=function(){var e=this;if(this.check()){var t,n,r=this.uri();if(("undefined"==typeof uni&&"undefined"==typeof wx&&"undefined"==typeof my&&"undefined"==typeof swan||"undefined"!=typeof WebSocket)&&(t=this.protocols),(n="undefined"==typeof uni&&"undefined"==typeof wx&&"undefined"==typeof my&&"undefined"==typeof swan||"undefined"!=typeof WebSocket?{agent:this.agent,perMessageDeflate:this.perMessageDeflate}:{agent:this.agent}).pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,"object"===("undefined"==typeof navigator?"undefined":p(navigator))&&"ReactNative"===navigator.product&&(n={}),this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress),"undefined"!=typeof cc&&"Windows"===cc.sys.os)cc.resources.load("cacert",function(t,n){var i=n.nativeUrl;e.ws=new uz(r,[],i),e.ws.binaryType="arraybuffer",e.addEventListeners()});else{try{"undefined"==typeof uni&&"undefined"==typeof wx&&"undefined"==typeof my&&"undefined"==typeof swan||"undefined"!=typeof WebSocket?this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new uz(r,t):new uz(r):new uz(r,t,n):this.ws=new uz(r)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}}},uH.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},uH.prototype.write=function(e){var t=this;this.writable=!1;for(var n=e.length,r=0,s=n;r<s;r++)!function(e){a2.encodePacket(e,t.supportsBinary,function(r){if("undefined"==typeof uni&&"undefined"==typeof wx&&"undefined"==typeof my&&"undefined"==typeof swan||"undefined"!=typeof WebSocket){if(!t.usingBrowserWebSocket){var s={};e.options&&(s.compress=e.options.compress),t.perMessageDeflate&&("string"==typeof r?i.byteLength(r):r.length)<t.perMessageDeflate.threshold&&(s.compress=!1)}try{t.usingBrowserWebSocket?t.ws.send(r):t.ws.send(r,s)}catch(e){uV("websocket closed before onclose event")}}else try{t.ws.send(r)}catch(e){uV("websocket closed before onclose event")}--n||(t.emit("flush"),setTimeout(function(){t.writable=!0,t.emit("drain")},0))})}(e[r])},uH.prototype.onClose=function(){ug.prototype.onClose.call(this)},uH.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},uH.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=uT()),this.supportsBinary||(e.b64=1),(e=uk.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},uH.prototype.check=function(){return!(!uz||"__initialize"in uz&&this.name===uH.prototype.name)},a1.polling=function(e){var t=!1,n=!1;if(e.jsonp,"undefined"!=typeof location){var r="https:"===location.protocol,i=location.port;i||(i=r?443:80),t=e.hostname!==location.hostname||i!==e.port,n=e.secure!==r}return e.xdomain=t,e.xscheme=n,new uB(e)},a1.websocket=uH;var uW=[].indexOf,uX=function(e,t){if(uW)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return -1},uJ=eR.exports,u$=aH.exports("engine.io-client:socket");function uY(e,t){if(!(this instanceof uY))return new uY(e,t);t=t||{},e&&"object"===p(e)&&(t=e,e=null),e?(e=az(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=az(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=uk.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}uY.priorWebsocketSuccess=!1,uJ(uY.prototype),uY.protocol=a2.protocol,uY.Socket=uY,uY.Transport=ug,uY.transports=a1,uY.parser=a2,uY.prototype.createTransport=function(e){u$('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=a2.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new a1[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},uY.prototype.open=function(){var e;if(this.rememberUpgrade&&uY.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},uY.prototype.setTransport=function(e){u$("setting transport %s",e.name);var t=this;this.transport&&(u$("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},uY.prototype.probe=function(e){u$('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;function i(){if(r.onlyBinaryUpgrades){var i=!this.supportsBinary&&r.transport.supportsBinary;n=n||i}n||(u$('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(i){if(!n)if("pong"===i.type&&"probe"===i.data){if(u$('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;uY.priorWebsocketSuccess="websocket"===t.name,u$('pausing current transport "%s"',r.transport.name),r.transport.pause(function(){n||"closed"!==r.readyState&&(u$("changing transport and sending upgrade packet"),l(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())})}else{u$('probe transport "%s" failed',e);var s=Error("probe error");s.transport=t.name,r.emit("upgradeError",s)}}))}function s(){n||(n=!0,l(),t.close(),t=null)}function o(n){var i=Error("probe error: "+n);i.transport=t.name,s(),u$('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",i)}function a(){o("transport closed")}function u(){o("socket closed")}function c(e){t&&e.name!==t.name&&(u$('"%s" works - aborting "%s"',e.name,t.name),s())}function l(){t.removeListener("open",i),t.removeListener("error",o),t.removeListener("close",a),r.removeListener("close",u),r.removeListener("upgrading",c)}uY.priorWebsocketSuccess=!1,t.once("open",i),t.once("error",o),t.once("close",a),this.once("close",u),this.once("upgrading",c),t.open()},uY.prototype.onOpen=function(){if(u$("socket open"),this.readyState="open",uY.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){u$("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},uY.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(u$('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else u$('packet received with socket readyState "%s"',this.readyState)},uY.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},uY.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},uY.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){u$("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},uY.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},uY.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},uY.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(u$("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},uY.prototype.write=uY.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},uY.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},uY.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():t()}):this.upgrading?r():t()}function t(){e.onClose("forced close"),u$("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return this},uY.prototype.onError=function(e){u$("socket error %j",e),uY.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},uY.prototype.onClose=function(e,t){("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)&&(u$('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)},uY.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~uX(this.transports,e[n])&&t.push(e[n]);return t},a0.exports=uY,a0.exports.parser=a2;var uQ={exports:{}},uK=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n},uZ=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}},u0=[].slice,u1=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw Error("bind() requires a function");var n=u0.call(arguments,2);return function(){return t.apply(e,n.concat(u0.call(arguments)))}};function u2(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}!function(e,t){var n=eR.exports,r=(aH.exports("socket.io-client:socket"),uk);e.exports=o;var i={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},s=n.prototype.emit;function o(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}n(o.prototype),o.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[uZ(e,"open",u1(this,"onopen")),uZ(e,"packet",u1(this,"onpacket")),uZ(e,"close",u1(this,"onclose"))]}},o.prototype.open=o.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},o.prototype.send=function(){var e=uK(arguments);return e.unshift("message"),this.emit.apply(this,e),this},o.prototype.emit=function(e){if(i.hasOwnProperty(e))return s.apply(this,arguments),this;var t=uK(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:a9(t))?aQ.BINARY_EVENT:aQ.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(this.ids,this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},o.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},o.prototype.onopen=function(){if("/"!==this.nsp)if(this.query){var e="object"===p(this.query)?r.encode(this.query):this.query;this.packet({type:aQ.CONNECT,query:e})}else this.packet({type:aQ.CONNECT})},o.prototype.onclose=function(e){this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},o.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===aQ.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case aQ.CONNECT:this.onconnect();break;case aQ.EVENT:case aQ.BINARY_EVENT:this.onevent(e);break;case aQ.ACK:case aQ.BINARY_ACK:this.onack(e);break;case aQ.DISCONNECT:this.ondisconnect();break;case aQ.ERROR:this.emit("error",e.data)}},o.prototype.onevent=function(e){var t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?s.apply(this,t):this.receiveBuffer.push(t)},o.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var r=uK(arguments);t.packet({type:a9(r)?aQ.BINARY_ACK:aQ.ACK,id:e,data:r})}}},o.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(e.id,e.data,t.apply(this,e.data),delete this.acks[e.id]):e.id},o.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},o.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)s.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},o.prototype.ondisconnect=function(){this.nsp,this.destroy(),this.onclose("io server disconnect")},o.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},o.prototype.close=o.prototype.disconnect=function(){return this.connected&&(this.nsp,this.packet({type:aQ.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},o.prototype.compress=function(e){return this.flags.compress=e,this},o.prototype.binary=function(e){return this.flags.binary=e,this}}(uQ),u2.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},u2.prototype.reset=function(){this.attempts=0},u2.prototype.setMin=function(e){this.ms=e},u2.prototype.setMax=function(e){this.max=e},u2.prototype.setJitter=function(e){this.jitter=e};var u3={};Object.defineProperty(u3,"__esModule",{value:!0}),u3.URIResolver=void 0,u3.URIResolver=function(){function e(){}return e.init=function(e,t,n){this.host=e,(void 0!==t&&!1===t||!0===n)&&(this.https=!1)},e.isMP=function(){return[em.PlatformType.MP_WX,em.PlatformType.MP_ALI,em.PlatformType.MP_BYTE,em.PlatformType.MP_WGAME,em.PlatformType.MP_BAIDU].includes(em.PlatformDetector.currentPlatform())},e.uri=function(){var e="http";return this.https&&(e+="s"),e+"://"+this.index()+this.host},e.index=function(){return 0==this.i?this.i=Math.floor(Math.random()*this.max)+1:this.i=this.i%this.max+1,this.i},e.i=0,e.max=5,e.https=!0,e}();var u4=a0.exports,u6=uQ.exports,u5=eR.exports,u9=(aH.exports("socket.io-client:manager"),uX),u7=u3.URIResolver,u8=eb.runStatus,ce=Object.prototype.hasOwnProperty;function ct(e,t){if(!(this instanceof ct))return new ct(e,t);e&&"object"===p(e)&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new u2({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||aQ;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}ct.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)ce.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},ct.prototype.updateSocketIds=function(){for(var e in this.nsps)ce.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},ct.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},u5(ct.prototype),ct.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},ct.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},ct.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},ct.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},ct.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},ct.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},ct.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},ct.prototype.open=ct.prototype.connect=function(e,t){if(this.readyState,~this.readyState.indexOf("open"))return this;this.uri,this.engine=u4(this.uri,this.opts);var n,r=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var s=uZ(r,"open",function(){i.onopen(),e&&e()}),o=uZ(r,"error",(n=d(c().mark(function t(n){var r;return c().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i.uri=u7.uri(),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",n),e?((r=Error("Connection error")).data=n,e(r)):i.maybeReconnectOnOpen();case 6:case"end":return t.stop()}},t)})),function(e){return n.apply(this,arguments)}));if(!1!==this._timeout){var a=this._timeout,u=setTimeout(function(){s.destroy(),r.close(),r.emit("error","timeout"),i.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(u)}})}return this.subs.push(s),this.subs.push(o),this},ct.prototype.onopen=function(){this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(uZ(e,"data",u1(this,"ondata"))),this.subs.push(uZ(e,"ping",u1(this,"onping"))),this.subs.push(uZ(e,"pong",u1(this,"onpong"))),this.subs.push(uZ(e,"error",u1(this,"onerror"))),this.subs.push(uZ(e,"close",u1(this,"onclose"))),this.subs.push(uZ(this.decoder,"decoded",u1(this,"ondecoded")))},ct.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},ct.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},ct.prototype.ondata=function(e){this.decoder.add(e)},ct.prototype.ondecoded=function(e){this.emit("packet",e)},ct.prototype.onerror=function(e){this.emitAll("error",e)},ct.prototype.socket=function(e,t){var n=this.nsps[e];if(!n){n=new u6(this,e,t),this.nsps[e]=n;var r=this;n.on("connecting",i),n.on("connect",function(){n.id=r.generateId(e)}),this.autoConnect&&i()}function i(){~u9(r.connecting,n)||r.connecting.push(n)}return n},ct.prototype.destroy=function(e){var t=u9(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},ct.prototype.packet=function(e){var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()}))},ct.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},ct.prototype.cleanup=function(){for(var e=this.subs.length,t=0;t<e;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},ct.prototype.close=ct.prototype.disconnect=function(){this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},ct.prototype.onclose=function(e){this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},ct.prototype.reconnect=function(){if(u8.isBackend(),this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();this.reconnecting=!0;var n=setTimeout(function(){if(u8.isBackend())return e.reconnecting=!1,e.reconnect(),void e.emitAll("reconnect_error","Uniapp running backend, skipped reconnect...");e.skipReconnect||(e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):e.onreconnect()}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},ct.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)},function(e,t){aH.exports("socket.io-client"),e.exports=t=r;var n=t.managers={};function r(e,t){"object"===p(e)&&(t=e,e=void 0),t=t||{};var r,i=aY(e),s=i.source,o=i.id,a=i.path,u=n[o]&&a in n[o].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||u?r=ct(s,t):(n[o]||(n[o]=ct(s,t)),r=n[o]),i.query&&!t.query&&(t.query=i.query),r.socket(i.path,t)}t.protocol=aQ.protocol,t.connect=r,t.Manager=ct,t.Socket=uQ.exports}(aL,aL.exports),Object.defineProperty(aB,"__esModule",{value:!0});var cn=aL.exports;aB.default=function(){function e(){this.io=cn,this.status=ec.NetworkStatus.DISCONNECTED,this.permissions=[e8.Permission.NONE],this.connectedObservers=[],this.disconnectedObservers=[]}return e.prototype.connect=function(){this.status=ec.NetworkStatus.CONNECTING},e.prototype.socketio=function(){return this.io},e.prototype.on=function(e,t){this.io.on(e,t)},e.prototype.disconnect=function(){this.io.disconnect()},e.prototype.getStatus=function(){return this.status},e.prototype.addConnectedObserver=function(e){ev.default.isFunction(e)&&this.connectedObservers.push(e)},e.prototype.addDisconnectedObserver=function(e){ev.default.isFunction(e)&&this.disconnectedObservers.push(e)},e.prototype.notify=function(e,t){for(var n=0;n<e.length;n++)e[n](t)},e}();var cr={};Object.defineProperty(cr,"__esModule",{value:!0}),cr.default=function(e){function t(t){var n=e.call(this)||this;return n.reconnectingObservers=[],n.addReconnectingObserver(t.onReconnecting),n.addDisconnectedObserver(t.onDisconnected),n}return es.__extends(t,e),t.prototype.connect=function(t){e.prototype.connect.call(this),this.io=this.io.connect(t.uri,t.opts),this.initListener()},t.prototype.initListener=function(){var e=this;this.io.on("connect",function(){e.status=ec.NetworkStatus.CONNECTED,e.notify(e.connectedObservers)}),this.io.on("reconnecting",function(t){e.status=ec.NetworkStatus.CONNECTING,e.notify(e.reconnectingObservers,t)}),this.io.on("disconnect",function(){e.status=ec.NetworkStatus.DISCONNECTED,e.notify(e.disconnectedObservers)}),this.io.on("connect_error",function(e){})},t.prototype.addReconnectingObserver=function(e){this.reconnectingObservers.push(e)},t}(aB.default);var ci={},cs={},co={};Object.defineProperty(co,"__esModule",{value:!0}),co.Cookie=void 0,co.Cookie=function(){function e(){}return e.get=function(e){var t,n,r=encodeURIComponent(e)+"=",i=document.cookie.split("; ");try{for(var s=es.__values(i),o=s.next();!o.done;o=s.next()){var a=o.value;if(a.startsWith(r))return decodeURIComponent(a.substring(r.length))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return null},e.set=function(e,t,n,r,i,s){void 0===i&&(i="/"),void 0===s&&(s=!1);var o=encodeURIComponent(e)+"="+encodeURIComponent(t);n instanceof Date&&(o+="; expires="+n.toGMTString()),i&&(o+="; path="+i),r&&(o+="; domain="+r),s&&(o+="; secure"),document.cookie=o},e.remove=function(t,n,r,i){void 0===r&&(r="/"),void 0===i&&(i=!1),e.set(t,"",new Date(0),n,r,i)},e}(),Object.defineProperty(cs,"__esModule",{value:!0}),cs.LocalStorageDispatcher=cs.BrowserStorage=cs.AbstractLocalStorage=void 0;var ca=function(){function e(){}return e.prototype.asyncGet=function(e){return Promise.resolve(this.get(e))},e.prototype.asyncPut=function(e,t){return this.put(e,t),Promise.resolve()},e.prototype.get=function(e){return JSON.parse(this.doGet(e))},e.prototype.put=function(e,t){this.doPut(e,JSON.stringify(t))},e}();cs.AbstractLocalStorage=ca;var cu=function(e){function t(){var t=e.call(this)||this;return t.domain=null,t.domain="undefined"!=typeof location&&/^(?:[A-za-z0-9-]+\.)+[A-za-z]{2,4}(?:[\/\?#][\/=\?%\-&~`@[\]\':+!\.#\w]*)?$/.test(location.host)?location.host.split(".").slice(-2).join("."):null,t}return es.__extends(t,e),t.prototype.doGet=function(e){return co.Cookie.get(e)||null},t.prototype.doPut=function(e,t){var n=new Date(2030,12,31,0,0,0,0),r=this.domain;co.Cookie.set(e,t,n,r)},t.prototype.remove=function(e){var t=this.domain;co.Cookie.remove(e,t)},t.prototype.support=function(){return"undefined"!=typeof navigator&&!0===navigator.cookieEnabled},t}(ca),cl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.doGet=function(e){return localStorage.getItem(e)||null},t.prototype.doPut=function(e,t){localStorage.setItem(e,t)},t.prototype.remove=function(e){localStorage.removeItem(e)},t.prototype.support=function(){return!("undefined"!=typeof GameGlobal||"undefined"==typeof localStorage||!localStorage.setItem)},t}(ca),cp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.doGet=function(e){return uni.getStorageSync(e)||null},t.prototype.doPut=function(e,t){uni.setStorageSync(e,t)},t.prototype.remove=function(e){uni.removeStorageSync(e)},t.prototype.support=function(){return!("object"!==("undefined"==typeof uni?"undefined":p(uni))||!uni.getStorageSync)},t}(ca),cf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.doGet=function(e){return cc.sys.localStorage.getItem(e)||null},t.prototype.doPut=function(e,t){cc.sys.localStorage.setItem(e,t)},t.prototype.remove=function(e){cc.sys.localStorage.removeItem(e)},t.prototype.support=function(){return"undefined"!=typeof cc&&void 0!==cc.sys.localStorage},t}(ca),cd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.doGet=function(e){return wx.getStorageSync(e)||null},t.prototype.doPut=function(e,t){wx.setStorageSync(e,t)},t.prototype.remove=function(e){wx.removeStorageSync(e)},t.prototype.support=function(){return!("object"!==("undefined"==typeof wx?"undefined":p(wx))||!wx.getStorageSync||"undefined"!=typeof tt)},t}(ca),ch=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.asyncGet=function(e){return es.__awaiter(this,void 0,void 0,function(){return es.__generator(this,function(t){switch(t.label){case 0:return[4,o.RNPlugins.asyncStorage.getItem(e)];case 1:return[2,JSON.parse(t.sent())]}})})},t.prototype.asyncPut=function(e,t){return o.RNPlugins.asyncStorage.setItem(e,JSON.stringify(t))},t.prototype.doPut=function(e,t){throw Error("Method not implemented.")},t.prototype.remove=function(e){o.RNPlugins.asyncStorage.removeItem(e)},t.prototype.support=function(){return w.FrameworkDetector.currentFramework()===w.Framework.REACT_NATIVE},t.prototype.doGet=function(e){throw Error("Method not implemented.")},t}(ca),cy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.doGet=function(e){var t=my.getStorageSync({key:e}).data||null;return"string"==typeof JSON.parse(t)?JSON.parse(t):t},t.prototype.doPut=function(e,t){my.setStorageSync({key:e,data:JSON.stringify(t)})},t.prototype.remove=function(e){my.removeStorageSync({key:e})},t.prototype.support=function(){return!("undefined"==typeof my||!my.getStorageSync)},t}(ca);function cv(){return null!==ca&&ca.apply(this,arguments)||this}es.__extends(cv,ca),cv.prototype.doGet=function(e){return qq.getStorageSync(e)||null},cv.prototype.doPut=function(e,t){qq.setStorageSync(e,t)},cv.prototype.remove=function(e){qq.removeStorageSync(e)},cv.prototype.support=function(){return!("undefined"==typeof qq||!qq.getStorageSync)};var cm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.doGet=function(e){return tt.getStorageSync(e)||null},t.prototype.doPut=function(e,t){tt.setStorageSync(e,t)},t.prototype.remove=function(e){tt.removeStorageSync(e)},t.prototype.support=function(){return!("object"!==("undefined"==typeof tt?"undefined":p(tt))||!tt.getStorageSync)},t}(ca),cg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.doGet=function(e){return swan.getStorageSync(e)||null},t.prototype.doPut=function(e,t){swan.setStorageSync(e,t)},t.prototype.remove=function(e){swan.removeStorageSync(e)},t.prototype.support=function(){return!("undefined"==typeof swan||!swan.getStorageSync)},t}(ca);cs.BrowserStorage=function(e){function t(){var n=e.call(this)||this;return n.api=t.dispatch(),n.api,n}return es.__extends(t,e),t.dispatch=function(){var e=new cl,t=new cu;return e.support()?e:t},t.prototype.doGet=function(e){return this.api.doGet(e)},t.prototype.doPut=function(e,t){this.api.put(e,t)},t.prototype.remove=function(e){this.api.remove(e)},t.prototype.support=function(){return"undefined"!=typeof localStorage},t}(ca),cs.LocalStorageDispatcher=function(){function e(){this.supportedStorage=null;var t=e.storages;t.push(new cp),t.push(new cf),t.push(new cl),t.push(new cd),t.push(new ch),t.push(new cy),t.push(new cg),t.push(new cm),t.push(new cu),this.dispatch(),this.supportedStorage}return e.localStorage=function(){return this.instance.supportedStorage},e.prototype.dispatch=function(){var t,n;try{for(var r=es.__values(e.storages),i=r.next();!i.done;i=r.next()){var s=i.value;if(s.support()){this.supportedStorage=s;break}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.storages=[],e.instance=new e,e}(),Object.defineProperty(ci,"__esModule",{value:!0}),ci.ServerMarkRepository=void 0,ci.ServerMarkRepository=function(){function e(){}return e.get=function(){return es.__awaiter(this,void 0,void 0,function(){var t,n;return es.__generator(this,function(r){switch(r.label){case 0:return null===(t=cs.LocalStorageDispatcher.localStorage())?[3,2]:[4,t.asyncGet(e.SM_KEY)];case 1:n=r.sent(),r.label=2;case 2:return[2,n]}})})},e.put=function(t){return es.__awaiter(this,void 0,void 0,function(){var n,r;return es.__generator(this,function(i){return n=cs.LocalStorageDispatcher.localStorage(),r=t.sm,null!==n&&r&&n.asyncPut(e.SM_KEY,r),[2]})})},e.SM_KEY="GE-SM",e}();var cb={},cE={};Object.defineProperty(cE,"__esModule",{value:!0}),cE.ZE=void 0,cE.ZE=function(){function e(){}return e.e=function(e,t){for(var n="",r=0;r<e.length;r++)n+=function(e){var n;return e>=32&&e<=126?String.fromCharCode((n=e+t)>126?32+(n-126):n):String.fromCharCode(e)}(e.charCodeAt(r));return n},e}();var cS={};Object.defineProperty(cS,"__esModule",{value:!0}),cS.nodeOS=function(){try{return n(668)}catch(e){}},Object.defineProperty(cb,"__esModule",{value:!0}),cb.Z=void 0,cb.Z=function(){function e(){}return e.initRNUniqueId=function(){if(w.FrameworkDetector.currentFramework()===w.Framework.REACT_NATIVE){var e=o.RNPlugins.platform,t=e.constants,n={os:e.OS};return"android"===n.os?n.f=t.Fingerprint:n.v=e.Version,JSON.stringify(n)}return null},e.initPlusDeviceId=function(){return new Promise(function(e,t){"undefined"!=typeof plus?plus.device.getInfo({success:function(t){e(t.uuid)},fail:function(e){t(e)}}):e(null)})},e.getVideoCard=function(){var e;if(em.PlatformDetector.currentPlatform()===em.PlatformType.BROWSER&&"undefined"!=typeof document){var t=document.createElement("canvas"),n=null!=(e=t.getContext("webgl"))?e:t.getContext("experimental-webgl");if(n&&"getExtension"in n){var r=0,i=0;if(navigator.userAgent.indexOf("Firefox")>-1)i=n.VENDOR,r=n.RENDERER;else{var s=n.getExtension("WEBGL_debug_renderer_info");if(!s)return null;i=s.UNMASKED_VENDOR_WEBGL,r=s.UNMASKED_RENDERER_WEBGL}return JSON.stringify({vendor:(n.getParameter(i)||"").toString(),renderer:(n.getParameter(r)||"").toString()})}}return null},e.z=function(){return es.__awaiter(this,void 0,void 0,function(){var e;return es.__generator(this,function(t){return e={p:em.PlatformDetector.currentPlatform(),f:w.FrameworkDetector.currentFramework(),vc:this.getVideoCard(),rfp:this.initRNUniqueId()},[2,cE.ZE.e(JSON.stringify(e),5)]})})},e}();var c_={};Object.defineProperty(c_,"__esModule",{value:!0}),c_.Emitter=void 0,c_.Emitter=function(){function e(e){this.rocketsBuffer=new Set,this.socket=e,this.socket.addConnectedObserver(this.onSocketConnected.bind(this))}return e.prototype.emit=function(e){this.socket.status!==ec.NetworkStatus.DISCONNECTED?(e.start(),this.doEmit(e)):e.fail({resultCode:"409",content:"Please connect first"})},e.prototype.doEmit=function(e){var t=this;if(!e.complete)if(this.socket.status!==ec.NetworkStatus.CONNECT_FAILED)if(this.isConnected())if(this.hasPermission(e)){var n=setTimeout(function(){t.doEmit(e)},e.singleTimeout);e.unique&&(e.params.retried=e.retried),this.socket.socketio().emit(e.name,e.params,function(t){clearTimeout(n),200===t.resultCode||200==t.code?e.success(t):e.fail(t)}),e.retried++}else e.fail({resultCode:401,content:"No permission"});else this.isConnecting()&&this.rocketsBuffer.add(e);else e.fail({resultCode:408,content:"Failed to connect GoEasy."})},e.prototype.hasPermission=function(e){return!!this.socket.permissions.find(function(t){return t===e.permission})},e.prototype.isConnected=function(){return[ec.NetworkStatus.CONNECTED,ec.NetworkStatus.RECONNECTED,ec.NetworkStatus.EXPIRED_RECONNECTED,ec.NetworkStatus.DISCONNECTING].includes(this.socket.status)},e.prototype.isConnecting=function(){return[ec.NetworkStatus.CONNECTING,ec.NetworkStatus.RECONNECTING].includes(this.socket.status)},e.prototype.onSocketConnected=function(){this.emitBuffer()},e.prototype.emitBuffer=function(){var e=this;Array.from(this.rocketsBuffer).forEach(function(t){e.rocketsBuffer.delete(t),e.doEmit(t)})},e}();var ck={};Object.defineProperty(ck,"__esModule",{value:!0}),ck.SEC=void 0,ck.SEC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.init=function(){t.i=new t},t.fire=function(e,t){this.i.fire(e,t)},t.on=function(e,t){this.i.on(e,t)},t.off=function(e,t){this.i.off(e,t)},t}(e8.AbstractEventCenter),Object.defineProperty(aU,"__esModule",{value:!0}),aU.default=function(e){function t(t,n){var r=e.call(this)||this;return r.ioSocket=null,r.sid=null,r.anonymous=!1,r.userId=null,r.artifactVersion=el.version,r.vname=null,r.uri=null,r.ioOpts=null,r.reconnectingTimes=0,r.messageObservers=new Map,r.connectFailedObservers=[],r.connectingObservers=[],r.expiredReconnectedObservers=[],r.options=t,r.ioSocket=new cr.default({onDisconnected:r.onIoDisconnected.bind(r),onReconnecting:r.onIoReconnecting.bind(r)}),r.ioSocketEmitter=new c_.Emitter(r.ioSocket),r.ioSocket.addConnectedObserver(r.onIoReconnected.bind(r)),r.initOptions(n),r.connect(),r}return es.__extends(t,e),t.prototype.initUserId=function(){var e=this.connectOptions.id;ev.default.isEmpty(e)?this.anonymous=!0:this.userId=e.toString()},t.prototype.socketio=function(){return this.ioSocket.socketio()},t.prototype.extendOptions=function(){var e=this.connectOptions;if(ev.default.isNull(e.data)||ev.default.isDef(e.data)&&!ev.default.isObject(e.data))throw{code:400,content:"TypeError: data requires an object."};if((ev.default.isDef(e.data)?String(e.data).length:0)>300&&ev.default.isObject(e)&&ev.default.isFunction(e.onFailed))throw{code:400,content:"user.data-length limit 300 byte."};if(ev.default.isObject(e.wxmpId)){if(ev.default.isEmpty(e.wxmpId.appid))throw{code:400,content:"wxmpId.appid is required."};if(ev.default.isEmpty(e.wxmpId.openid))throw{code:400,content:"wxmpId.openid is required. requires string."}}else if(ev.default.isPrimitive(e.wxmpId))throw{code:400,content:"TypeError: wxmpId requires an object."}},t.prototype.initUriAndOpts=function(){var e=this.options;u3.URIResolver.init(e.host,e.forceTLS,e.supportOldBrowser),this.uri=u3.URIResolver.uri();var t=["websocket"];!0===e.supportOldBrowser&&t.push("polling"),this.ioOpts={transports:t,timeout:eA.SocketTimeout.connect,reconnectionDelayMax:eA.SocketTimeout.reconnectionDelayMax}},t.prototype.onIoReconnected=function(){this.status===ec.NetworkStatus.RECONNECTING&&this.authorize()},t.prototype.sendAck=function(e,t){this.ioSocket.io.emit(e,t)},t.prototype.initOptions=function(e){this.connectOptions=e,this.addConnectedObserver(e.onSuccess),this.addConnectFailedObserver(e.onFailed),this.addConnectingObserver(e.onProgress),this.initUserId()},t.prototype.connect=function(){this.initUriAndOpts(),this.extendOptions(),e.prototype.connect.call(this),this.onConnecting(),this.ioSocket.connect({uri:this.uri,opts:this.ioOpts}),this.authorize()},t.prototype.disconnect=function(){var e=this;return new Promise(function(t,n){e.status=ec.NetworkStatus.DISCONNECTING;var r=function(){e.ioSocket.disconnect(),e.status=ec.NetworkStatus.DISCONNECTED,ck.SEC.fire(ow.SocketEvent.DISCONNECTED),t()},i=e8.GModules.modules.get("GN");if(i&&(i.params.regId||e.connectOptions.wxmpId)){var s=new e8.Rocket({name:ex.RocketTypes.manualDisconnect,params:{},permission:e8.Permission.READ,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,fail:function(e){n(e)},success:r});e8.G.Socket.e(s)}else r()})},t.prototype.authorize=function(){return es.__awaiter(this,void 0,void 0,function(){var e,t,n,r,i=this;return es.__generator(this,function(s){switch(s.label){case 0:return e=this.connectOptions,r={appkey:this.options.appkey,userId:this.userId,userData:JSON.stringify(e.data),otp:e.otp,artifactVersion:this.artifactVersion,sid:this.sid},[4,e8.GModules.getParams()];case 1:return r.mP=s.sent(),r.a=this.anonymous,[4,cb.Z.z()];case 2:return r.z=s.sent(),[4,ci.ServerMarkRepository.get()];case 3:return r.sm=s.sent(),r.c={n:this.vname,v:this.artifactVersion},JSON.stringify(t=r),n=new e8.Rocket({name:ex.RocketTypes.authorize,params:t,permission:e8.Permission.NONE,singleTimeout:eA.SocketTimeout.commonInfiniteSingle,totalTimeout:eA.SocketTimeout.commonInfiniteTotal,success:function(e){i.onAuthorizeSuccess(e)},fail:function(e){i.onAuthorizeFailed(e)}}),this.ioSocketEmitter.emit(n),[2]}})})},t.prototype.onConnecting=function(){ck.SEC.fire(ow.SocketEvent.CONNECTING,this.reconnectingTimes),this.notify(this.connectingObservers,this.reconnectingTimes)},t.prototype.onIoReconnecting=function(){this.reconnectingTimes++,this.status==ec.NetworkStatus.CONNECTED||this.status==ec.NetworkStatus.EXPIRED_RECONNECTED||this.status==ec.NetworkStatus.RECONNECTING?this.status=ec.NetworkStatus.RECONNECTING:this.status=ec.NetworkStatus.CONNECTING,this.onConnecting()},t.prototype.onIoDisconnected=function(){this.status!==ec.NetworkStatus.DISCONNECTING&&(this.status=ec.NetworkStatus.RECONNECTING,ck.SEC.fire(ow.SocketEvent.LOST),this.notify(this.disconnectedObservers))},t.prototype.onAuthorizeSuccess=function(e){(ci.ServerMarkRepository.put(e),e8.GModules.setDatas(e.mD),this.status===ec.NetworkStatus.RECONNECTING)?this.sid!==e.sid?(this.status=ec.NetworkStatus.EXPIRED_RECONNECTED,this.sid=e.sid,ck.SEC.fire(ow.SocketEvent.EXPIRED_RECONNECTED),this.notify(this.expiredReconnectedObservers)):(this.status=ec.NetworkStatus.RECONNECTED,ck.SEC.fire(ow.SocketEvent.RECONNECTED)):(this.status=ec.NetworkStatus.CONNECTED,this.sid=e.sid),e.enablePublish&&(this.permissions.find(function(e){return e==e8.Permission.WRITE})||this.permissions.push(e8.Permission.WRITE)),e.enableSubscribe&&(this.permissions.find(function(e){return e==e8.Permission.READ})||this.permissions.push(e8.Permission.READ)),this.reconnectingTimes=0,ck.SEC.fire(ow.SocketEvent.CONNECTED),this.notify(this.connectedObservers)},t.prototype.onAuthorizeFailed=function(e){this.ioSocket.disconnect(),this.status=ec.NetworkStatus.CONNECT_FAILED;var t={code:e.resultCode||408,content:e.content||"Host unreachable or timeout"};this.notify(this.connectFailedObservers,t)},t.prototype.addConnectingObserver=function(e){ev.default.isFunction(e)&&this.connectingObservers.push(e)},t.prototype.addConnectFailedObserver=function(e){ev.default.isFunction(e)&&this.connectFailedObservers.push(e)},t.prototype.addExpiredReconnectedObserver=function(e){ev.default.isFunction(e)&&this.expiredReconnectedObservers.push(e)},t.prototype.onMessage=function(e,t){this.ioSocket.io._callbacks.hasOwnProperty("$"+e)||this.ioSocket.io.on(e,t)},t.prototype.user=function(){var e=this.connectOptions;return e?{id:e.id,data:e.data}:null},t}(aB.default);var cC={};Object.defineProperty(cC,"__esModule",{value:!0}),cC.MessageListener=void 0,cC.MessageListener=function(){function e(e){this.guidList=[],this.socket=e}return e.prototype.offMessage=function(e,t){ck.SEC.off(ow.SocketEvent.NEW_MESSAGE+"_"+e,t)},e.prototype.onMessage=function(e,t){var n=this;ck.SEC.on(ow.SocketEvent.NEW_MESSAGE+"_"+e,t),this.socket.onMessage(e,function(t){n.fire(e,t)})},e.prototype.fire=function(e,t){var n=this.filter(t);n&&ck.SEC.fire(ow.SocketEvent.NEW_MESSAGE+"_"+e,n)},e.prototype.filter=function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.i){var t="".concat(e.i,"_").concat(e.r);if(this.guidList.findIndex(function(e){return e===t})>-1)return;this.guidList.unshift(t),this.guidList.length>300&&this.guidList.pop()}return e},e}(),Object.defineProperty(aj,"__esModule",{value:!0}),aj.GSocket=void 0,aj.GSocket=function(){function e(e){this.goeasyOptions=e}return e.init=function(t){this.i=new e(t)},e.connect=function(e,t){if(this.status()!==ec.NetworkStatus.DISCONNECTED&&ev.default.isObject(e)&&ev.default.isFunction(e.onFailed))e.onFailed({code:408,content:"It is already connected, don't try again until disconnect() is called. "});else{(0,ts.validateConnectOptions)(e),ck.SEC.init();var n=this.i;e8.GModules.preConnect(e),n.socket=new aU.default(n.goeasyOptions,e),n.socket.vname=t,n.emitter=new c_.Emitter(n.socket),n.messageListener=new cC.MessageListener(n.socket),e8.GModules.postConnect()}},e.e=function(e){this.i.emitter.emit(e)},e.sendAck=function(e,t){this.i.socket.sendAck(e,t)},e.status=function(){return this.i&&this.i.socket?this.i.socket.getStatus():ec.NetworkStatus.DISCONNECTED},e.on=function(e,t){ck.SEC.on(e,t)},e.off=function(e,t){ck.SEC.off(e,t)},e.offMessage=function(e,t){this.i.messageListener.offMessage(e,t)},e.onMessage=function(e,t){this.i.messageListener.onMessage(e,t)},e.disconnect=function(e){this.status()===ec.NetworkStatus.CONNECTED||this.status()===ec.NetworkStatus.RECONNECTED?this.i.socket.disconnect().then(function(){eO.CallbackUtils.onSuccess(e)}).catch(function(t){eO.CallbackUtils.onFailed(e,t)}):eO.CallbackUtils.onFailed(e,{code:408,content:"Host unreachable or timeout"})},e.user=function(){return this.i.socket.user()},e.EVENT=ow.SocketEvent,e}(),Object.defineProperty(aN,"__esModule",{value:!0}),aN.AgentStatus=void 0,aN.AgentStatus=function(){function e(){var e=this;this.synchronized=!0,this.onlineChanged=function(t){t.online?e.teamIds.add(t.teamId):e.teamIds.delete(t.teamId)},this.onDisconnected=function(){e.queryMyTeamPromise=null,e.teamIds=null},this.onConnected=function(){e.synchronized&&(e.queryMyTeamPromise=e.queryTeams())},aj.GSocket.on(aj.GSocket.EVENT.LOST,this.onDisconnected),aj.GSocket.on(aj.GSocket.EVENT.RECONNECTED,this.onConnected),aj.GSocket.onMessage(oC.RemoteEvents.CS_ONLINE_CHANGED,this.onlineChanged)}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.queryTeams=function(){var e=this;return this.queryMyTeamPromise||(this.queryMyTeamPromise=new Promise(function(t,n){var r=new e8.Rocket({name:ex.RocketTypes.CS_MY_TEAMS,params:{},permission:e8.Permission.READ,singleTimeout:eA.SocketTimeout.commonQuerySingle,totalTimeout:eA.SocketTimeout.commonQueryTotal,fail:function(e){n(e)},success:function(n){e.teamIds=new Set(n.content),e.synchronized=!0,t(e.teamIds)}});e8.G.Socket.e(r)})),this.queryMyTeamPromise},e.prototype.myTeams=function(){if(this.synchronized&&this.queryMyTeamPromise)return this.teamIds;throw"please query team first."},e.prototype.isOnline=function(e,t){return es.__awaiter(this,void 0,void 0,function(){return es.__generator(this,function(n){switch(n.label){case 0:return[4,this.queryTeams()];case 1:return n.sent(),eO.CallbackUtils.onSuccess(t,this.teamIds.has(e)),[2]}})})},e.prototype.online=function(e,t){var n=this;if(!ev.default.isObject(t.agentData)||!ev.default.isObject(t.teamData))throw{code:400,content:"agentData and teamData require an object"};var r=new aR.CSOnlineRequest(e,t.teamData,t.agentData),i=new e8.Rocket({name:ex.RocketTypes.CS_ONLINE,params:r,permission:e8.Permission.WRITE,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,fail:function(e){eO.CallbackUtils.onFailed(t,e)},success:function(r){n.teamIds.add(e),eO.CallbackUtils.onSuccess(t),ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.CS_ONLINE_SUCCESS)}});e8.G.Socket.e(i)},e.prototype.offline=function(e,t){var n=this,r=new aF.CSOfflineRequest(e),i=new e8.Rocket({name:ex.RocketTypes.CS_OFFLINE,params:r,permission:e8.Permission.WRITE,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,fail:function(e){eO.CallbackUtils.onFailed(t,e)},success:function(r){n.teamIds.delete(e),eO.CallbackUtils.onSuccess(t),ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.CS_OFFLINE_SUCCESS)}});e8.G.Socket.e(i)},e.prototype.agents=function(e,t){var n=new aG.CsAgentsQueryRequest(e),r=new e8.Rocket({name:ex.RocketTypes.CS_AGENTS,params:n,permission:e8.Permission.READ,singleTimeout:eA.SocketTimeout.commonQuerySingle,totalTimeout:eA.SocketTimeout.commonQueryTotal,fail:function(e){eO.CallbackUtils.onFailed(t,e)},success:function(e){e.content.forEach(function(e){e.data=JSON.parse(e.data)}),eO.CallbackUtils.onSuccess(t,e)}});e8.G.Socket.e(r)},e}(),Object.defineProperty(aP,"__esModule",{value:!0}),aP.LiveSession=void 0,aP.LiveSession=function(){function e(t){this.onMessageReceived=function(t){var n=e.session;if(t.scene()===el.Scene.CS&&n.liveOptions){var r=n.liveOptions.customerId;n.teamId===t.teamId&&t.customerId()===r&&(n.tryUpdateStatus(t),n.liveOptions.onNewMessage(t))}},this.teamId=t,ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.CS_AGENT_MESSAGE_RECEIVED,this.onMessageReceived),ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.CS_ACCEPTED,this.onMessageReceived),ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.CS_ENDED,this.onMessageReceived),ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.CS_TRANSFER,this.onMessageReceived),aj.GSocket.on(ow.SocketEvent.DISCONNECTED,e.destroy)}return e.live=function(t,n){return es.__awaiter(this,void 0,void 0,function(){var r,i,s,o=this;return es.__generator(this,function(a){switch(a.label){case 0:return r=n.customerId,(0,ts.validateCustomId)(r),i=new aA.LiveSessionRequest(t,r),[4,aN.AgentStatus.getInstance().queryTeams()];case 1:return a.sent(),s=new e8.Rocket({name:ex.RocketTypes.CS_LIVE_SESSION,params:i,permission:e8.Permission.WRITE,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,fail:function(e){eO.CallbackUtils.onFailed(n,e)},success:function(r){e.destroy(),o.session=new e(t),o.session.liveOptions=n;var i=r.content.customerStatus;"ACCEPTED"===i.status&&(i.agent.data=JSON.parse(i.agent.data)),o.session.status=i,o.session.liveOptions.onStatusUpdated(o.session.status),eO.CallbackUtils.onSuccess(n)}}),e8.G.Socket.e(s),[2]}})})},e.prototype.customerId=function(){return this.liveOptions.customerId},e.isMyCustomer=function(t){var n=e.session;if(n&&n.teamId===t.teamId&&n.customerId()===t.customerId()){var r=aN.AgentStatus.getInstance().myTeams(),i=n.status.agent;return r.has(t.teamId)&&(!i||i.id===e8.G.Socket.user().id)}return!0},e.isMyMessage=function(e){var t=sW.Target.byIMMessage(e);return e.type===aE.CSMessageType.TRANSFER&&e.payload.transferTo.id===e8.G.Socket.user().id||this.isMyCustomer(t)},e.quit=function(t){var n=e.session;if(n){var r=n.liveOptions.customerId;(0,ts.validateCustomId)(r);var i=new aA.LiveSessionRequest(n.teamId,r),s=new e8.Rocket({name:ex.RocketTypes.CS_QUIT_LIVE,params:i,permission:e8.Permission.WRITE,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,fail:function(e){eO.CallbackUtils.onFailed(t,e)},success:function(n){e.destroy(),eO.CallbackUtils.onSuccess(t)}});e8.G.Socket.e(s)}},e.prototype.tryUpdateStatus=function(e){if(!("FREE"!==this.status.status&&this.status.sessionId>e.sessionId)){var t;switch(e.type){case aE.CSMessageType.ACCEPT:(t=new aO.CustomerStatus).status="ACCEPTED",t.start=e.payload.sessionStart,t.sessionId=e.sessionId,t.agent=new el.User(e.senderId,e.senderData);break;case aE.CSMessageType.END:(t=new aO.CustomerStatus).status="FREE";break;case aE.CSMessageType.TRANSFER:(t=new aO.CustomerStatus).status="ACCEPTED",t.start=e.payload.sessionStart,t.sessionId=e.sessionId,t.agent=e.payload.transferTo;break;default:"FREE"===this.status.status&&((t=new aO.CustomerStatus).status="PENDING",t.start=e.timestamp,t.sessionId=e.sessionId)}t&&(this.status=t,this.liveOptions.onStatusUpdated(t))}},e.destroy=function(){var t=e.session;t&&(ar.IMEC.i.off(o9.IM_INTERNAL_EVENTS.CS_AGENT_MESSAGE_RECEIVED,t.onMessageReceived),ar.IMEC.i.off(o9.IM_INTERNAL_EVENTS.CS_ACCEPTED,t.onMessageReceived),ar.IMEC.i.off(o9.IM_INTERNAL_EVENTS.CS_ENDED,t.onMessageReceived),ar.IMEC.i.off(o9.IM_INTERNAL_EVENTS.CS_TRANSFER,t.onMessageReceived),aj.GSocket.off(ow.SocketEvent.DISCONNECTED,e.destroy),e.session=null)},e}(),Object.defineProperty(aT,"__esModule",{value:!0}),aT.default=function(e){function t(t){var n=e.call(this,t)||this;return n.unread=0,n.markingAmount=0,n}return es.__extends(t,e),t.prototype.loadHistory=function(e,t){return es.__awaiter(this,void 0,void 0,function(){return es.__generator(this,function(n){switch(n.label){case 0:return ev.default.isUndef(t)?t=10:t>30&&(t=30),[4,this.loadServerMessages(e,t)];case 1:return[2,n.sent()]}})})},t.prototype.loadServerMessages=function(e,t){return es.__awaiter(this,void 0,void 0,function(){var n,r,i=this;return es.__generator(this,function(s){switch(s.label){case 0:return n=new a_.default(this.target.id.toString(),this.target.scene,e,t,this.target.teamId),[4,this.remoteHistory.loadServerMessages(this.target,n)];case 1:return(r=s.sent()).userOffsets.forEach(function(e){i.userOffsets.updateOffset(e.userId,e.offset)}),[2,r.messages]}})})},t.prototype.deleteMessages=function(e){return es.__awaiter(this,void 0,void 0,function(){return es.__generator(this,function(t){return eO.CallbackUtils.onFailed(e,"Delete CS message is not supported yet"),[2]})})},t.prototype.initMaxMessageAndOffsets=function(e,t){var n=this;t.forEach(function(e){n.userOffsets.updateOffset(e.userId,e.offset)}),(ev.default.isUndef(this.acceptedMaxMessage)||this.acceptedMaxMessage.timestamp<e.timestamp)&&this.increaseUnreadAmount(e),this.saveAcceptedMessage(e)},t.prototype.initPendingMaxMessageAndOffsets=function(e,t){var n=this;t.forEach(function(e){n.userOffsets.updateOffset(e.userId,e.offset)}),this.savePendingMessage(e)},t.prototype.savePendingMessage=function(e){this.pendingMaxMessage?this.pendingMaxMessage.timestamp<e.timestamp&&(this.pendingMaxMessage=e):this.pendingMaxMessage=e},t.prototype.saveAcceptedMessage=function(e){this.acceptedMaxMessage?this.acceptedMaxMessage.timestamp<e.timestamp&&(this.acceptedMaxMessage=e):this.acceptedMaxMessage=e},t.prototype.onMessageSending=function(e){this.saveAcceptedMessage(e),ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.MAX_MESSAGE_CHANGED,{message:e,receiver:this.to})},t.prototype.onMessageSendSuccess=function(e){this.saveAcceptedMessage(e),this.userOffsets.updateOffset(e.senderId,e.timestamp),this.acceptedMaxMessage===e&&ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.MAX_MESSAGE_CHANGED,{message:e,receiver:this.to})},t.prototype.onMessageSendFailed=function(e){this.acceptedMaxMessage===e&&ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.MAX_MESSAGE_CHANGED,{message:e,receiver:this.to})},t.prototype.onMessageReceived=function(e){aP.LiveSession.isMyMessage(e)&&(e.accepted&&(e.senderId===e8.G.Socket.user().id||e.type!==aE.CSMessageType.ACCEPT)?this.saveAcceptedMessage(e):this.savePendingMessage(e),this.userOffsets.updateOffset(e.senderId,e.timestamp),this.increaseUnreadAmount(e),ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.MAX_MESSAGE_CHANGED,{message:e,receiver:this.to}))},t.prototype.increaseUnreadAmount=function(e){(e.sendByCustomer()||e.type===aE.CSMessageType.TRANSFER&&e.senderId!==e8.G.Socket.user().id)&&this.userOffsets.myOffset()<e.timestamp&&e.accepted&&(this.unread+=1)},t.prototype.markRead=function(){return es.__awaiter(this,void 0,void 0,function(){var e;return es.__generator(this,function(t){switch(t.label){case 0:return e=this.maxAcceptedMessageTime(),aP.LiveSession.isMyCustomer(this.target)&&this.preMark(e)?[4,this.remoteHistory.updateServerOffsets(e,this.target)]:[3,2];case 1:t.sent(),this.postMark(e),t.label=2;case 2:return[2]}})})},t.prototype.preMark=function(e){var t=this.userOffsets.myOffset();return e>this.userOffsets.markingTime&&e>t&&(this.userOffsets.markingTime=e,this.markingAmount=this.unread,!0)},t.prototype.postMark=function(e){e===this.userOffsets.markingTime&&(this.unread-=this.markingAmount,this.markingAmount=0,this.userOffsets.updateOffset(e8.G.Socket.user().id,e),ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.UNREAD_AMOUNT_CHANGED,this.target))},t.prototype.syncMarkedMessage=function(e){},t.prototype.getMaxMessage=function(e){return e?this.acceptedMaxMessage:this.pendingMaxMessage},t.prototype.unreadAmount=function(e){return e?this.unread:0},t.prototype.existsMessage=function(e){return this.acceptedMaxMessage&&this.acceptedMaxMessage.messageId===e.messageId||this.pendingMaxMessage&&this.pendingMaxMessage.messageId===e.messageId},t.prototype.maxAcceptedMessageTime=function(){return this.acceptedMaxMessage?this.acceptedMaxMessage.timestamp:0},t.prototype.maxTime=function(e){var t=this.getMaxMessage(e);return t?t.timestamp:0},t}(ac.default);var cM={};Object.defineProperty(cM,"__esModule",{value:!0}),cM.default=function(e){function t(t){return e.call(this,t)||this}return es.__extends(t,e),t.prototype.deleteMessages=function(e){return es.__awaiter(this,void 0,void 0,function(){return es.__generator(this,function(t){return eO.CallbackUtils.onFailed(e,"Delete CS message is not supported yet"),[2]})})},t}(ac.default),Object.defineProperty(au,"__esModule",{value:!0}),au.default=function(){function e(){var e=this;this.map=new Map,this.onMessageSending=function(t){var n=sW.Target.byIMMessage(t.message),r=e.findOrCreateHistory(n);r.to=t.receiver,r.onMessageSending(t.message)},this.onMessageSendSuccess=function(t){var n=sW.Target.byIMMessage(t);e.findHistory(n).onMessageSendSuccess(t)},this.onMessageSendFailed=function(t){var n=sW.Target.byIMMessage(t);e.findHistory(n).onMessageSendFailed(t)},this.onMessageReceived=function(t){var n=sW.Target.byIMMessage(t),r=e.findOrCreateHistory(n);r.expiredTime>0&&(e.map.delete(n.toString()),r=e.findOrCreateHistory(n)),r.onMessageReceived(t)},this.onRemoteMarkRead=function(t){var n=sW.Target.byMessageReadRemoteEvent(t),r=e.findHistory(n);r&&r.syncMarkedMessage(t)},this.onRemoteMessageDeleted=function(t){var n=sW.Target.byIMMessageDeletedEvent(t),r=e.findHistory(n);r&&r.syncDeletedMessage(t.deleterId,t.times)},this.onMessageRecalled=function(t){var n=sW.Target.byConversationId(t.scene,t.conversationId),r=e.findHistory(n);r&&r.recallMessages(t)},this.onDisconnected=function(){e.map.forEach(function(e,t){e.expire()})},this.onReconnected=function(){aM.AEC.fire(aI.ImApiEvents.HISTORY_EXPIRED)},this.destroy=function(){},this.initialListeners()}return e.init=function(){return e.instance=new e,e.instance},e.prototype.initialListeners=function(){ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.MESSAGE_SENDING,this.onMessageSending),ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.MESSAGE_SEND_SUCCESS,this.onMessageSendSuccess),ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.MESSAGE_SEND_FAILED,this.onMessageSendFailed),ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.MESSAGE_RECEIVED,this.onMessageReceived),ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.CS_AGENT_MESSAGE_RECEIVED,this.onMessageReceived),ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.CS_ACCEPTED,this.onMessageReceived),ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.CS_ENDED,this.onMessageReceived),ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.CS_TRANSFER,this.onMessageReceived),ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.MESSAGE_RECALLED,this.onMessageRecalled),aj.GSocket.onMessage(oC.RemoteEvents.IM_MSG_READ,this.onRemoteMarkRead),aj.GSocket.onMessage(oC.RemoteEvents.IM_MSG_DELETED,this.onRemoteMessageDeleted),aj.GSocket.on(aj.GSocket.EVENT.LOST,this.onDisconnected),aj.GSocket.on(aj.GSocket.EVENT.RECONNECTED,this.onReconnected)},e.prototype.loadHistory=function(e,t){return es.__awaiter(this,void 0,void 0,function(){var n,r,i;return es.__generator(this,function(s){switch(s.label){case 0:return(0,ts.validateHistoryQuery)(e),n=this.queryToTarget(e,t),(r=this.findOrCreateHistory(n)).expiredTime>0&&(this.map.delete(n.toString()),r=this.findOrCreateHistory(n)),[4,r.loadHistory(e.lastTimestamp,e.limit)];case 1:return i=s.sent(),eO.CallbackUtils.onSuccess(e,{code:200,content:i}),[2]}})})},e.prototype.queryToTarget=function(e,t){return e.userId?new sW.Target(el.Scene.PRIVATE,e.userId):e.groupId?new sW.Target(el.Scene.GROUP,e.groupId):(el.Scene.CS===e.type&&ev.default.isUndef(t)&&(t=e.id),new sW.Target(e.type,e.id,t))},e.prototype.privateMarkAsRead=function(e){return es.__awaiter(this,void 0,void 0,function(){var t;return es.__generator(this,function(n){switch(n.label){case 0:return(0,ts.validateUserId)(e),t=sW.Target.byScene(el.Scene.PRIVATE,e.userId),[4,this.markAsRead(t,e)];case 1:return n.sent(),[2]}})})},e.prototype.groupMarkAsRead=function(e){return es.__awaiter(this,void 0,void 0,function(){var t;return es.__generator(this,function(n){switch(n.label){case 0:return(0,ts.validateGroupId)(e),t=sW.Target.byScene(el.Scene.GROUP,e.groupId),[4,this.markAsRead(t,e)];case 1:return n.sent(),[2]}})})},e.prototype.markMessageAsRead=function(e,t){return es.__awaiter(this,void 0,void 0,function(){var n;return es.__generator(this,function(r){switch(r.label){case 0:return(0,ts.validateIdType)(e),el.Scene.CS==e.type&&ev.default.isUndef(t)&&(t=e.id),n=sW.Target.byScene(e.type,e.id,t),[4,this.markAsRead(n,e)];case 1:return r.sent(),[2]}})})},e.prototype.markAsRead=function(e,t){return es.__awaiter(this,void 0,void 0,function(){var n;return es.__generator(this,function(r){switch(r.label){case 0:return(n=this.findHistory(e))?[4,n.markRead()]:[3,2];case 1:r.sent(),r.label=2;case 2:return eO.CallbackUtils.onSuccess(t),[2]}})})},e.prototype.deleteMessage=function(e){return es.__awaiter(this,void 0,void 0,function(){var t,n,r;return es.__generator(this,function(i){switch(i.label){case 0:return(0,ts.validateDeleteMessage)(e),t=e.messages[0],n=sW.Target.byIMMessage(t),(r=this.findHistory(n))?[4,r.deleteMessages(e)]:[3,2];case 1:return i.sent(),[3,3];case 2:throw{code:400,content:"No message that could be deleted"};case 3:return[2]}})})},e.prototype.findOrCreateHistory=function(e){var t=this.findHistory(e);return t||(t=e.scene===el.Scene.CS?e8.G.Socket.user().id===e.customerId()?new cM.default(e):new aT.default(e):new ac.default(e),this.map.set(e.toString(),t),t)},e.get=function(t){return e.instance.findOrCreateHistory(t)},e.prototype.findHistory=function(e){return this.map.get(e.toString())},e}(),Object.defineProperty(aa,"__esModule",{value:!0}),aa.Conversation=void 0,aa.Conversation=function(){function e(e){this.top=!1,this.data=null,this.dataLoaded=!1,this.target=e}return e.prototype.toDto=function(){var e=this.target.scene,t=this.target.id,n=new el.ConversationDTO;return e===el.Scene.PRIVATE?n.userId=t:e===el.Scene.GROUP?n.groupId=t:e===el.Scene.CS&&(n.id=this.target.teamId),n.type=e,n.lastMessage=this.getMaxMessage(),n.unread=this.getUnreadAmount(),n.top=this.top,n.data=this.data,n},e.prototype.getMaxMessage=function(){return au.default.get(this.target).getMaxMessage()},e.prototype.getUnreadAmount=function(){return au.default.get(this.target).unreadAmount()},e.prototype.maxMessageTime=function(){return au.default.get(this.target).maxTime()},e}();var cD={};Object.defineProperty(cD,"__esModule",{value:!0}),cD.CSConversation=void 0,cD.CSConversation=function(e){function t(t){var n=e.call(this,t)||this;return n.accepted=!1,n}return es.__extends(t,e),t.prototype.toDto=function(){var e=new el.ConversationDTO,t=this.target.scene,n=this.target.id,r=this.target.teamId;return e.id=n,e.teamId=r,e.type=t,e.lastMessage=this.getMaxMessage(),e.unread=this.getUnreadAmount(),e.top=this.top,e.data=this.data,e.ended=this.isEnded(),e},t.prototype.isEnded=function(){var e=this.getMaxMessage(),t=e.type,n=e.payload;return t===aE.CSMessageType.END||t===aE.CSMessageType.TRANSFER&&n.transferTo.id!==e8.G.Socket.user().id},t.prototype.getMaxMessage=function(){return au.default.get(this.target).getMaxMessage(this.accepted)},t.prototype.getUnreadAmount=function(){return au.default.get(this.target).unreadAmount(this.accepted)},t.prototype.maxMessageTime=function(){return au.default.get(this.target).maxTime(this.accepted)},t}(aa.Conversation);var cw={},cI={};Object.defineProperty(cI,"__esModule",{value:!0}),cI.default=function(e,t,n,r){this.type=e,this.top=t,this.targetId=n,this.teamId=r};var cx={};Object.defineProperty(cx,"__esModule",{value:!0}),cx.default=function(e,t,n){this.type=e,this.targetId=t,this.teamId=n};var cT={};Object.defineProperty(cT,"__esModule",{value:!0}),cT.default=function(e,t,n){this.type=e,this.targetId=t,this.teamId=n},Object.defineProperty(cw,"__esModule",{value:!0}),cw.default=function(){function e(){}return e.prototype.top=function(e,t){var n=new cI.default(e.scene,t,e.id,e.teamId);return new Promise(function(e,t){var r=new e8.Rocket({name:ex.RocketTypes.topConversation,params:n,permission:e8.Permission.WRITE,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,success:function(n){200===n.code?e(n):t(n)},fail:function(e){t(e)}});e8.G.Socket.e(r)})},e.prototype.remove=function(e){var t=new cx.default(e.scene,e.id,e.teamId);return new Promise(function(e,n){var r=new e8.Rocket({name:ex.RocketTypes.removeConversation,params:t,permission:e8.Permission.WRITE,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,success:function(t){200==t.code?e(t):n(t)},fail:function(e){n(e)}});e8.G.Socket.e(r)})},e.prototype.query=function(e){var t=this;return new Promise(function(n,r){var i=new e8.Rocket({name:e,params:{},permission:e8.Permission.READ,singleTimeout:eA.SocketTimeout.commonQuerySingle,totalTimeout:eA.SocketTimeout.commonQueryTotal,fail:function(e){r(e)},success:function(e){return es.__awaiter(t,void 0,void 0,function(){return es.__generator(this,function(t){return n(e),[2]})})}});e8.G.Socket.e(i)})},e.prototype.loadData=function(e){var t=new cT.default(e.scene,e.id,e.teamId);return new Promise(function(e,n){var r=new e8.Rocket({name:ex.RocketTypes.imData,params:t,permission:e8.Permission.READ,singleTimeout:eA.SocketTimeout.commonQuerySingle,totalTimeout:eA.SocketTimeout.commonQueryTotal,success:function(t){e(JSON.parse(t.content))},fail:function(e){n(e)}});e8.G.Socket.e(r)})},e.instance=new e,e}(),Object.defineProperty(ao,"__esModule",{value:!0}),ao.Conversations=void 0,ao.Conversations=function(){function e(){this.list=[],this.builder=new ab.RemoteAbbrMessageBuilder,this.remoteConversations=cw.default.instance,this.synchronized=!1,ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.MAX_MESSAGE_CHANGED,this.onMaxMessageChanged.bind(this)),ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.UNREAD_AMOUNT_CHANGED,this.onUnreadMessageChanged.bind(this)),ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.MAX_MESSAGE_DELETED,this.onMaxMessageDeleted.bind(this))}return e.prototype.onUnreadMessageChanged=function(e){this.findConversation(e)&&this.fireUpdated()},e.prototype.fireUpdated=function(){this.debounce(this.triggerUpdate.bind(this))},e.prototype.triggerUpdate=function(){var e=this.loadLocalConversations(),t=this.getUpdatedEventName();aM.AEC.fire(t,{unreadTotal:e.content.unreadTotal,conversations:e.content.conversations})},e.prototype.getUpdatedEventName=function(){return aI.ImApiEvents.CONVERSATIONS_UPDATED},e.prototype.latestConversations=function(e){return es.__awaiter(this,void 0,void 0,function(){var t;return es.__generator(this,function(n){switch(n.label){case 0:return this.synchronized?[3,2]:[4,this.loadServerConversations()];case 1:n.sent(),n.label=2;case 2:return t=this.loadLocalConversations(),eO.CallbackUtils.onSuccess(e,t),[2]}})})},e.prototype.loadServerConversations=function(){return es.__awaiter(this,void 0,void 0,function(){var e,t,n,r,i;return es.__generator(this,function(s){switch(s.label){case 0:return e=this.rocketName(),[4,this.remoteConversations.query(e)];case 1:return t=s.sent(),this.convertAbbrConversation(t.content),n=null==(i=null==(r=t.content[t.content.length-1])?void 0:r.lmsg)?void 0:i.i,[4,this.loadCustomConversation(n)];case 2:return s.sent(),this.synchronized=!0,[2]}})})},e.prototype.loadCustomConversation=function(e){return es.__awaiter(this,void 0,void 0,function(){var t,n,r,i,s,o,a,u,c;return es.__generator(this,function(l){switch(l.label){case 0:return void 0===ax.IMCustomProvider.instance?[3,2]:[4,ax.IMCustomProvider.instance.loadConversations(e8.G.Socket.user().id,e)];case 1:t=l.sent();try{for(r=(n=es.__values(t)).next();!r.done;r=n.next())(i=r.value).lastMessage=ax.IMCustomProvider.convertAbstractMessage(i.lastMessage),s=i.lastMessage,o=sW.Target.byIMMessage(s),a=this.findConversation(o),ev.default.isUndef(a)&&((a=new aa.Conversation(o)).dataLoaded=!0,a.top=i.top,a.data=i.data,this.insertOne(a)),au.default.get(o).initMaxMessageAndOffsets(s,[]),this.correctPosition(a)}catch(e){u={error:e}}finally{try{r&&!r.done&&(c=n.return)&&c.call(n)}finally{if(u)throw u.error}}l.label=2;case 2:return[2]}})})},e.prototype.rocketName=function(){return ex.RocketTypes.imLastConversations},e.prototype.convertAbbrConversation=function(e){var t,n;try{for(var r=es.__values(e),i=r.next();!i.done;i=r.next()){var s=i.value,o=s.t,a=s.top,u=s.d?JSON.parse(s.d):{},c=s.userOffsets;s.lmsg.t=o;var l=s.lmsg,p=this.builder.build(l),f=sW.Target.byIMMessage(p),d=this.findConversation(f);ev.default.isUndef(d)?(d=this.buildByAbbr(s,p),this.insertOne(d)):(d.top=a,d.data=u),f.scene===el.Scene.GROUP&&(p.x=1),au.default.get(f).initMaxMessageAndOffsets(p,c),this.correctPosition(d)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.onMaxMessageDeleted=function(e){this.removeConversation(e)},e.prototype.onMaxMessageChanged=function(e){return es.__awaiter(this,void 0,void 0,function(){var t,n;return es.__generator(this,function(r){switch(r.label){case 0:return(t=e.message).scene()===el.Scene.CS&&(n=t,e8.G.Socket.user().id!=n.customerId()&&(!1===n.accepted||n.type===aE.CSMessageType.ACCEPT&&n.senderId!=e8.G.Socket.user().id))?[2]:[4,this.saveOrUpdateConversation(e)];case 1:return r.sent(),[2]}})})},e.prototype.saveOrUpdateConversation=function(e){return es.__awaiter(this,void 0,void 0,function(){var t,n,r,i,s;return es.__generator(this,function(o){switch(o.label){case 0:return n=(t=e.message).status,r=sW.Target.byIMMessage(t),i=this.findConversation(r),ev.default.isUndef(i)&&n!==el.MessageStatus.FAIL?(i=this.buildByMessage(t),this.insertOne(i),n!==el.MessageStatus.SUCCESS?[3,2]:(s=i,[4,this.remoteConversations.loadData(r)])):[3,2];case 1:s.data=o.sent(),i.dataLoaded=!0,o.label=2;case 2:return n===el.MessageStatus.SENDING&&(i.data=e.receiver,i.dataLoaded=!0),i&&i.dataLoaded&&(this.correctPosition(i),this.fireUpdated()),[2]}})})},e.prototype.debounce=function(e){clearTimeout(this.timer),this.timer=setTimeout(function(){e()},500)},e.prototype.loadLocalConversations=function(){var e,t,n=0,r=[];try{for(var i=es.__values(this.list),s=i.next();!s.done;s=i.next()){var o=s.value;if(o.dataLoaded&&o.getMaxMessage()){n+=o.getUnreadAmount();var a=o.toDto();r.push(a)}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return{code:200,content:{unreadTotal:n,conversations:r}}},e.prototype.findConversationIndex=function(e){return this.list.findIndex(function(t){return e.toString()===t.target.toString()})},e.prototype.findConversation=function(e){var t=this.findConversationIndex(e);return this.list[t]},e.prototype.removeLocalConversation=function(e){var t=this.findConversationIndex(e.target);this.list.splice(t,1)},e.prototype.insertOne=function(t){e.sortedInserter.insert(this.list,t)},e.prototype.correctPosition=function(e){this.removeLocalConversation(e),this.insertOne(e)},e.prototype.removeConversation=function(e){var t=this.findConversation(e);t&&(this.removeLocalConversation(t),this.fireUpdated())},e.prototype.top=function(e,t,n){return es.__awaiter(this,void 0,void 0,function(){var r;return es.__generator(this,function(i){switch(i.label){case 0:if(!ev.default.isBoolean(t))throw Error("top must be boolean.");if(!(r=this.findConversation(e)))throw Error("conversation does not exist.");return r.top==t?[3,2]:[4,this.remoteConversations.top(e,t)];case 1:i.sent(),r.top=t,this.correctPosition(r),i.label=2;case 2:return this.fireUpdated(),eO.CallbackUtils.onSuccess(n),[2]}})})},e.prototype.remove=function(e,t){return es.__awaiter(this,void 0,void 0,function(){var n;return es.__generator(this,function(r){switch(r.label){case 0:if(!(n=this.findConversation(e)))throw Error("conversation does not exist.");if(n instanceof cD.CSConversation&&!n.isEnded())throw Error("CS conversation can only be deleted after it ends");return[4,this.remoteConversations.remove(e)];case 1:return r.sent(),this.removeLocalConversation(n),this.fireUpdated(),eO.CallbackUtils.onSuccess(t),[2]}})})},e.prototype.buildByAbbr=function(e,t){var n,r=sW.Target.byIMMessage(t);return e.t===el.Scene.CS?e8.G.Socket.user().id===t.customerId()?n=new aa.Conversation(r):(n=new cD.CSConversation(r)).accepted=t.accepted:n=new aa.Conversation(r),n.dataLoaded=!0,n.top=e.top,n.data=e.d?JSON.parse(e.d):{},n},e.prototype.buildByMessage=function(e){var t,n=sW.Target.byIMMessage(e);return e.scene()===el.Scene.CS?e8.G.Socket.user().id===e.customerId()?t=new aa.Conversation(n):(t=new cD.CSConversation(n)).accepted=e.accepted:t=new aa.Conversation(n),t},e.sortedInserter=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.compare=function(e,t){if(e.target.scene===t.target.scene&&e.target.id===t.target.id)return 0;if(e.top==t.top){var n,r=e.maxMessageTime();n=t.maxMessageTime()-r}else n=e.top?-1:1;return n>0?1:-1},t}(ap.SortedInserter)),e}();var cP={},cA={};Object.defineProperty(cA,"__esModule",{value:!0}),cA.GIMModule=void 0,cA.GIMModule=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.init=function(){return this.module=new t,this.module.name=this.GIM_MODULE_NAME,this.initGN(),this.module},t.initGN=function(){ey.GN.addAssembler(new(function(){function e(){}return e.prototype.assemble=function(e){var t={messageId:e.id,timestamp:e.tm,type:e.t,senderId:e.sid,toType:e.tt};return e.tt===el.Scene.GROUP&&(t.groupId=e.gid),t},e.prototype.support=function(e){return!!e.sid},e}()))},t.prototype.postConnect=function(){oN.IM.init()},t.check=function(){if(!this.module)throw{code:400,content:"IM not initialized. Please include 'IM' in the 'modules' during GoEasy initialization."}},t.GIM_MODULE_NAME="GIM",t}(e8.GModule),Object.defineProperty(cP,"__esModule",{value:!0}),cP.PendingConversations=void 0,cP.PendingConversations=function(e){function t(){var t=e.call(this)||this;return t.expired=!1,ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.CS_ONLINE_SUCCESS,t.onCSOnlineSuccess.bind(t)),ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.CS_OFFLINE_SUCCESS,t.onCSOfflineSuccess.bind(t)),aj.GSocket.on(aj.GSocket.EVENT.LOST,t.onDisconnected.bind(t)),aj.GSocket.on(aj.GSocket.EVENT.RECONNECTED,t.onConnected.bind(t)),t}return es.__extends(t,e),t.prototype.onMaxMessageChanged=function(e){return es.__awaiter(this,void 0,void 0,function(){var t,n,r;return es.__generator(this,function(i){switch(i.label){case 0:return(t=e.message).scene()!==el.Scene.CS||(n=t).customerId()==e8.G.Socket.user().id||!1!==n.accepted&&n.type!==aE.CSMessageType.ACCEPT?[3,3]:aE.CSMessageType.ACCEPT!==t.type?[3,1]:(r=sW.Target.byIMMessage(t),this.removeConversation(r),[3,3]);case 1:return[4,this.saveOrUpdateConversation(e)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},t.prototype.latestConversations=function(t){return es.__awaiter(this,void 0,void 0,function(){var n;return es.__generator(this,function(r){switch(r.label){case 0:return n=this.synchronized,[4,e.prototype.latestConversations.call(this,t)];case 1:return r.sent(),this.list.length>0&&!n&&this.fireUpdated(),[2]}})})},t.prototype.onUnreadMessageChanged=function(e){},t.prototype.onCSOnlineSuccess=function(){return es.__awaiter(this,void 0,void 0,function(){return es.__generator(this,function(e){switch(e.label){case 0:return[4,this.loadServerConversations()];case 1:return e.sent(),this.fireUpdated(),[2]}})})},t.prototype.onCSOfflineSuccess=function(){this.list=[],this.fireUpdated()},t.prototype.getUpdatedEventName=function(){return aI.ImApiEvents.PENDING_CONVERSATIONS_UPDATED},t.prototype.rocketName=function(){return ex.RocketTypes.CS_PENDING_CONVERSATION},t.prototype.convertAbbrConversation=function(e){return es.__awaiter(this,void 0,void 0,function(){var t,n,r,i,s,o,a,u,c,l,p,f,d;return es.__generator(this,function(h){t=e;try{for(r=(n=es.__values(t)).next();!r.done;r=n.next())(i=r.value).lastMessage.t=el.Scene.CS,s=i.customerData,o=i.lastMessage,a=i.userOffsets,u=s?JSON.parse(s):{},c=this.builder.build(o),l=sW.Target.byIMMessage(c),p=this.findConversation(l),ev.default.isUndef(p)&&((p=new cD.CSConversation(l)).accepted=c.accepted,p.dataLoaded=!0,this.insertOne(p)),p.top=!1,p.data=u,au.default.get(l).initPendingMaxMessageAndOffsets(c,a),this.correctPosition(p)}catch(e){f={error:e}}finally{try{r&&!r.done&&(d=n.return)&&d.call(n)}finally{if(f)throw f.error}}return[2]})})},t.prototype.onDisconnected=function(){this.expired=!0},t.prototype.onConnected=function(){return es.__awaiter(this,void 0,void 0,function(){return es.__generator(this,function(e){switch(e.label){case 0:return this.expired&&cA.GIMModule.module&&cA.GIMModule.module.active?(this.expired=!1,this.list=[],[4,this.loadServerConversations()]):[3,2];case 1:e.sent(),this.fireUpdated(),e.label=2;case 2:return[2]}})})},t}(ao.Conversations),Object.defineProperty(as,"__esModule",{value:!0}),as.default=function(){function e(){this.conversations=new ao.Conversations,this.pendingConversations=new cP.PendingConversations}return e.prototype.latestConversations=function(e){this.conversations.latestConversations(e)},e.prototype.latestPendingConversations=function(e){this.pendingConversations.latestConversations(e)},e.prototype.topPrivateConversation=function(e){var t=sW.Target.byScene(el.Scene.PRIVATE,e.userId);this.conversations.top(t,e.top,e)},e.prototype.topGroupConversation=function(e){var t=sW.Target.byScene(el.Scene.GROUP,e.groupId);this.conversations.top(t,e.top,e)},e.prototype.topConversation=function(e){var t=e.conversation;this.validateConversationDTO(t);var n=sW.Target.byConversationDTO(t);this.conversations.top(n,e.top,e)},e.prototype.removePrivateConversation=function(e){var t=sW.Target.byScene(el.Scene.PRIVATE,e.userId);this.conversations.remove(t,e)},e.prototype.removeGroupConversation=function(e){var t=sW.Target.byScene(el.Scene.GROUP,e.groupId);this.conversations.remove(t,e)},e.prototype.removeConversation=function(e){var t=e.conversation;this.validateConversationDTO(t);var n=sW.Target.byConversationDTO(t);this.conversations.remove(n,e)},e.prototype.validateConversationDTO=function(e){if(!(e instanceof el.ConversationDTO))throw Error("Incorrect conversation object.");var t=e.lastMessage;if(t instanceof sY.CSMessage&&t.customerId()!==e8.G.Socket.user().id&&!1===t.accepted)throw Error("pending conversation cannot be topped or removed.")},e}();var cO={},cN={};Object.defineProperty(cN,"__esModule",{value:!0}),cN.default=function(){function e(){this.builder=new ab.RemoteAbbrMessageBuilder,e8.G.Socket.onMessage(oC.RemoteEvents.imMessage,this.onMessageReceived.bind(this))}return e.prototype.sendAck=function(e){e8.G.Socket.sendAck("imAck",{publishGuid:e})},e.prototype.createNotification=function(e){var t=e8.G.N.supportAppNotification();if(ev.default.isObject(e.nt)&&e.s!==e8.G.Socket.user().id&&t){var n={id:e.i,tm:e.ts,t:e.mt,sid:e.s,tt:e.t};n.tt===el.Scene.GROUP&&(n.gid=e.r),e8.G.N.createLocalNotification(e.nt.t,e.nt.c,n,e.nt.sound,e.nt.badge)}},e}(),Object.defineProperty(cO,"__esModule",{value:!0}),cO.default=function(e){function t(){var t=e.call(this)||this;return e8.G.Socket.onMessage(oC.RemoteEvents.IM_MSG_SYNC,t.onSyncMessageReceived.bind(t)),e8.G.Socket.onMessage(oC.RemoteEvents.IM_MSG_NEW,t.onNewMessageReceived.bind(t)),t}return es.__extends(t,e),t.prototype.onMessageReceived=function(e){if(e.t!==el.Scene.CS){var t=this.builder.build(e);this.sendAck(t.messageId);var n=sW.Target.byIMMessage(t),r=n.scene;au.default.get(n).existsMessage(t)||(this.createNotification(e),ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.MESSAGE_RECEIVED,t),r===el.Scene.PRIVATE?aM.AEC.fire(aI.ImApiEvents.PRIVATE_MESSAGE_RECEIVED,t):r===el.Scene.GROUP&&aM.AEC.fire(aI.ImApiEvents.GROUP_MESSAGE_RECEIVED,t))}},t.prototype.onSyncMessageReceived=function(e){var t=this;this.sendAck(e.i),e.rs.forEach(function(n){var r=es.__assign({},e);r.t=el.Scene.PRIVATE,r.r=n,r.s=e8.G.Socket.user().id,delete r.rs;var i=t.builder.build(r),s=sW.Target.byIMMessage(i),o=s.scene;au.default.get(s).existsMessage(i)||(t.createNotification(r),ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.MESSAGE_RECEIVED,i),o===el.Scene.PRIVATE?aM.AEC.fire(aI.ImApiEvents.PRIVATE_MESSAGE_RECEIVED,i):o===el.Scene.GROUP&&aM.AEC.fire(aI.ImApiEvents.GROUP_MESSAGE_RECEIVED,i))})},t.prototype.onNewMessageReceived=function(e){var t=this.builder.build(e);this.sendAck(t.messageId);var n=sW.Target.byIMMessage(t),r=n.scene;au.default.get(n).existsMessage(t)||(this.createNotification(e),ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.MESSAGE_RECEIVED,t),r===el.Scene.PRIVATE?aM.AEC.fire(aI.ImApiEvents.PRIVATE_MESSAGE_RECEIVED,t):r===el.Scene.GROUP&&aM.AEC.fire(aI.ImApiEvents.GROUP_MESSAGE_RECEIVED,t))},t}(cN.default);var cR={};Object.defineProperty(cR,"__esModule",{value:!0}),cR.GroupSubscribeOption=void 0,cR.default=function(){function e(){this.subscribedGroups=[],e8.G.Socket.on(ow.SocketEvent.EXPIRED_RECONNECTED,this.expiredResubscribeGroups.bind(this))}return e.prototype.expiredResubscribeGroups=function(){var e=this;this.subscribedGroups.forEach(function(t){return es.__awaiter(e,void 0,void 0,function(){return es.__generator(this,function(e){switch(e.label){case 0:return[4,this.doSubscribeGroup(t)];case 1:return e.sent(),[2]}})})})},e.prototype.subscribe=function(e){var t=this;(0,ts.validateGroupIds)(e);var n=new cF(e.groupIds,e.accessToken);this.doSubscribeGroup(n).then(function(){t.subscribedGroups.push(n),eO.CallbackUtils.onSuccess(e,{code:200,content:"ok"})}).catch(function(t){eO.CallbackUtils.onFailed(e,{code:t.resultCode||408,content:t.content||"Failed to subscribe group message"})})},e.prototype.doSubscribeGroup=function(e){return new Promise(function(t,n){var r=e.groupIds.toString().split(","),i=new e8.Rocket({name:ex.RocketTypes.subscribeGroups,params:{groupIds:r,at:e.accessToken},permission:e8.Permission.WRITE,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,success:function(){t()},fail:function(e){n(e)}});e8.G.Socket.e(i)})},e.prototype.unsubscribe=function(e){var t=this;(0,ts.validateGroupId)(e),e.groupId=e.groupId.toString();var n=new e8.Rocket({name:ex.RocketTypes.unsubscribeGroup,params:{groupId:e.groupId},permission:e8.Permission.READ,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,success:function(){t.deleteSubscriptionByGroupId(e.groupId),eO.CallbackUtils.onSuccess(e,{code:200,content:"ok"})},fail:function(t){eO.CallbackUtils.onFailed(e,{code:t.resultCode||408,content:t.content||"Failed to unsubscribe group message"})}});e8.G.Socket.e(n)},e.prototype.deleteSubscriptionByGroupId=function(e){this.subscribedGroups=this.subscribedGroups.filter(function(t){var n=t.groupIds.findIndex(function(t){return t==e});return n>-1&&t.groupIds.splice(n,1),t.groupIds.length>0})},e}();var cF=function(e,t){this.groupIds=e,this.accessToken=t};cR.GroupSubscribeOption=cF;var cG={};Object.defineProperty(cG,"__esModule",{value:!0}),cG.default=function(){function e(){this.newMessageReceived=function(e){var t=null;e.c&&(t=JSON.parse(e.c)),t&&t.events&&t.events.map(function(e){var n=e.userData?JSON.parse(e.userData):{},r={time:e.time,action:e.action,groupOnlineCount:t.userAmount,groupId:t.groupId,id:e.userId,data:n};aM.AEC.fire(aI.ImApiEvents.GROUP_PRESENCE,r)})},aj.GSocket.onMessage(oC.RemoteEvents.groupPresence,this.newMessageReceived)}return e.prototype.presence=function(e){(0,ts.validateGroupIds)(e),e.groupIds.toString().split(",");var t={groupIds:e.groupIds};this.emitRocket(ex.RocketTypes.subscribeGroupPresence,t,function(){eO.CallbackUtils.onSuccess(e,{code:200,content:"ok"})},function(t){eO.CallbackUtils.onFailed(e,{code:t.code||408,content:t.content||"Failed to subscribe group message"})},eA.SocketTimeout.commonRequestSingle,eA.SocketTimeout.commonRequestTotal)},e.prototype.unPresence=function(e){(0,ts.validateUnSubscribeGroupPresence)(e),e.groupId=e.groupId.toString();var t={groupId:e.groupId};this.emitRocket(ex.RocketTypes.unsubscribeGroupPresence,t,function(){eO.CallbackUtils.onSuccess(e,{code:200,content:"ok"})},function(t){eO.CallbackUtils.onFailed(e,{code:t.code||408,content:t.content||"Failed to unsubscribe presence"})},eA.SocketTimeout.commonRequestSingle,eA.SocketTimeout.commonRequestTotal)},e.prototype.emitRocket=function(e,t,n,r,i,s){var o=new e8.Rocket({name:e,params:t,singleTimeout:i,totalTimeout:s,permission:e8.Permission.WRITE,success:n,fail:r});e8.G.Socket.e(o)},e}();var cj={};Object.defineProperty(cj,"__esModule",{value:!0}),cj.default=function(){function e(){}return e.prototype.get=function(e){(0,ts.validateGroupId)(e),e.groupId=e.groupId.toString();var t=new e8.Rocket({name:ex.RocketTypes.imGroupOnlineCount,params:{groupId:e.groupId},permission:e8.Permission.READ,singleTimeout:eA.SocketTimeout.commonQuerySingle,totalTimeout:eA.SocketTimeout.commonQueryTotal,fail:function(t){eO.CallbackUtils.onFailed(e,t||{code:408,content:"Failed to query online group users"})},success:function(t){200==t.code?eO.CallbackUtils.onSuccess(e,t):eO.CallbackUtils.onFailed(e,t)}});e8.G.Socket.e(t)},e}();var cU={},cB={};Object.defineProperty(cB,"__esModule",{value:!0}),cB.IMHereNow=void 0,cB.IMHereNow=function(){function e(){}return e.prototype.doHereNow=function(e,t,n){var r=new e8.Rocket({name:e,params:t,permission:e8.Permission.READ,singleTimeout:eA.SocketTimeout.commonQuerySingle,totalTimeout:eA.SocketTimeout.commonQueryTotal,fail:function(e){eO.CallbackUtils.onFailed(n,e)},success:function(e){var t=e.content;e.content=t.map(function(e){var t=e.userData?JSON.parse(e.userData):{};return{id:e.userId,data:t}}),eO.CallbackUtils.onSuccess(n,e)}});e8.G.Socket.e(r)},e}(),Object.defineProperty(cU,"__esModule",{value:!0}),cU.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.hereNow=function(e){(0,ts.validateGroupId)(e),e.groupId=e.groupId.toString();var t={groupId:e.groupId};this.doHereNow(ex.RocketTypes.imGroupHereNow,t,e)},t}(cB.IMHereNow);var cL={};Object.defineProperty(cL,"__esModule",{value:!0}),cL.default=function(){function e(){this.newMessageReceived=function(e){var t=[];e.c&&(t=JSON.parse(e.c).events||[]),t.map(function(e){var t=e.userData?JSON.parse(e.userData):{},n={time:e.time,action:e.action,id:e.userId,data:t};aM.AEC.fire(aI.ImApiEvents.USER_PRESENCE,n)})},aj.GSocket.onMessage(oC.RemoteEvents.userPresence,this.newMessageReceived)}return e.prototype.presence=function(e){(0,ts.validateUserIds)(e),e.userIds.toString().split(",");var t={userIds:e.userIds};this.emitRocket(ex.RocketTypes.subscribeUserPresence,t,function(){eO.CallbackUtils.onSuccess(e,{code:200,content:"ok"})},function(t){eO.CallbackUtils.onFailed(e,{code:t.code||408,content:t.content||"Failed to subscribe group message"})},eA.SocketTimeout.commonRequestSingle,eA.SocketTimeout.commonRequestTotal)},e.prototype.unPresence=function(e){(0,ts.validateUserId)(e),e.userId=e.userId.toString();var t={userId:e.userId};this.emitRocket(ex.RocketTypes.unsubscribeUserPresence,t,function(){eO.CallbackUtils.onSuccess(e,{code:200,content:"ok"})},function(t){eO.CallbackUtils.onFailed(e,{code:t.code||408,content:t.content||"Failed to unsubscribe presence"})},eA.SocketTimeout.commonRequestSingle,eA.SocketTimeout.commonRequestTotal)},e.prototype.emitRocket=function(e,t,n,r,i,s){var o=new e8.Rocket({name:e,params:t,singleTimeout:i,totalTimeout:s,permission:e8.Permission.WRITE,success:n,fail:r});e8.G.Socket.e(o)},e}();var cq={};Object.defineProperty(cq,"__esModule",{value:!0}),cq.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.hereNow=function(e){(0,ts.validateUserIds)(e),e.userIds.toString().split(","),this.doHereNow(ex.RocketTypes.imHereNow,e,e)},t}(cB.IMHereNow);var cV={},cz={},cH={};Object.defineProperty(cH,"__esModule",{value:!0}),cH.str=void 0,cH.str=new(function(){function e(){}return e.prototype.fileExtension=function(e,t){if(ev.default.isString(e))try{var n=e.split(t);return n[n.length-1]}catch(e){throw Error(e)}},e}());var cW={},cX={},cJ={};Object.defineProperty(cJ,"__esModule",{value:!0}),cJ.AbstractMessagePayload=void 0,cJ.AbstractMessagePayload=function(){},Object.defineProperty(cX,"__esModule",{value:!0}),cX.FileMessagePayload=void 0,cX.FileMessagePayload=function(e){function t(){var t=e.apply(this,es.__spreadArray([],es.__read(arguments),!1))||this;return t.contentType="",t.name="",t.size=0,t.url="",t}return es.__extends(t,e),t}(cJ.AbstractMessagePayload),Object.defineProperty(cW,"__esModule",{value:!0}),cW.ImageMessagePayload=void 0,cW.ImageMessagePayload=function(e){function t(){var t=e.apply(this,es.__spreadArray([],es.__read(arguments),!1))||this;return t.width=0,t.height=0,t}return es.__extends(t,e),t}(cX.FileMessagePayload);var c$={},cY={};Object.defineProperty(cY,"__esModule",{value:!0}),cY.AbstractPayloadBuilder=void 0,cY.AbstractPayloadBuilder=function(){function e(){}return e.prototype.build=function(e){var t=this.create();return this.setPayload(e,t),t},e}(),Object.defineProperty(c$,"__esModule",{value:!0}),c$.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cX.FileMessagePayload},t.prototype.setPayload=function(e,t){var n=e.createOptions.file;t.url=n.path,t.name=n.name,t.size=n.size,t.contentType=n.type,e.complete=Promise.resolve()},t}(cY.AbstractPayloadBuilder),Object.defineProperty(cz,"__esModule",{value:!0}),cz.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cW.ImageMessagePayload},t.prototype.setPayload=function(t,n){e.prototype.setPayload.call(this,t,n);var r=t.createOptions.file,i=r.path||r.tempFilePath,s=ev.default.isEmpty(r.name)||void 0===r.name?i:r.name;n.name="wx-image."+cH.str.fileExtension(s,"."),n.contentType="image/"+cH.str.fileExtension(s,"."),n.url=i,n.size=r.size,t.complete=new Promise(function(e,t){wx.getImageInfo({src:n.url,success:function(t){n.width=t.width,n.height=t.height,e()},fail:function(e){t(e)}})})},t}(c$.default);var cQ={},cK={};Object.defineProperty(cK,"__esModule",{value:!0}),cK.AudioMessagePayload=void 0,cK.AudioMessagePayload=function(e){function t(){var t=e.apply(this,es.__spreadArray([],es.__read(arguments),!1))||this;return t.duration=0,t}return es.__extends(t,e),t}(cX.FileMessagePayload),Object.defineProperty(cQ,"__esModule",{value:!0}),cQ.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cK.AudioMessagePayload},t.prototype.setPayload=function(t,n){e.prototype.setPayload.call(this,t,n);var r=t.createOptions.file,i=r.tempFilePath,s=ev.default.isEmpty(r.name)||null==r.name?i:r.name,o=r.duration,a=r.fileSize;n.url=i,n.size=a,n.duration=o/1e3,n.name="wx-audio."+cH.str.fileExtension(s,"."),n.contentType="audio/"+cH.str.fileExtension(s,"."),t.complete=Promise.resolve()},t}(c$.default);var cZ={},c0={};Object.defineProperty(c0,"__esModule",{value:!0}),c0.TextMessagePayload=void 0,c0.TextMessagePayload=function(e){function t(){var t=e.apply(this,es.__spreadArray([],es.__read(arguments),!1))||this;return t.text="",t}return es.__extends(t,e),t}(cJ.AbstractMessagePayload),Object.defineProperty(cZ,"__esModule",{value:!0}),cZ.TextPayloadBuilder=void 0,cZ.TextPayloadBuilder=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new c0.TextMessagePayload},t.prototype.setPayload=function(e,t){t.text=e.createOptions.text,e.complete=Promise.resolve()},t}(cY.AbstractPayloadBuilder);var c1={},c2={};Object.defineProperty(c2,"__esModule",{value:!0}),c2.VideoMessagePayload=void 0,c2.VideoMessagePayload=function(e){function t(){var t=e.apply(this,es.__spreadArray([],es.__read(arguments),!1))||this;return t.video=new c4,t.thumbnail=new c3,t}return es.__extends(t,e),t}(cJ.AbstractMessagePayload);var c3=function(){function e(){this.name="",this.url="",this.width=0,this.height=0,this.contentType=""}return e.prototype.initURL=function(e){em.PlatformDetector.currentPlatform()===em.PlatformType.BROWSER&&this.htmlUrl(e)},e.prototype.htmlUrl=function(e){var t=document.createElement("canvas");t.width=e.videoWidth,t.height=e.videoHeight,t.getContext("2d").drawImage(e,0,0,t.width,t.height),this.url=t.toDataURL("image/png")},e}(),c4=function(){this.name="",this.url="",this.width=0,this.height=0,this.contentType="",this.size=0,this.duration=0};Object.defineProperty(c1,"__esModule",{value:!0}),c1.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new c2.VideoMessagePayload},t.prototype.setPayload=function(e,t){var n=e.createOptions.file,r=t.video,i=t.thumbnail,s=n.duration,o=n.height,a=n.size,u=n.tempFilePath,c=n.thumbTempFilePath,l=n.width,p=n.name,f=void 0===p?"":p,d=ev.default.isEmpty(f)?u:f;r.contentType="video/"+cH.str.fileExtension(d,"."),r.name="wx-video."+cH.str.fileExtension(d,"."),r.url=u,r.width=i.width=l,r.height=i.height=o,r.size=a,r.duration=s,i.url=c,i.contentType="image/jpg",i.name="wx-thumbnail.jpg",e.complete=Promise.resolve()},t}(cY.AbstractPayloadBuilder);var c6={},c5={};Object.defineProperty(c5,"__esModule",{value:!0}),c5.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cX.FileMessagePayload},t.prototype.setPayload=function(e,t){var n=e.createOptions.file;t.url=n.fullPath||n.path,t.name=n.name,t.size=n.size,t.contentType=n.type,n.type,e.complete=Promise.resolve()},t}(cY.AbstractPayloadBuilder),Object.defineProperty(c6,"__esModule",{value:!0}),c6.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cW.ImageMessagePayload},t.prototype.setPayload=function(e,t){var n=e.createOptions.file;t.url=n.path,t.size=n.size;var r=ev.default.isEmpty(n.name)||void 0===n.name?n.path:n.name;t.contentType="image/"+cH.str.fileExtension(r,"."),t.name="uni-image."+cH.str.fileExtension(r,"."),e.complete=new Promise(function(e,r){uni.getImageInfo({src:n.path,success:function(n){t.width=n.width,t.height=n.height,e()},fail:function(e){r(e)}})})},t}(c5.default);var c9={};Object.defineProperty(c9,"__esModule",{value:!0}),c9.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cK.AudioMessagePayload},t.prototype.setPayload=function(e,t){var n=e.createOptions,r=n.file,i=r.tempFilePath,s=ev.default.isEmpty(r.name)||null==r.name?i:r.name;t.url=i,t.name="uni-audio."+cH.str.fileExtension(s,"."),t.contentType="audio/"+cH.str.fileExtension(s,"."),e.complete=new Promise(function(e,r){uni.getFileInfo({filePath:i,success:function(s){var o=s.size;if(t.size=o,0===o)e();else if(ev.default.isDef(n.file.duration))t.duration=n.file.duration/1e3,e();else{var a=uni.createInnerAudioContext();a.src=i,a.onCanplay(function(n){n.errCode?(a.destroy(),r(n)):(t.duration=a.duration,a.destroy(),e())}),a.onError(function(t){a.destroy(),-99===t.errCode?e():r(t)})}},fail:function(e){r(e)}})})},t}(c5.default);var c7={};Object.defineProperty(c7,"__esModule",{value:!0}),c7.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new c2.VideoMessagePayload},t.prototype.setPayload=function(e,t){var n=e.createOptions.file,r=t.video,i=t.thumbnail,s=n.duration,o=n.height,a=n.size,u=n.tempFilePath,c=n.width,l=n.name,p=void 0===l?"":l,f=ev.default.isEmpty(p)?u:p;r.size=a,r.width=c,r.height=o,r.url=u,r.duration=s,r.contentType="video/"+cH.str.fileExtension(f,"."),r.name="uni-video."+cH.str.fileExtension(f,"."),i.url=u,i.height=200,i.width=Number((r.width*i.height/r.height).toFixed(0)),i.contentType="image/jpg",i.name="uni-thumbnail.jpg",e.complete=Promise.resolve()},t}(cY.AbstractPayloadBuilder);var c8={},le={};Object.defineProperty(le,"__esModule",{value:!0}),le.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cX.FileMessagePayload},t.prototype.setPayload=function(e,t){var n=e.createOptions.file;t.url=(window.URL||window.webkitURL).createObjectURL(n),t.name=n.name,t.size=n.size,t.contentType=n.type,e.complete=Promise.resolve()},t}(cY.AbstractPayloadBuilder),Object.defineProperty(c8,"__esModule",{value:!0}),c8.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cW.ImageMessagePayload},t.prototype.setPayload=function(t,n){e.prototype.setPayload.call(this,t,n);var r=t.createOptions.file,i=window.URL||window.webkitURL,s=new Image;s.src=i.createObjectURL(r),t.complete=new Promise(function(e,t){s.onload=function(){n.width=s.width,n.height=s.height,i.revokeObjectURL(s.src),e()},s.onerror=function(e){i.revokeObjectURL(s.src),t(e)}})},t}(le.default);var lt={};Object.defineProperty(lt,"__esModule",{value:!0}),lt.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cK.AudioMessagePayload},t.prototype.setPayload=function(t,n){e.prototype.setPayload.call(this,t,n);var r=t.createOptions.file,i=window.URL||window.webkitURL,s=document.createElement("audio");s.src=i.createObjectURL(r),t.complete=new Promise(function(e,t){s.onloadedmetadata=function(){n.duration=s.duration,i.revokeObjectURL(s.src),e()},s.onerror=function(e){i.revokeObjectURL(s.src),t(e)}})},t}(le.default);var ln={};Object.defineProperty(ln,"__esModule",{value:!0}),ln.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new c2.VideoMessagePayload},t.prototype.setPayload=function(e,t){var n=this,r=e.createOptions.file,i=t.video,s=t.thumbnail,o=window.URL||window.webkitURL,a=document.createElement("video");a.src=o.createObjectURL(r),i.size=r.size,i.name=r.name,i.contentType=r.type,i.url=a.src,s.name=r.name,s.contentType="image/jpg",e.complete=new Promise(function(e,t){a.onloadedmetadata=function(){i.duration=a.duration,i.width=a.videoWidth,i.height=a.videoHeight,s.width=a.videoWidth,s.height=a.videoHeight,s.url=n.getThumbnailUrl(a),o.revokeObjectURL(a.src),e()},a.onerror=function(e){o.revokeObjectURL(a.src),t(e)}})},t.prototype.getThumbnailUrl=function(e){var t=document.createElement("canvas");return t.width=e.videoWidth,t.height=e.videoHeight,t.getContext("2d").drawImage(e,0,0,t.width,t.height),t.toDataURL("image/png")},t}(cY.AbstractPayloadBuilder);var lr={};Object.defineProperty(lr,"__esModule",{value:!0}),lr.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new c2.VideoMessagePayload},t.prototype.setPayload=function(e,t){var n=e.createOptions.file,r=t.video,i=t.thumbnail,s=n.duration,o=n.height,a=n.size,u=n.tempFilePath,c=n.tempVideoThumbPath,l=n.width;r.size=a,r.width=l,r.height=o,r.url=u,r.duration=s,r.contentType="video/mp4",r.name="ali-video.mp4",i.url=c,i.height=200,i.width=Number((r.width*i.height/r.height).toFixed(0)),i.contentType="image/jpg",i.name="ali-thumbnail.jpg",e.complete=Promise.resolve()},t}(cY.AbstractPayloadBuilder);var li={},ls={};Object.defineProperty(ls,"__esModule",{value:!0}),ls.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cX.FileMessagePayload},t.prototype.setPayload=function(e,t){e.complete=Promise.reject("Alipay not support file message.")},t}(cY.AbstractPayloadBuilder),Object.defineProperty(li,"__esModule",{value:!0}),li.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cW.ImageMessagePayload},t.prototype.setPayload=function(e,t){var n=e.createOptions.file;t.url=n.path,t.size=n.size,e.complete=new Promise(function(e,r){my.getImageInfo({src:n.path,success:function(n){t.width=n.width,t.height=n.height,t.contentType="image/"+n.type,t.name="ali-image."+n.type,e()},fail:function(e){r(e)}})})},t}(ls.default);var lo={};Object.defineProperty(lo,"__esModule",{value:!0}),lo.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cK.AudioMessagePayload},t.prototype.setPayload=function(e,t){var n=e.createOptions.file,r=n.tempFilePath;t.url=r,t.name="ali-audio."+cH.str.fileExtension(r,"."),t.contentType="audio/"+cH.str.fileExtension(r,"."),t.duration=n.duration,t.size=n.fileSize,e.complete=Promise.resolve()},t}(ls.default);var la={};Object.defineProperty(la,"__esModule",{value:!0}),la.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new c2.VideoMessagePayload},t.prototype.setPayload=function(e,t){var n=e.createOptions.file,r=t.video,i=t.thumbnail,s=n.duration,o=n.height,a=n.size,u=n.tempFilePath,c=n.thumbTempFilePath,l=n.width;r.size=a,r.width=l,r.height=o,r.url=u,r.duration=s,r.contentType="video/"+cH.str.fileExtension(u,"."),r.name="baidu-video."+cH.str.fileExtension(u,"."),i.url=c,i.height=200,i.width=Number((r.width*i.height/r.height).toFixed(0)),i.contentType="image/"+cH.str.fileExtension(c,"."),i.name="baidu-thumbnail."+cH.str.fileExtension(u,"."),e.complete=Promise.resolve()},t}(cY.AbstractPayloadBuilder);var lu={};Object.defineProperty(lu,"__esModule",{value:!0}),lu.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cX.FileMessagePayload},t.prototype.setPayload=function(e,t){e.complete=Promise.reject("Baidu app not support file message.")},t}(cY.AbstractPayloadBuilder);var lc={};Object.defineProperty(lc,"__esModule",{value:!0}),lc.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cK.AudioMessagePayload},t.prototype.setPayload=function(e,t){var n=e.createOptions.file,r=n.tempFilePath;t.url=r,t.name="baidu-audio."+cH.str.fileExtension(r,"."),t.contentType="audio/"+cH.str.fileExtension(r,"."),t.duration=n.duration/1e3,t.size=n.fileSize,e.complete=Promise.resolve()},t}(lu.default);var ll={};Object.defineProperty(ll,"__esModule",{value:!0}),ll.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cW.ImageMessagePayload},t.prototype.setPayload=function(e,t){var n=e.createOptions.file;t.url=n.path,t.size=n.size,e.complete=new Promise(function(e,r){swan.getImageInfo({src:n.path,success:function(n){t.width=n.width,t.height=n.height,t.contentType="image/"+n.type,t.name="baidu-image."+n.type,e()},fail:function(e){r(e)}})})},t}(lu.default);var lp={},lf={};Object.defineProperty(lf,"__esModule",{value:!0}),lf.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cX.FileMessagePayload},t.prototype.setPayload=function(e,t){var n=e.createOptions.file,r=n.uri,i=n.type,s=n.size,o=n.name;t.url=decodeURIComponent(r),t.name=o,t.size=s,t.contentType=i,e.complete=Promise.resolve()},t}(cY.AbstractPayloadBuilder),Object.defineProperty(lp,"__esModule",{value:!0}),lp.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cW.ImageMessagePayload},t.prototype.setPayload=function(e,t){var n=e.createOptions.file,r=n.uri,i=n.fileSize,s=n.type,o=n.fileName,a=n.width,u=n.height;t.url=r,t.size=i,t.contentType=s,t.name=o,t.width=a,t.height=u,e.complete=Promise.resolve()},t}(lf.default);var ld={};Object.defineProperty(ld,"__esModule",{value:!0}),ld.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new c2.VideoMessagePayload},t.prototype.setPayload=function(e,t){var n=e.createOptions.file,r=t.video,i=t.thumbnail,s=n.uri,o=n.type,a=n.fileSize,u=n.fileName,c=n.duration,l=n.height,p=n.width;r.size=a,r.width=p,r.height=l,r.url=s,r.duration=c,r.contentType=o,r.name=u,i.url=s,i.name="rn-thumbnail.jpg",i.height=200,i.width=Number((r.width*i.height/r.height).toFixed(0)),i.contentType="image/jpg",e.complete=Promise.resolve()},t}(cY.AbstractPayloadBuilder);var lh={};Object.defineProperty(lh,"__esModule",{value:!0}),lh.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new cK.AudioMessagePayload},t.prototype.setPayload=function(e,t){var n=e.createOptions,r=n.file,i=r.uri,s=r.name,o=r.duration,a=r.size;t.url=i,t.duration=Number((o/1e3).toFixed(2)),t.size=a,t.name=s||"rn-audio."+cH.str.fileExtension(i,"."),t.contentType="audio/"+cH.str.fileExtension(i,"."),n.file={uri:i,type:t.contentType,name:t.name},e.complete=Promise.resolve()},t}(lf.default);var ly={},lv={};Object.defineProperty(lv,"__esModule",{value:!0}),lv.default=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t}(cJ.AbstractMessagePayload),Object.defineProperty(ly,"__esModule",{value:!0}),ly.CustomPayloadBuilder=void 0,ly.CustomPayloadBuilder=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.create=function(){return new lv.default},t.prototype.setPayload=function(e,t){t.payload=e.createOptions.payload,e.complete=Promise.resolve()},t}(cY.AbstractPayloadBuilder);var lm={};Object.defineProperty(lm,"__esModule",{value:!0}),lm.LocalIMMessageBuildOptions=void 0,lm.LocalIMMessageBuildOptions=function(e,t){this.type=e,this.createOptions=t},Object.defineProperty(cV,"__esModule",{value:!0}),cV.IMMessageBuilder=void 0,cV.IMMessageBuilder=function(){function e(){var e;this.framework=w.FrameworkDetector.currentFramework(),this.platform=em.PlatformDetector.currentPlatform(),this.payloadBuilders=((e={})[w.Framework.UNIAPP]={image:new c6.default,file:new c5.default,audio:new c9.default,video:new c7.default,text:new cZ.TextPayloadBuilder},e[em.PlatformType.MP_WX]={image:new cz.default,file:new c$.default,audio:new cQ.default,video:new c1.default,text:new cZ.TextPayloadBuilder},e[em.PlatformType.BROWSER]={image:new c8.default,file:new le.default,audio:new lt.default,video:new ln.default,text:new cZ.TextPayloadBuilder},e[em.PlatformType.MP_ALI]={image:new li.default,file:new ls.default,audio:new lo.default,video:new lr.default,text:new cZ.TextPayloadBuilder},e[em.PlatformType.MP_BAIDU]={image:new ll.default,file:new lu.default,audio:new lc.default,video:new la.default,text:new cZ.TextPayloadBuilder},e[w.Framework.REACT_NATIVE]={image:new lp.default,file:new lf.default,audio:new lh.default,video:new ld.default,text:new cZ.TextPayloadBuilder},e[em.PlatformType.MP_BYTE]={image:new cz.default,file:new c$.default,audio:new cQ.default,video:new c1.default,text:new cZ.TextPayloadBuilder},e)}return e.prototype.buildMessage=function(e,t){this.validate(t,e);var n=this.framework===w.Framework.UNKNOWN?this.platform:this.framework,r=this.payloadBuilders[n][e],i=new lm.LocalIMMessageBuildOptions(e,t);if(r){var s=r.build(i);i.payload=s}else s=(new ly.CustomPayloadBuilder).build(i),i.payload=s.payload;var o=this.build(i);return i.complete.then(function(){eO.CallbackUtils.onSuccess(t,o)}).catch(function(e){eO.CallbackUtils.onFailed(t,e)}),o},e.prototype.build=function(e){var t,n=e.type,r=e.payload,i=e.createOptions.to,s=i.type;return s===el.Scene.GROUP?((t=new s$.GroupMessage).senderData=e8.G.Socket.user().data,i.id&&(t.groupId=i.id)):s===el.Scene.PRIVATE?((t=new sX.PrivateMessage).read=!1,i.id&&(t.receiverId=i.id)):s===el.Scene.CS&&((t=new sY.CSMessage).to=i.id.toString(),t.teamId=i.id.toString(),t.senderData=e8.G.Socket.user().data),t.senderId=e8.G.Socket.user().id,t.messageId=e8.UUID.get(),t.payload=r,t.timestamp=Date.now(),t.type=n,t.recalled=!1,t.status=el.MessageStatus.NEW,t.buildOptions=e,t},e.prototype.validate=function(e,t){(0,ts.validateMessage)(es.__assign(es.__assign({},e),{type:t}))},e}();var lg={};Object.defineProperty(lg,"__esModule",{value:!0}),lg.CsMessageReceiver=void 0,lg.CsMessageReceiver=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return es.__extends(t,e),t.prototype.onMessageReceived=function(e){var t=this;if(e.t===el.Scene.CS){var n=this.builder.build(e);this.sendAck(n.messageId);var r=sW.Target.byIMMessage(n);au.default.get(r).existsMessage(n)||(n.customerId()===e8.G.Socket.user().id?(this.createNotification(e),ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.MESSAGE_RECEIVED,n),aM.AEC.fire(aI.ImApiEvents.CS_MESSAGE_RECEIVED,n)):aN.AgentStatus.getInstance().queryTeams().then(function(){aP.LiveSession.isMyMessage(n)&&t.createNotification(e),ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.CS_AGENT_MESSAGE_RECEIVED,n)}))}},t}(cN.default);var lb={},lE={};Object.defineProperty(lE,"__esModule",{value:!0}),lE.RecallMessageRequest=void 0,lE.RecallMessageRequest=function(e){var t=this;this.times=[];var n=e[0],r=sW.Target.byIMMessage(n);this.scene=r.scene,this.targetId=r.id,e.forEach(function(e){t.times.push(e.timestamp)}),this.times.sort(function(e,t){return e<t?-1:+(e!=t)})},Object.defineProperty(lb,"__esModule",{value:!0}),lb.default=function(){function e(){this.onRemoteRecalled=function(e){ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.MESSAGE_RECALLED,e)},aj.GSocket.onMessage(oC.RemoteEvents.IM_MSG_RECALLED,this.onRemoteRecalled)}return e.prototype.recallMessage=function(e){return es.__awaiter(this,void 0,void 0,function(){var t,n,r,i,s,o,a;return es.__generator(this,function(u){switch(u.label){case 0:return(0,ts.validateRecallMessage)(e),t=e.messages,[4,this.recallServerMessages(t)];case 1:return u.sent(),r=(n=t[0]).scene(),i=this.toConversationId(r,n.senderId,n.targetId()),s={id:e8.G.Socket.user().id,data:e8.G.Socket.user().data},o=t.map(function(e){return e.timestamp}),a=new aC.ServerRecalledEvent(r,i,s,o),ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.MESSAGE_RECALLED,a),eO.CallbackUtils.onSuccess(e),[2]}})})},e.prototype.toConversationId=function(e,t,n){if(el.Scene.PRIVATE===e)return t.localeCompare(n)>0?"".concat(t,":").concat(n):"".concat(n,":").concat(t);if(el.Scene.GROUP===e)return n;throw{code:400,content:"scene: ".concat(e," not support")}},e.prototype.recallServerMessages=function(e){var t=new lE.RecallMessageRequest(e);return 0===t.times.length?Promise.resolve():new Promise(function(e,n){var r=new e8.Rocket({name:ex.RocketTypes.IM_RECALL_MESSAGE,params:t,permission:e8.Permission.WRITE,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,fail:function(e){n(e)},success:function(t){200===t.code?e(t):n(t)}});e8.G.Socket.e(r)})},e}();var lS={},l_={},lk={};Object.defineProperty(lk,"__esModule",{value:!0}),lk.MemberDataCache=void 0,lk.MemberDataCache=function(){function e(){this.map=new Map}return e.prototype.getData=function(e){return this.map.get(e)},e.prototype.setData=function(e,t){this.map.set(e,t)},e}(),Object.defineProperty(l_,"__esModule",{value:!0}),l_.GMember=void 0,l_.GMember=function(){function e(){this.dataCache=new lk.MemberDataCache}return e.init=function(){this.i=new e},e.prototype.getData=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return es.__awaiter(this,void 0,void 0,function(){var t,n,r=this;return es.__generator(this,function(i){switch(i.label){case 0:return t=[],n=new Map,e.forEach(function(e){var i=r.dataCache.getData(e);i?n.set(e,i):t.push(e)}),0===t.length?[2,Promise.resolve(n)]:[4,this.fetchData.apply(this,es.__spreadArray([],es.__read(t),!1))];case 1:return i.sent().forEach(function(e,t){r.dataCache.setData(t,e),n.set(t,e)}),[2,Promise.resolve(n)]}})})},e.prototype.fetchData=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new Promise(function(t,n){var r=new e8.Rocket({name:ex.RocketTypes.MD_CMD,permission:e8.Permission.READ,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,params:{name:"GET",data:{ids:e}},success:function(e){if(200===e.code){var r=new Map;e.content.forEach(function(e){r.set(e.id,e.data)}),t(r)}else n(e)},fail:function(e){n(e)}});e8.G.Socket.e(r)})},e.prototype.setData=function(e,t){this.dataCache.setData(e,t)},e}(),Object.defineProperty(lS,"__esModule",{value:!0}),lS.MemberDataUpdator=void 0,lS.MemberDataUpdator=function(){function e(){ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.MESSAGE_RECEIVED,this.onMessageReceived),ar.IMEC.i.on(o9.IM_INTERNAL_EVENTS.MESSAGE_SENDING,this.onMessageSending)}return e.prototype.onMessageSending=function(e){var t=sW.Target.byIMMessage(e.message);t.scene===el.Scene.PRIVATE&&l_.GMember.i.setData(t.id,e.receiver)},e.prototype.onMessageReceived=function(e){sW.Target.byIMMessage(e).scene===el.Scene.GROUP&&l_.GMember.i.setData(e.senderId,e.senderData)},e}(),Object.defineProperty(oN,"__esModule",{value:!0}),oN.IM=void 0,oN.IM=function(){function e(){this._iMReceiver=new cO.default,this.csMessageReceiver=new lg.CsMessageReceiver,this.memberDataUpdator=new lS.MemberDataUpdator,this._userHereNow=new cq.default,this.goEasyUploader=new oR.GoEasyUploader,this._groupHereNow=new cU.default,this._groupOnlineCount=new cj.default,this.groupMessageSubscriber=new cR.default,this.messageBuilder=new cV.IMMessageBuilder,this.messageSender=new o5.default,this.recaller=new lb.default,this._groupPresenceSubscriber=new cG.default,this._userPresenceSubscriber=new cL.default,this.conversations=new as.default,this.histories=au.default.init()}return e.init=function(){ar.IMEC.init(),aM.AEC.init(),e.instance=new e},e.i=function(){if(e.instance)return e.instance;throw Error("Please connect first.")},e.prototype.validateModules=function(){if(aj.GSocket.status()===ec.NetworkStatus.DISCONNECTED)throw Error("Please call connect() first.");cA.GIMModule.check()},e.prototype.catch=function(e,t){return es.__awaiter(this,void 0,void 0,function(){var n;return es.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.validateModules(),[4,e()];case 1:return r.sent(),[3,3];case 2:return n=r.sent(),eO.CallbackUtils.onFailed(t,n),[3,3];case 3:return[2]}})})},e.prototype.on=function(e,t){aM.AEC.on(e,t)},e.prototype.off=function(e,t){aM.AEC.off(e,t)},e.prototype.createTextMessage=function(e){return this.validateModules(),this.messageBuilder.buildMessage(sH.MessageType.TEXT,e)},e.prototype.createImageMessage=function(e){return this.validateModules(),this.messageBuilder.buildMessage(sH.MessageType.IMAGE,e)},e.prototype.createFileMessage=function(e){return this.validateModules(),this.messageBuilder.buildMessage(sH.MessageType.FILE,e)},e.prototype.createAudioMessage=function(e){return this.validateModules(),this.messageBuilder.buildMessage(sH.MessageType.AUDIO,e)},e.prototype.createVideoMessage=function(e){return this.validateModules(),this.messageBuilder.buildMessage(sH.MessageType.VIDEO,e)},e.prototype.createCustomMessage=function(e){return this.validateModules(),this.messageBuilder.buildMessage(e.type,e)},e.prototype.sendMessage=function(e){var t=this;this.catch(function(){t.messageSender.send(e)},e)},e.prototype.recallMessage=function(e){var t=this;this.catch(function(){t.recaller.recallMessage(e)},e)},e.prototype.deleteMessage=function(e){var t=this;this.catch(function(){t.histories.deleteMessage(e)},e)},e.prototype.markGroupMessageAsRead=function(e){var t=this;this.catch(function(){return es.__awaiter(t,void 0,void 0,function(){return es.__generator(this,function(t){switch(t.label){case 0:return[4,this.histories.groupMarkAsRead(e)];case 1:return t.sent(),[2]}})})},e)},e.prototype.markPrivateMessageAsRead=function(e){var t=this;this.catch(function(){return es.__awaiter(t,void 0,void 0,function(){return es.__generator(this,function(t){switch(t.label){case 0:return[4,this.histories.privateMarkAsRead(e)];case 1:return t.sent(),[2]}})})},e)},e.prototype.markMessageAsRead=function(e,t){var n=this;this.catch(function(){return es.__awaiter(n,void 0,void 0,function(){return es.__generator(this,function(n){switch(n.label){case 0:return[4,this.histories.markMessageAsRead(e,t)];case 1:return n.sent(),[2]}})})},e)},e.prototype.latestConversations=function(e){this.validateModules(),this.conversations.latestConversations(e)},e.prototype.removePrivateConversation=function(e){var t=this;this.catch(function(){return t.conversations.removePrivateConversation(e)},e)},e.prototype.removeGroupConversation=function(e){var t=this;this.catch(function(){return t.conversations.removeGroupConversation(e)},e)},e.prototype.topPrivateConversation=function(e){var t=this;this.catch(function(){return t.conversations.topPrivateConversation(e)},e)},e.prototype.topGroupConversation=function(e){var t=this;this.catch(function(){return t.conversations.topGroupConversation(e)},e)},e.prototype.history=function(e,t){var n=this;this.catch(function(){n.histories.loadHistory(e,t)},e)},e.prototype.subscribeUserPresence=function(e){var t=this;this.catch(function(){return t._userPresenceSubscriber.presence(e)},e)},e.prototype.unsubscribeUserPresence=function(e){var t=this;this.catch(function(){return t._userPresenceSubscriber.unPresence(e)},e)},e.prototype.hereNow=function(e){var t=this;this.catch(function(){return t._userHereNow.hereNow(e)},e)},e.prototype.subscribeGroup=function(e){var t=this;this.catch(function(){return t.groupMessageSubscriber.subscribe(e)},e)},e.prototype.unsubscribeGroup=function(e){var t=this;this.catch(function(){return t.groupMessageSubscriber.unsubscribe(e)},e)},e.prototype.subscribeGroupPresence=function(e){var t=this;this.catch(function(){return t._groupPresenceSubscriber.presence(e)},e)},e.prototype.unsubscribeGroupPresence=function(e){var t=this;this.catch(function(){return t._groupPresenceSubscriber.unPresence(e)},e)},e.prototype.groupHereNow=function(e){var t=this;this.catch(function(){return t._groupHereNow.hereNow(e)},e)},e.prototype.groupOnlineCount=function(e){var t=this;this.catch(function(){return t._groupOnlineCount.get(e)},e)},e.prototype.latestPendingConversations=function(e){this.validateModules(),this.conversations.latestPendingConversations(e)},e.prototype.topConversation=function(e){this.validateModules(),this.conversations.topConversation(e)},e.prototype.removeConversation=function(e){this.validateModules(),this.conversations.removeConversation(e)},e}();var lC={},lM={},lD={},lw={};Object.defineProperty(lw,"__esModule",{value:!0}),lw.CSStatusQueryRequest=void 0,lw.CSStatusQueryRequest=function(e,t){this.customerId=e,this.teamId=t};var lI={};Object.defineProperty(lI,"__esModule",{value:!0}),lI.CSAcceptRequest=void 0,lI.CSAcceptRequest=function(e,t){this.teamId=e;var n=new el.User(t.id.toString(),JSON.stringify(t.data));this.customer=n};var lx={};Object.defineProperty(lx,"__esModule",{value:!0}),lx.CSTransferRequest=void 0,lx.CSTransferRequest=function(e,t,n){this.customerId=e,this.teamId=t,this.agentId=n};var lT={};Object.defineProperty(lT,"__esModule",{value:!0}),lT.CSEndRequest=void 0,lT.CSEndRequest=function(e,t){this.customerId=e,this.teamId=t},Object.defineProperty(lD,"__esModule",{value:!0}),lD.ConversationHandler=void 0,lD.ConversationHandler=function(){function e(e){this.builder=new ab.RemoteAbbrMessageBuilder,this.teamId=e}return e.prototype.accept=function(e,t){var n=this;(0,ts.validateCSAccept)(t);var r=new lI.CSAcceptRequest(e,t.customer),i=new e8.Rocket({name:ex.RocketTypes.CS_ACCEPT,params:r,permission:e8.Permission.WRITE,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,fail:function(e){eO.CallbackUtils.onFailed(t,e)},success:function(e){var r=n.builder.build(e.content.message);ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.CS_ACCEPTED,r),eO.CallbackUtils.onSuccess(t)}});e8.G.Socket.e(i)},e.prototype.end=function(e,t){var n=this;(0,ts.validateId)(t.id);var r=t.id.toString(),i=new lT.CSEndRequest(r,e),s=new e8.Rocket({name:ex.RocketTypes.CS_END,params:i,permission:e8.Permission.WRITE,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,fail:function(e){eO.CallbackUtils.onFailed(t,e)},success:function(e){var r=n.builder.build(e.content.message);ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.CS_ENDED,r),eO.CallbackUtils.onSuccess(t)}});e8.G.Socket.e(s)},e.prototype.queryCustomerStatus=function(e,t){return es.__awaiter(this,void 0,void 0,function(){var n;return es.__generator(this,function(r){switch(r.label){case 0:return(0,ts.validateId)(t.id),[4,this.doCustomerStatus(e,t.id)];case 1:return n=r.sent(),this.activeCustomerStatus=n,this.activeCustomerStatusOptions=t,eO.CallbackUtils.onSuccess(t,n),[2]}})})},e.prototype.doCustomerStatus=function(e,t){var n=t.toString(),r=new lw.CSStatusQueryRequest(n,e);return new Promise(function(e,t){var n=new e8.Rocket({name:ex.RocketTypes.CS_CUSTOMER_STATUS,params:r,permission:e8.Permission.READ,singleTimeout:eA.SocketTimeout.commonQuerySingle,totalTimeout:eA.SocketTimeout.commonQueryTotal,fail:function(e){t(e)},success:function(t){var n=t.content;n.agent&&(n.agent.data=JSON.parse(n.agent.data)),e(n)}});e8.G.Socket.e(n)})},e.prototype.transfer=function(e,t){var n=this;(0,ts.validateCSTransfer)(t);var r=t.customerId.toString(),i=t.agentId.toString(),s=new lx.CSTransferRequest(r,e,i),o=new e8.Rocket({name:ex.RocketTypes.CS_TRANSFER,params:s,permission:e8.Permission.WRITE,singleTimeout:eA.SocketTimeout.commonRequestSingle,totalTimeout:eA.SocketTimeout.commonRequestTotal,fail:function(e){eO.CallbackUtils.onFailed(t,e)},success:function(e){var r=n.builder.build(e.content.message);ar.IMEC.i.fire(o9.IM_INTERNAL_EVENTS.CS_TRANSFER,r),eO.CallbackUtils.onSuccess(t)}});e8.G.Socket.e(o)},e}();var lP={};Object.defineProperty(lP,"__esModule",{value:!0}),lP.MessageCreator=void 0,lP.MessageCreator=function(){function e(){}return e.prototype.createTextMessage=function(e,t){var n=oN.IM.i().createTextMessage(t);this.extendProps(e,n)},e.prototype.createImageMessage=function(e,t){var n=oN.IM.i().createImageMessage(t);this.extendProps(e,n)},e.prototype.createFileMessage=function(e,t){var n=oN.IM.i().createFileMessage(t);this.extendProps(e,n)},e.prototype.createAudioMessage=function(e,t){var n=oN.IM.i().createAudioMessage(t);this.extendProps(e,n)},e.prototype.createVideoMessage=function(e,t){var n=oN.IM.i().createVideoMessage(t);this.extendProps(e,n)},e.prototype.createCustomMessage=function(e,t){var n=oN.IM.i().createCustomMessage(t);this.extendProps(e,n)},e.prototype.extendProps=function(e,t){t.scene()===el.Scene.CS&&(t.teamId=e,t.accepted=!0)},e}(),Object.defineProperty(lM,"__esModule",{value:!0}),lM.Team=void 0,lM.Team=function(){function e(e){this.teamId=e,this.agentStatus=aN.AgentStatus.getInstance(),this.conversationHandler=new lD.ConversationHandler(e),this.messageCreator=new lP.MessageCreator}return e.prototype.catch=function(e,t){return es.__awaiter(this,void 0,void 0,function(){var n;return es.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e()];case 1:return r.sent(),[3,3];case 2:return n=r.sent(),eO.CallbackUtils.onFailed(t,n),[3,3];case 3:return[2]}})})},e.prototype.isOnline=function(e){var t=this;this.catch(function(){t.agentStatus.isOnline(t.teamId,e)},e)},e.prototype.online=function(e){var t=this;this.catch(function(){t.agentStatus.online(t.teamId,e)},e)},e.prototype.offline=function(e){var t=this;this.catch(function(){t.agentStatus.offline(t.teamId,e)},e)},e.prototype.customerStatus=function(e){var t=this;this.catch(function(){t.conversationHandler.queryCustomerStatus(t.teamId,e)},e)},e.prototype.accept=function(e){var t=this;this.catch(function(){t.conversationHandler.accept(t.teamId,e)},e)},e.prototype.end=function(e){var t=this;this.catch(function(){t.conversationHandler.end(t.teamId,e)},e)},e.prototype.history=function(e){oN.IM.i().history(e,this.teamId)},e.prototype.markMessageAsRead=function(e){oN.IM.i().markMessageAsRead(e,this.teamId)},e.prototype.createTextMessage=function(e){this.messageCreator.createTextMessage(this.teamId,e)},e.prototype.createImageMessage=function(e){this.messageCreator.createImageMessage(this.teamId,e)},e.prototype.createFileMessage=function(e){this.messageCreator.createFileMessage(this.teamId,e)},e.prototype.createAudioMessage=function(e){this.messageCreator.createAudioMessage(this.teamId,e)},e.prototype.createVideoMessage=function(e){this.messageCreator.createVideoMessage(this.teamId,e)},e.prototype.createCustomMessage=function(e){this.messageCreator.createCustomMessage(this.teamId,e)},e.prototype.transfer=function(e){var t=this;this.catch(function(){t.conversationHandler.transfer(t.teamId,e)},e)},e.prototype.agents=function(e){var t=this;this.catch(function(){t.agentStatus.agents(t.teamId,e)},e)},e.prototype.liveSession=function(e){var t=this;this.catch(function(){aP.LiveSession.live(t.teamId,e)},e)},e.prototype.quitLiveSession=function(e){this.catch(function(){aP.LiveSession.quit(e)},e)},e.prototype.listenCustomer=function(e){var t=this,n={customerId:e.id,onNewMessage:e.onNewMessage,onStatusUpdated:e.onStatusUpdated,onFailed:e.onFailed,onSuccess:e.onSuccess};this.catch(function(){aP.LiveSession.live(t.teamId,n)},e)},e.prototype.cancelListenCustomer=function(e){this.catch(function(){aP.LiveSession.quit(e)},e)},e}(),Object.defineProperty(lC,"__esModule",{value:!0}),lC.CS=void 0,lC.CS=function(){function e(){}return e.team=function(e){(0,ts.validateCustomId)(e);var t=this.teams.get(e);return t||(t=new lM.Team(e.toString()),this.teams.set(e.toString(),t)),t},e.teams=new Map,e}(),Object.defineProperty(oO,"__esModule",{value:!0}),oO.CSTeam=oO.GIM=void 0,oO.GIM=function(){function e(){}return e.on=function(e,t){oN.IM.i().on(e,t)},e.off=function(e,t){oN.IM.i().off(e,t)},e.createTextMessage=function(e){return oN.IM.i().createTextMessage(e)},e.createImageMessage=function(e){return oN.IM.i().createImageMessage(e)},e.createFileMessage=function(e){return oN.IM.i().createFileMessage(e)},e.createAudioMessage=function(e){return oN.IM.i().createAudioMessage(e)},e.createVideoMessage=function(e){return oN.IM.i().createVideoMessage(e)},e.createCustomMessage=function(e){return oN.IM.i().createCustomMessage(e)},e.sendMessage=function(e){oN.IM.i().sendMessage(e)},e.recallMessage=function(e){oN.IM.i().recallMessage(e)},e.deleteMessage=function(e){oN.IM.i().deleteMessage(e)},e.markGroupMessageAsRead=function(e){oN.IM.i().markGroupMessageAsRead(e)},e.markPrivateMessageAsRead=function(e){oN.IM.i().markPrivateMessageAsRead(e)},e.latestConversations=function(e){oN.IM.i().latestConversations(e)},e.removePrivateConversation=function(e){oN.IM.i().removePrivateConversation(e)},e.removeGroupConversation=function(e){oN.IM.i().removeGroupConversation(e)},e.topPrivateConversation=function(e){oN.IM.i().topPrivateConversation(e)},e.topGroupConversation=function(e){oN.IM.i().topGroupConversation(e)},e.history=function(e){oN.IM.i().history(e)},e.subscribeUserPresence=function(e){oN.IM.i().subscribeUserPresence(e)},e.unsubscribeUserPresence=function(e){oN.IM.i().unsubscribeUserPresence(e)},e.hereNow=function(e){oN.IM.i().hereNow(e)},e.subscribeGroup=function(e){oN.IM.i().subscribeGroup(e)},e.unsubscribeGroup=function(e){oN.IM.i().unsubscribeGroup(e)},e.subscribeGroupPresence=function(e){oN.IM.i().subscribeGroupPresence(e)},e.unsubscribeGroupPresence=function(e){oN.IM.i().unsubscribeGroupPresence(e)},e.groupHereNow=function(e){oN.IM.i().groupHereNow(e)},e.groupOnlineCount=function(e){oN.IM.i().groupOnlineCount(e)},e.markMessageAsRead=function(e){oN.IM.i().markMessageAsRead(e)},e.csteam=function(e){return new lA(e)},e.pendingConversations=function(e){oN.IM.i().latestPendingConversations(e)},e.topConversation=function(e){oN.IM.i().topConversation(e)},e.removeConversation=function(e){oN.IM.i().removeConversation(e)},e}();var lA=function(){function e(e){this.id=e}return e.prototype.isOnline=function(e){lC.CS.team(this.id).isOnline(e)},e.prototype.online=function(e){lC.CS.team(this.id).online(e)},e.prototype.offline=function(e){lC.CS.team(this.id).offline(e)},e.prototype.customerStatus=function(e){lC.CS.team(this.id).customerStatus(e)},e.prototype.accept=function(e){lC.CS.team(this.id).accept(e)},e.prototype.end=function(e){lC.CS.team(this.id).end(e)},e.prototype.history=function(e){lC.CS.team(this.id).history(e)},e.prototype.markMessageAsRead=function(e){lC.CS.team(this.id).markMessageAsRead(e)},e.prototype.createTextMessage=function(e){lC.CS.team(this.id).createTextMessage(e)},e.prototype.createImageMessage=function(e){lC.CS.team(this.id).createImageMessage(e)},e.prototype.createFileMessage=function(e){lC.CS.team(this.id).createFileMessage(e)},e.prototype.createAudioMessage=function(e){lC.CS.team(this.id).createAudioMessage(e)},e.prototype.createVideoMessage=function(e){lC.CS.team(this.id).createVideoMessage(e)},e.prototype.createCustomMessage=function(e){lC.CS.team(this.id).createCustomMessage(e)},e.prototype.transfer=function(e){lC.CS.team(this.id).transfer(e)},e.prototype.agents=function(e){lC.CS.team(this.id).agents(e)},e.prototype.liveSession=function(e){lC.CS.team(this.id).liveSession(e)},e.prototype.quitLiveSession=function(e){lC.CS.team(this.id).quitLiveSession(e)},e.prototype.listenCustomer=function(e){lC.CS.team(this.id).listenCustomer(e)},e.prototype.cancelListenCustomer=function(e){lC.CS.team(this.id).cancelListenCustomer(e)},e}();return oO.CSTeam=lA,Object.defineProperty(s,"__esModule",{value:!0}),s.default=function(){function e(){}return e.getInstance=function(t){return this.init(t),e},e.init=function(e){if(this.getConnectionStatus()!==ec.NetworkStatus.DISCONNECTED)throw Error("Initialization failed. Please disconnect and try again.");(0,ts.validateGoEasyOptions)(e),e.modules=e.modules.map(function(e){return e.toUpperCase()}),o.RNPlugins.init(e.reactNativeOptions),this.options=e,aj.GSocket.init(e),e.allowNotification&&ey.GN.init(e.allowNotification),e.modules&&(e.modules.includes("PUBSUB")&&e8.GModules.initModule(oA.GWSModule.init()),e.modules.includes("IM")&&e8.GModules.initModule(cA.GIMModule.init())),l_.GMember.init(),e8.G.init(aj.GSocket,ey.GN,l_.GMember,el.version,em.Platform,e8.GModules),this.options.customProvider&&ax.IMCustomProvider.init(this.options.customProvider)},e.setBadge=function(e){ey.GN.setBadge(e)},e.connect=function(e){aj.GSocket.connect(e,"JS")},e.disconnect=function(e){aj.GSocket.disconnect(e)},e.getConnectionStatus=function(){return aj.GSocket.status()},e.onClickNotification=function(e){ey.GN.onClickNotification(e)},e.c=function(e){e.init(e8.G.Socket,e8.G.N,e8.G.Member,e8.G.v,e8.G.Platform,e8.GModules)},e.version=el.version,e.IM_EVENT=aI.ImApiEvents,e.IM_SCENE=el.Scene,e.im=oO.GIM,e.pubsub=te.GWS,e}()}()}}]);